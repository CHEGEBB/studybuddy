"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6682],{38597:function(e){e.exports={URLS:{streamUrl:"https://stream.uxpilot.ai",authFuncUrl:"https://us-central1-uxpilot-auth.cloudfunctions.net",kbUrl:"https://kb.uxpilot.ai"},isProd:!0,isDev:!1,isLocal:!1,FEATURE_FLAGS:{L1_GENERATION:!1}}},30791:function(e,r,t){t.d(r,{I8:function(){return i},tO:function(){return o}}),t(12075),t(648),t(61708);var n=t(78199),s=t(24086);n.Z.apps.length||n.Z.initializeApp({apiKey:"AIzaSyBvx3L1jW-Q53bHwZc22SZUufdXhxeWbwc",authDomain:"uxpilot-auth.firebaseapp.com",projectId:"uxpilot-auth",storageBucket:"uxpilot-auth.appspot.com",messagingSenderId:"485825078314",appId:"1:485825078314:web:b742b234195e58f8b74f53"});var a=n.Z.firestore(),i=n.Z.auth(),o=n.Z.storage();a.settings({cacheSizeBytes:s.IX,merge:!0}),a.enablePersistence({synchronizeTabs:!0}).catch(function(e){"failed-precondition"===e.code?console.warn("Firebase persistence unavailable - multiple tabs open"):"unimplemented"===e.code&&console.warn("Firebase persistence not supported in this browser")}),r.ZP=n.Z},60453:function(e,r,t){t.d(r,{hb:function(){return dispatchCustomEvent},zW:function(){return s}});var n=t(2265),s={wireframesData:"wireframesData",groupsData:"groupsData",userInfo:"userInfo",exportGroupWireframe:"exportGroupWireframe",saveGroupWireframe:"saveGroupWireframe",unsaveWireframe:"unsaveWireframe",saveWireframe:"saveWireframe",syncing:"syncing",pageDeleted:"pageDeleted",userInfoData:"userInfoData",panningEnabled:"panningEnabled",panningDisabled:"panningDisabled",sessionExpired:"login",googleSignIn:"googleSignIn",googleOneTabResponse:"googleOneTabResponse",openCreatePageModal:"openCreatePageModal",saveTextChanges:"saveTextChanges",discardTextChanges:"discardTextChanges",refreshSavedWireframes:"refreshSavedWireframes",unSaveWireframeFromToolbar:"unSaveWireframeFromToolbar",itemAttachedWithContext:"itemAttachedWithContext"};r.ZP=function(e,r){var t=(0,n.useCallback)(function(e){r(e.detail)},[r]);(0,n.useEffect)(function(){return document.addEventListener(e,t),function(){document.removeEventListener(e,t)}},[e,t])};var dispatchCustomEvent=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=new CustomEvent(e,{detail:r});document.dispatchEvent(t)}},16958:function(e,r,t){t.d(r,{V:function(){return s},q:function(){return n}});var n={USER:"User",SUBSCRIPTION:"Subscription",CREDITS:"Credits",WIREFRAMES:"Wireframes",GROUPS:"Groups",PROMPTS:"Prompts",PAGES:"Pages",DESIGN_REVIEWS:"DesignReviews",USER_COUNT:"UserCount",PAYMENT_LOGS:"PaymentLogs",USER_IP:"UserIp",GENERATE:"Generate",GENERATE_HIFI:"GenerateHiFi",GENERATE_WIREFRAMES:"GenerateWireframes",GENERATE_BY_FLOW:"GenerateByFlow",HEATMAP:"Heatmap",SAVED_WIREFRAMES:"SavedWireframes",CANVAS_SHAPES:"CanvasShapes",CANVAS_ASSETS:"CanvasAssets",DESIGN_COLLECTIONS:"DesignCollections"},s={AUTH:"authApi",SUBSCRIPTION:"subscriptionApi",REVIEWS_QUERIES_MUTATIONS:"reviewsQueriesMutationsApi",UPLOAD_FILE:"uploadFileApi",UPLOAD_IMAGE_FILE:"uploadImageFileApi",UPLOAD_DOCUMENT:"uploadDocumentApi",UX_REVIEW:"uxReviewApi",USER_COUNT:"userCountApi",DESIGN:"designApi",WIREFRAMES:"wireframesApi",PROMPT:"promptApi",GROUPS:"groupsApi",PAGES:"pagesApi",SHARING:"sharingApi",CANVAS_SHAPES:"canvasShapesApi",ONBOARDING:"onboardingApi",CANVAS_ASSETS:"canvasAssetsApi"}},65800:function(e,r,t){t.d(r,{hK:function(){return b}});var n,s,a,i,o,u=t(45610),c=t(41369),p=t(43654),l=t(50044),d=t(55345),f=t(38597),h=t(30791),E=t(60453),g=!1,A=0,S=(n=(0,u._)(function(){var e,r,t,n,s,a,i;return(0,l.Jh)(this,function(o){switch(o.label){case 0:if(o.trys.push([0,7,,8]),e=localStorage.getItem("tokenId"),!(r=h.I8.currentUser))throw console.error("[AUTH] No user logged in, dispatching session expired"),(0,E.hb)(E.zW.sessionExpired),Error("No user logged in");if(!g)return[3,2];if(e)return[2,e];return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 1:if(o.sent(),t=localStorage.getItem("tokenId"))return[2,t];o.label=2;case 2:if(++A>3)throw console.error("[AUTH] Maximum token refresh attempts exceeded, possible infinite loop"),A=0,(0,E.hb)(E.zW.sessionExpired),Error("Maximum token refresh attempts exceeded");o.label=3;case 3:return o.trys.push([3,5,,6]),g=!0,[4,r.getIdToken(!1)];case 4:if(!(n=o.sent()))throw console.error("[AUTH] Failed to get token"),s=Error("Failed to get token"),(0,E.hb)(E.zW.sessionExpired),s;return localStorage.setItem("tokenId",n),g=!1,A=0,[2,n];case 5:throw console.error("[AUTH] Error getting token:",a=o.sent()),g=!1,(0,E.hb)(E.zW.sessionExpired),a;case 6:return[3,8];case 7:throw i=o.sent(),g=!1,i instanceof Error&&("No user logged in"===i.message||"Failed to get token"===i.message)||(console.error("[AUTH] Unexpected error in getIdToken:",i),(0,E.hb)(E.zW.sessionExpired)),i;case 8:return[2]}})}),function(){return n.apply(this,arguments)}),m=(s=(0,u._)(function(){var e,r;return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(t.trys.push([0,2,,3]),!(e=h.I8.currentUser))return[2,!1];return[4,e.getIdToken(!0)];case 1:if(r=t.sent())return localStorage.setItem("tokenId",r),[2,!0];return[2,!1];case 2:return console.error("[AUTH] Token refresh failed:",t.sent()),[2,!1];case 3:return[2]}})}),function(){return s.apply(this,arguments)}),I=(a=(0,u._)(function(){var e,r,t=arguments;return(0,l.Jh)(this,function(n){switch(n.label){case 0:e=t.length>0&&void 0!==t[0]?t[0]:{},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,S()];case 2:return r=n.sent(),[2,(0,p._)((0,c._)({},e),{Authorization:r})];case 3:return console.error("[AUTH] Error adding token to headers:",n.sent()),[2,e];case 4:return[2]}})}),function(){return a.apply(this,arguments)});(0,u._)(function(e){var r;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,S()];case 1:if(r=t.sent(),"string"==typeof e)return[2,{url:e,headers:{Authorization:r}}];return[2,(0,p._)((0,c._)({},e),{headers:(0,p._)((0,c._)({},e.headers),{Authorization:r})})];case 2:return console.error("[AUTH] Failed to add token to request:",t.sent()),[2,e];case 3:return[2]}})});var b=(0,d.ni)({baseUrl:f.URLS.streamUrl,prepareHeaders:(i=(0,u._)(function(e){var r;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,I(Object.fromEntries(e.entries()))];case 1:return r=t.sent(),[2,new Headers(r)]}})}),function(e){return i.apply(this,arguments)}),responseHandler:(o=(0,u._)(function(e){var r,t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:if(e.ok)return[3,4];if(!(401===(r=e.status)||403===r))return[3,2];return[4,m()];case 1:if(n.sent())return[2,Promise.reject({status:"CUSTOM_TOKEN_REFRESH",data:{message:"Token refreshed, please retry"}})];console.error("[AUTH] Token refresh failed, session expired"),(0,E.hb)(E.zW.sessionExpired),n.label=2;case 2:return[4,e.json().catch(function(){return{}})];case 3:return t=n.sent(),[2,Promise.reject({status:e.status,data:t})];case 4:return[2,e.json()]}})}),function(e){return o.apply(this,arguments)})})}}]);