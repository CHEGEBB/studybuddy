"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5878],{58066:function(t,a,l){l.d(a,{ZP:function(){return sV}});var c,d="undefined"!=typeof window?window:void 0,h="undefined"!=typeof globalThis?globalThis:d,_=Array.prototype,p=_.forEach,g=_.indexOf,v=null==h?void 0:h.navigator,f=null==h?void 0:h.document,w=null==h?void 0:h.location,S=null==h?void 0:h.fetch,k=null!=h&&h.XMLHttpRequest&&"withCredentials"in new h.XMLHttpRequest?h.XMLHttpRequest:void 0,E=null==h?void 0:h.AbortController,x=null==v?void 0:v.userAgent,B=null!=d?d:{},H={DEBUG:!1,LIB_VERSION:"1.230.1"},U="$copy_autocapture",J=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function m(t,a){return -1!==t.indexOf(a)}(e7=c||(c={})).GZipJS="gzip-js",e7.Base64="base64";var y=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},b=function(t){return t.replace(/^\$/,"")},ei=Array.isArray,er=Object.prototype,en=er.hasOwnProperty,ea=er.toString,el=ei||function(t){return"[object Array]"===ea.call(t)},I=t=>"function"==typeof t,P=t=>t===Object(t)&&!el(t),C=t=>{if(P(t)){for(var a in t)if(en.call(t,a))return!1;return!0}return!1},F=t=>void 0===t,R=t=>"[object String]"==ea.call(t),T=t=>R(t)&&0===t.trim().length,$=t=>null===t,A=t=>F(t)||$(t),O=t=>"[object Number]"==ea.call(t),M=t=>"[object Boolean]"===ea.call(t),L=t=>t instanceof FormData,D=t=>t instanceof Error,q=t=>m(J,t),N=t=>{var a={_log:function(a){if(d&&(H.DEBUG||B.POSTHOG_DEBUG)&&!F(d.console)&&d.console){for(var l=("__rrweb_original__"in d.console[a])?d.console[a].__rrweb_original__:d.console[a],c=arguments.length,h=Array(c>1?c-1:0),_=1;_<c;_++)h[_-1]=arguments[_];l(t,...h)}},info:function(){for(var t=arguments.length,l=Array(t),c=0;c<t;c++)l[c]=arguments[c];a._log("log",...l)},warn:function(){for(var t=arguments.length,l=Array(t),c=0;c<t;c++)l[c]=arguments[c];a._log("warn",...l)},error:function(){for(var t=arguments.length,l=Array(t),c=0;c<t;c++)l[c]=arguments[c];a._log("error",...l)},critical:function(){for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];console.error(t,...l)},uninitializedWarning:t=>{a.error("You must initialize PostHog before calling ".concat(t))},createLogger:a=>N("".concat(t," ").concat(a))};return a},ec=N("[PostHog.js]"),eu=ec.createLogger,ed=eu("[ExternalScriptsLoader]"),z=(t,a,l)=>{if(t.config.disable_external_dependency_loading)return ed.warn("".concat(a," was requested but loading of external scripts is disabled.")),l("Loading of external scripts is disabled");var s=()=>{if(!f)return l("document not found");var c=f.createElement("script");if(c.type="text/javascript",c.crossOrigin="anonymous",c.src=a,c.onload=t=>l(void 0,t),c.onerror=t=>l(t),t.config.prepare_external_dependency_script&&(c=t.config.prepare_external_dependency_script(c)),!c)return l("prepare_external_dependency_script returned null");var d,h=f.querySelectorAll("body > script");h.length>0?null===(d=h[0].parentNode)||void 0===d||d.insertBefore(c,h[0]):f.body.appendChild(c)};null!=f&&f.body?s():null==f||f.addEventListener("DOMContentLoaded",s)};function j(t,a){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);a&&(c=c.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),l.push.apply(l,c)}return l}function W(t){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?arguments[a]:{};a%2?j(Object(l),!0).forEach(function(a){V(t,a,l[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):j(Object(l)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(l,a))})}return t}function V(t,a,l){return a in t?Object.defineProperty(t,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[a]=l,t}function G(t,a){if(null==t)return{};var l,c,d=function(t,a){if(null==t)return{};var l,c,d={},h=Object.keys(t);for(c=0;c<h.length;c++)l=h[c],a.indexOf(l)>=0||(d[l]=t[l]);return d}(t,a);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);for(c=0;c<h.length;c++)l=h[c],a.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(t,l)&&(d[l]=t[l])}return d}B.__PosthogExtensions__=B.__PosthogExtensions__||{},B.__PosthogExtensions__.loadExternalDependency=(t,a,l)=>{var c="/static/".concat(a,".js")+"?v=".concat(t.version);if("remote-config"===a&&(c="/array/".concat(t.config.token,"/config.js")),"toolbar"===a){var d=3e5*Math.floor(Date.now()/3e5);c="".concat(c,"&t=").concat(d)}var h=t.requestRouter.endpointFor("assets",c);z(t,h,l)},B.__PosthogExtensions__.loadSiteApp=(t,a,l)=>{var c=t.requestRouter.endpointFor("api",a);z(t,c,l)};var eh={};function Y(t,a,l){if(el(t)){if(p&&t.forEach===p)t.forEach(a,l);else if("length"in t&&t.length===+t.length){for(var c=0,d=t.length;c<d;c++)if(c in t&&a.call(l,t[c],c)===eh)return}}}function K(t,a,l){if(!A(t)){if(el(t))return Y(t,a,l);if(L(t)){for(var c of t.entries())if(a.call(l,c[1],c[0])===eh)return}else for(var d in t)if(en.call(t,d)&&a.call(l,t[d],d)===eh)return}}var X=function(t){for(var a=arguments.length,l=Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];return Y(l,function(a){for(var l in a)void 0!==a[l]&&(t[l]=a[l])}),t},Q=function(t){for(var a=arguments.length,l=Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];return Y(l,function(a){Y(a,function(a){t.push(a)})}),t};function Z(t){for(var a=Object.keys(t),l=a.length,c=Array(l);l--;)c[l]=[a[l],t[a[l]]];return c}var ee=function(t){try{return t()}catch(t){return}},te=function(t){return function(){try{for(var a=arguments.length,l=Array(a),c=0;c<a;c++)l[c]=arguments[c];return t.apply(this,l)}catch(t){ec.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),ec.critical(t)}}},ie=function(t){var a={};return K(t,function(t,l){R(t)&&t.length>0&&(a[l]=t)}),a},e_=["herokuapp.com","vercel.app","netlify.app"];function oe(t,a){for(var l=0;l<t.length;l++)if(a(t[l]))return t[l]}function ae(t,a,l,c){var{capture:d=!1,passive:h=!0}=null!=c?c:{};null==t||t.addEventListener(a,l,{capture:d,passive:h})}var ep="$people_distinct_id",eg="__alias",ev="__timers",ef="$autocapture_disabled_server_side",em="$heatmaps_enabled_server_side",eb="$exception_capture_enabled_server_side",ey="$web_vitals_enabled_server_side",ew="$dead_clicks_enabled_server_side",eS="$web_vitals_allowed_metrics",ek="$session_recording_enabled_server_side",eE="$console_log_recording_enabled_server_side",ex="$session_recording_network_payload_capture",eF="$session_recording_masking",eI="$session_recording_canvas_recording",eP="$replay_sample_rate",eC="$replay_minimum_duration",eR="$replay_script_config",eT="$sesid",e$="$session_is_sampled",eA="$session_recording_url_trigger_activated_session",eO="$session_recording_event_trigger_activated_session",eM="$enabled_feature_flags",eL="$early_access_features",eD="$stored_person_properties",eW="$stored_group_properties",eq="$surveys",eN="$surveys_activated",eB="$flag_call_reported",eV="$user_state",eH="$client_session_props",eU="$capture_rate_limit",ez="$initial_campaign_params",ej="$initial_referrer_info",eG="$initial_person_info",eK="$epp",eX="__POSTHOG_TOOLBAR__",eY="$posthog_cookieless",eJ=[ep,eg,"__cmpns",ev,ek,em,eT,eM,eV,eL,eW,eD,eq,eB,eH,eU,ez,ej,eK];function Ve(t){var a;return t instanceof Element&&(t.id===eX||!(null===(a=t.closest)||void 0===a||!a.call(t,".toolbar-global-fade-container")))}function Ge(t){return!!t&&1===t.nodeType}function Je(t,a){return!!t&&!!t.tagName&&t.tagName.toLowerCase()===a.toLowerCase()}function Ye(t){return!!t&&3===t.nodeType}function Ke(t){return!!t&&11===t.nodeType}function Xe(t){return t?y(t).split(/\s+/):[]}function Qe(t){var a=null==d?void 0:d.location.href;return!!(a&&t&&t.some(t=>a.match(t)))}function Ze(t){var a="";switch(typeof t.className){case"string":a=t.className;break;case"object":a=(t.className&&"baseVal"in t.className?t.className.baseVal:null)||t.getAttribute("class")||"";break;default:a=""}return Xe(a)}function et(t){return A(t)?null:y(t).split(/(\s+)/).filter(t=>pt(t)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function tt(t){var a="";return ot(t)&&!at(t)&&t.childNodes&&t.childNodes.length&&K(t.childNodes,function(t){var l;Ye(t)&&t.textContent&&(a+=null!==(l=et(t.textContent))&&void 0!==l?l:"")}),y(a)}function it(t){var a;return F(t.target)?t.srcElement||null:null!==(a=t.target)&&void 0!==a&&a.shadowRoot?t.composedPath()[0]||null:t.target||null}var eQ=["a","button","form","input","select","textarea","label"];function rt(t){var a=t.parentNode;return!(!a||!Ge(a))&&a}function ot(t){for(var a=t;a.parentNode&&!Je(a,"body");a=a.parentNode){var l=Ze(a);if(m(l,"ph-sensitive")||m(l,"ph-no-capture"))return!1}if(m(Ze(t),"ph-include"))return!0;var c=t.type||"";if(R(c))switch(c.toLowerCase()){case"hidden":case"password":return!1}var d=t.name||t.id||"";return!(R(d)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(d.replace(/[^a-zA-Z0-9]/g,"")))}function at(t){return!!(Je(t,"input")&&!["button","checkbox","submit","reset"].includes(t.type)||Je(t,"select")||Je(t,"textarea")||"true"===t.getAttribute("contenteditable"))}var eZ="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",e0=new RegExp("^(?:".concat(eZ,")$")),e1=new RegExp(eZ),e2="\\d{3}-?\\d{2}-?\\d{4}",e3=new RegExp("^(".concat(e2,")$")),e5=new RegExp("(".concat(e2,")"));function pt(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!(A(t)||R(t)&&(t=y(t),(a?e0:e1).test((t||"").replace(/[- ]/g,""))||(a?e3:e5).test(t)))}function gt(t){var a=tt(t);return pt(a="".concat(a," ").concat(function vt(t){var a="";return t&&t.childNodes&&t.childNodes.length&&K(t.childNodes,function(t){var l;if(t&&"span"===(null===(l=t.tagName)||void 0===l?void 0:l.toLowerCase()))try{var c=tt(t);a="".concat(a," ").concat(c).trim(),t.childNodes&&t.childNodes.length&&(a="".concat(a," ").concat(vt(t)).trim())}catch(t){ec.error("[AutoCapture]",t)}}),a}(t)).trim())?a:""}function mt(t){return t.replace(/"|\\"/g,'\\"')}let bt=class bt{constructor(){this.clicks=[]}isRageClick(t,a,l){var c=this.clicks[this.clicks.length-1];if(c&&Math.abs(t-c.x)+Math.abs(a-c.y)<30&&l-c.timestamp<1e3){if(this.clicks.push({x:t,y:a,timestamp:l}),3===this.clicks.length)return!0}else this.clicks=[{x:t,y:a,timestamp:l}];return!1}};var e6=["localhost","127.0.0.1"],St=t=>{var a=null==f?void 0:f.createElement("a");return F(a)?null:(a.href=t,a)},kt=function(t){var a,l,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",d=[];return K(t,function(t,c){F(t)||F(c)||"undefined"===c||(a=encodeURIComponent(t instanceof File?t.name:t.toString()),l=encodeURIComponent(c),d[d.length]=l+"="+a)}),d.join(c)},Et=function(t,a){for(var l,c=((t.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),d=0;d<c.length;d++){var h=c[d].split("=");if(h[0]===a){l=h;break}}if(!el(l)||l.length<2)return"";var _=l[1];try{_=decodeURIComponent(_)}catch(t){ec.error("Skipping decoding for malformed query param: "+_)}return _.replace(/\+/g," ")},xt=function(t,a,l){if(!t||!a||!a.length)return t;for(var c=t.split("#"),d=c[0]||"",h=c[1],_=d.split("?"),p=_[1],g=_[0],v=(p||"").split("&"),f=[],w=0;w<v.length;w++){var S=v[w].split("=");el(S)&&(a.includes(S[0])?f.push(S[0]+"="+l):f.push(v[w]))}var k=g;return null!=p&&(k+="?"+f.join("&")),null!=h&&(k+="#"+h),k},It=function(t,a){var l=t.match(RegExp(a+"=([^&]*)"));return l?l[1]:null},e4=eu("[AutoCapture]");function Ct(t,a){return a.length>t?a.slice(0,t)+"...":a}let $t=class $t{constructor(t){V(this,"_initialized",!1),V(this,"_isDisabledServerSide",null),V(this,"rageclicks",new bt),V(this,"_elementsChainAsString",!1),this.instance=t,this._elementSelectors=null}get config(){var t,a,l=P(this.instance.config.autocapture)?this.instance.config.autocapture:{};return l.url_allowlist=null===(t=l.url_allowlist)||void 0===t?void 0:t.map(t=>new RegExp(t)),l.url_ignorelist=null===(a=l.url_ignorelist)||void 0===a?void 0:a.map(t=>new RegExp(t)),l}_addDomEventHandlers(){if(this.isBrowserSupported()){if(d&&f){var e=t=>{t=t||(null==d?void 0:d.event);try{this._captureEvent(t)}catch(t){e4.error("Failed to capture event",t)}};if(ae(f,"submit",e,{capture:!0}),ae(f,"change",e,{capture:!0}),ae(f,"click",e,{capture:!0}),this.config.capture_copied_text){var i=t=>{t=t||(null==d?void 0:d.event),this._captureEvent(t,U)};ae(f,"copy",i,{capture:!0}),ae(f,"cut",i,{capture:!0})}}}else e4.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}onRemoteConfig(t){t.elementsChainAsString&&(this._elementsChainAsString=t.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[ef]:!!t.autocapture_opt_out}),this._isDisabledServerSide=!!t.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(t){this._elementSelectors=t}getElementSelectors(t){var a,l=[];return null===(a=this._elementSelectors)||void 0===a||a.forEach(a=>{var c=null==f?void 0:f.querySelectorAll(a);null==c||c.forEach(c=>{t===c&&l.push(a)})}),l}get isEnabled(){var t,a,l=null===(t=this.instance.persistence)||void 0===t?void 0:t.props[ef];if($(this._isDisabledServerSide)&&!M(l)&&!this.instance.config.advanced_disable_decide)return!1;var c=null!==(a=this._isDisabledServerSide)&&void 0!==a?a:!!l;return!!this.instance.config.autocapture&&!c}_captureEvent(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$autocapture";if(this.isEnabled){var l,c=it(t);Ye(c)&&(c=c.parentNode||null),"$autocapture"===a&&"click"===t.type&&t instanceof MouseEvent&&this.instance.config.rageclick&&null!==(l=this.rageclicks)&&void 0!==l&&l.isRageClick(t.clientX,t.clientY,(new Date).getTime())&&this._captureEvent(t,"$rageclick");var h=a===U;if(c&&function(t,a){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0;if(!d||!t||Je(t,"html")||!Ge(t)||null!=l&&l.url_allowlist&&!Qe(l.url_allowlist)||null!=l&&l.url_ignorelist&&Qe(l.url_ignorelist))return!1;if(null!=l&&l.dom_event_allowlist){var _=l.dom_event_allowlist;if(_&&!_.some(t=>a.type===t))return!1}for(var p=!1,g=[t],v=!0,f=t;f.parentNode&&!Je(f,"body");)if(Ke(f.parentNode))g.push(f.parentNode.host),f=f.parentNode.host;else{if(!(v=rt(f)))break;if(c||eQ.indexOf(v.tagName.toLowerCase())>-1)p=!0;else{var w=d.getComputedStyle(v);w&&"pointer"===w.getPropertyValue("cursor")&&(p=!0)}g.push(v),f=v}if(!function(t,a){var l=null==a?void 0:a.element_allowlist;if(F(l))return!0;var s=function(t){if(l.some(a=>t.tagName.toLowerCase()===a))return{v:!0}};for(var c of t){var d=s(c);if("object"==typeof d)return d.v}return!1}(g,l)||!function(t,a){var l=null==a?void 0:a.css_selector_allowlist;if(F(l))return!0;var s=function(t){if(l.some(a=>t.matches(a)))return{v:!0}};for(var c of t){var d=s(c);if("object"==typeof d)return d.v}return!1}(g,l))return!1;var S=d.getComputedStyle(t);if(S&&"pointer"===S.getPropertyValue("cursor")&&"click"===a.type)return!0;var k=t.tagName.toLowerCase();switch(k){case"html":return!1;case"form":return(h||["submit"]).indexOf(a.type)>=0;case"input":case"select":case"textarea":return(h||["change","click"]).indexOf(a.type)>=0;default:return p?(h||["click"]).indexOf(a.type)>=0:(h||["click"]).indexOf(a.type)>=0&&(eQ.indexOf(k)>-1||"true"===t.getAttribute("contenteditable"))}}(c,t,this.config,h,h?["copy","cut"]:void 0)){var{props:_,explicitNoCapture:p}=function(t,a){for(var l,c,{e:h,maskAllElementAttributes:_,maskAllText:p,elementAttributeIgnoreList:g,elementsChainAsString:v}=a,f=[t],w=t;w.parentNode&&!Je(w,"body");)Ke(w.parentNode)?(f.push(w.parentNode.host),w=w.parentNode.host):(f.push(w.parentNode),w=w.parentNode);var S,k=[],E={},x=!1,B=!1;if(K(f,t=>{var a=ot(t);"a"===t.tagName.toLowerCase()&&(x=t.getAttribute("href"),x=a&&x&&pt(x)&&x),m(Ze(t),"ph-no-capture")&&(B=!0),k.push(function(t,a,l,c){var d=t.tagName.toLowerCase(),h={tag_name:d};eQ.indexOf(d)>-1&&!l&&("a"===d.toLowerCase()||"button"===d.toLowerCase()?h.$el_text=Ct(1024,gt(t)):h.$el_text=Ct(1024,tt(t)));var _=Ze(t);_.length>0&&(h.classes=_.filter(function(t){return""!==t})),K(t.attributes,function(l){var d;if((!at(t)||-1!==["name","id","class","aria-label"].indexOf(l.name))&&(null==c||!c.includes(l.name))&&!a&&pt(l.value)&&(!R(d=l.name)||"_ngcontent"!==d.substring(0,10)&&"_nghost"!==d.substring(0,7))){var _=l.value;"class"===l.name&&(_=Xe(_).join(" ")),h["attr__"+l.name]=Ct(1024,_)}});for(var p=1,g=1,v=t;v=function(t){if(t.previousElementSibling)return t.previousElementSibling;var a=t;do a=a.previousSibling;while(a&&!Ge(a));return a}(v);)p++,v.tagName===t.tagName&&g++;return h.nth_child=p,h.nth_of_type=g,h}(t,_,p,g)),X(E,function(t){if(!ot(t))return{};var a={};return K(t.attributes,function(t){if(t.name&&0===t.name.indexOf("data-ph-capture-attribute")){var l=t.name.replace("data-ph-capture-attribute-",""),c=t.value;l&&c&&pt(c)&&(a[l]=c)}}),a}(t))}),B)return{props:{},explicitNoCapture:B};if(p||("a"===t.tagName.toLowerCase()||"button"===t.tagName.toLowerCase()?k[0].$el_text=gt(t):k[0].$el_text=tt(t)),x){k[0].attr__href=x;var H,U,J=null===(H=St(x))||void 0===H?void 0:H.host,ei=null==d||null===(U=d.location)||void 0===U?void 0:U.host;J&&ei&&J!==ei&&(S=x)}return{props:X({$event_type:h.type,$ce_version:1},v?{}:{$elements:k},{$elements_chain:k.map(t=>{var a,l,c,d={text:null===(l=t.$el_text)||void 0===l?void 0:l.slice(0,400),tag_name:t.tag_name,href:null===(c=t.attr__href)||void 0===c?void 0:c.slice(0,2048),attr_class:(a=t.attr__class)?el(a)?a:Xe(a):void 0,attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Z(t).filter(t=>{var[a]=t;return 0===a.indexOf("attr__")}).forEach(t=>{var[a,l]=t;return d.attributes[a]=l}),d}).map(t=>{var a,l,c="";if(t.tag_name&&(c+=t.tag_name),t.attr_class)for(var d of(t.attr_class.sort(),t.attr_class))c+=".".concat(d.replace(/"/g,""));var h=W(W(W(W({},t.text?{text:t.text}:{}),{},{"nth-child":null!==(a=t.nth_child)&&void 0!==a?a:0,"nth-of-type":null!==(l=t.nth_of_type)&&void 0!==l?l:0},t.href?{href:t.href}:{}),t.attr_id?{attr_id:t.attr_id}:{}),t.attributes),_={};return Z(h).sort((t,a)=>{var[l]=t,[c]=a;return l.localeCompare(c)}).forEach(t=>{var[a,l]=t;return _[mt(a.toString())]=mt(l.toString())}),c+=":"+Z(h).map(t=>{var[a,l]=t;return"".concat(a,'="').concat(l,'"')}).join("")}).join(";")},null!==(l=k[0])&&void 0!==l&&l.$el_text?{$el_text:null===(c=k[0])||void 0===c?void 0:c.$el_text}:{},S&&"click"===h.type?{$external_click_url:S}:{},E)}}(c,{e:t,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.config.element_attribute_ignorelist,elementsChainAsString:this._elementsChainAsString});if(p)return!1;var g=this.getElementSelectors(c);if(g&&g.length>0&&(_.$element_selectors=g),a===U){var v,f=et(null==d||null===(v=d.getSelection())||void 0===v?void 0:v.toString()),w=t.type||"clipboard";if(!f)return!1;_.$selected_content=f,_.$copy_type=w}return this.instance.capture(a,_),!0}}}isBrowserSupported(){return I(null==f?void 0:f.querySelectorAll)}};Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return O(t)&&isFinite(t)&&Math.floor(t)===t});var e8="0123456789abcdef";let Ot=class Ot{constructor(t){if(this.bytes=t,16!==t.length)throw TypeError("not 128-bit length")}static fromFieldsV7(t,a,l,c){if(!Number.isInteger(t)||!Number.isInteger(a)||!Number.isInteger(l)||!Number.isInteger(c)||t<0||a<0||l<0||c<0||t>0xffffffffffff||a>4095||l>1073741823||c>4294967295)throw RangeError("invalid field value");var d=new Uint8Array(16);return d[0]=t/1099511627776,d[1]=t/4294967296,d[2]=t/16777216,d[3]=t/65536,d[4]=t/256,d[5]=t,d[6]=112|a>>>8,d[7]=a,d[8]=128|l>>>24,d[9]=l>>>16,d[10]=l>>>8,d[11]=l,d[12]=c>>>24,d[13]=c>>>16,d[14]=c>>>8,d[15]=c,new Ot(d)}toString(){for(var t="",a=0;a<this.bytes.length;a++)t=t+e8.charAt(this.bytes[a]>>>4)+e8.charAt(15&this.bytes[a]),3!==a&&5!==a&&7!==a&&9!==a||(t+="-");if(36!==t.length)throw Error("Invalid UUIDv7 was generated");return t}clone(){return new Ot(this.bytes.slice(0))}equals(t){return 0===this.compareTo(t)}compareTo(t){for(var a=0;a<16;a++){var l=this.bytes[a]-t.bytes[a];if(0!==l)return Math.sign(l)}return 0}};let Mt=class Mt{constructor(){V(this,"timestamp",0),V(this,"counter",0),V(this,"random",new qt)}generate(){var t=this.generateOrAbort();if(F(t)){this.timestamp=0;var a=this.generateOrAbort();if(F(a))throw Error("Could not generate UUID after timestamp reset");return a}return t}generateOrAbort(){var t=Date.now();if(t>this.timestamp)this.timestamp=t,this.resetCounter();else{if(!(t+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return Ot.fromFieldsV7(this.timestamp,Math.trunc(this.counter/1073741824),1073741823&this.counter,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}};var e7,e9,Dt=t=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");for(var a=0;a<t.length;a++)t[a]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};d&&!F(d.crypto)&&crypto.getRandomValues&&(Dt=t=>crypto.getRandomValues(t));let qt=class qt{constructor(){V(this,"buffer",new Uint32Array(8)),V(this,"cursor",1/0)}nextUint32(){return this.cursor>=this.buffer.length&&(Dt(this.buffer),this.cursor=0),this.buffer[this.cursor++]}};var ts,Nt=()=>Bt().toString(),Bt=()=>(e9||(e9=new Mt)).generate(),tr="",tn=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,to={is_supported:()=>!!f,error:function(t){ec.error("cookieStore error: "+t)},get:function(t){if(f){try{for(var a=t+"=",l=f.cookie.split(";").filter(t=>t.length),c=0;c<l.length;c++){for(var d=l[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0===d.indexOf(a))return decodeURIComponent(d.substring(a.length,d.length))}}catch(t){}return null}},parse:function(t){var a;try{a=JSON.parse(to.get(t))||{}}catch(t){}return a},set:function(t,a,l,c,d){if(f)try{var h="",_="",p=function(t,a){if(a){var l=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;if(tr)return tr;if(!a||["localhost","127.0.0.1"].includes(t))return"";for(var l=t.split("."),c=Math.min(l.length,8),d="dmn_chk_"+Nt(),h=RegExp("(^|;)\\s*"+d+"=1");!tr&&c--;){var _=l.slice(c).join("."),p=d+"=1;domain=."+_;a.cookie=p,h.test(a.cookie)&&(a.cookie=p+";expires=Thu, 01 Jan 1970 00:00:00 GMT",tr=_)}return tr}(t);if(!l){var c,d=(c=t.match(tn))?c[0]:"";d!==l&&ec.info("Warning: cookie subdomain discovery mismatch",d,l),l=d}return l?"; domain=."+l:""}return""}(f.location.hostname,c);if(l){var g=new Date;g.setTime(g.getTime()+24*l*36e5),h="; expires="+g.toUTCString()}d&&(_="; secure");var v=t+"="+encodeURIComponent(JSON.stringify(a))+h+"; SameSite=Lax; path=/"+p+_;return v.length>3686.4&&ec.warn("cookieStore warning: large cookie, len="+v.length),f.cookie=v,v}catch(t){return}},remove:function(t,a){try{to.set(t,"",-1,a)}catch(t){return}}},ta=null,tl={is_supported:function(){if(!$(ta))return ta;var t=!0;if(F(d))t=!1;else try{var a="__mplssupport__";tl.set(a,"xyz"),'"xyz"'!==tl.get(a)&&(t=!1),tl.remove(a)}catch(a){t=!1}return t||ec.error("localStorage unsupported; falling back to cookie store"),ta=t,t},error:function(t){ec.error("localStorage error: "+t)},get:function(t){try{return null==d?void 0:d.localStorage.getItem(t)}catch(t){tl.error(t)}return null},parse:function(t){try{return JSON.parse(tl.get(t))||{}}catch(t){}return null},set:function(t,a){try{null==d||d.localStorage.setItem(t,JSON.stringify(a))}catch(t){tl.error(t)}},remove:function(t){try{null==d||d.localStorage.removeItem(t)}catch(t){tl.error(t)}}},tc=["distinct_id",eT,e$,eK,eG],tu=W(W({},tl),{},{parse:function(t){try{var a={};try{a=to.parse(t)||{}}catch(t){}var l=X(a,JSON.parse(tl.get(t)||"{}"));return tl.set(t,l),l}catch(t){}return null},set:function(t,a,l,c,d,h){try{tl.set(t,a,void 0,void 0,h);var _={};tc.forEach(t=>{a[t]&&(_[t]=a[t])}),Object.keys(_).length&&to.set(t,_,l,c,d,h)}catch(t){tl.error(t)}},remove:function(t,a){try{null==d||d.localStorage.removeItem(t),to.remove(t,a)}catch(t){tl.error(t)}}}),td={},th={is_supported:function(){return!0},error:function(t){ec.error("memoryStorage error: "+t)},get:function(t){return td[t]||null},parse:function(t){return td[t]||null},set:function(t,a){td[t]=a},remove:function(t){delete td[t]}},t_=null,tp={is_supported:function(){if(!$(t_))return t_;if(t_=!0,F(d))t_=!1;else try{var t="__support__";tp.set(t,"xyz"),'"xyz"'!==tp.get(t)&&(t_=!1),tp.remove(t)}catch(t){t_=!1}return t_},error:function(t){ec.error("sessionStorage error: ",t)},get:function(t){try{return null==d?void 0:d.sessionStorage.getItem(t)}catch(t){tp.error(t)}return null},parse:function(t){try{return JSON.parse(tp.get(t))||null}catch(t){}return null},set:function(t,a){try{null==d||d.sessionStorage.setItem(t,JSON.stringify(a))}catch(t){tp.error(t)}},remove:function(t){try{null==d||d.sessionStorage.removeItem(t)}catch(t){tp.error(t)}}};(tX=ts||(ts={}))[tX.PENDING=-1]="PENDING",tX[tX.DENIED=0]="DENIED",tX[tX.GRANTED=1]="GRANTED";let ti=class ti{constructor(t){this.instance=t}get config(){return this.instance.config}get consent(){return this.getDnt()?ts.DENIED:this.storedConsent}isOptedOut(){return this.consent===ts.DENIED||this.consent===ts.PENDING&&this.config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(t){this.storage.set(this.storageKey,t?1:0,this.config.cookie_expiration,this.config.cross_subdomain_cookie,this.config.secure_cookie)}reset(){this.storage.remove(this.storageKey,this.config.cross_subdomain_cookie)}get storageKey(){var{token:t,opt_out_capturing_cookie_prefix:a}=this.instance.config;return(a||"__ph_opt_in_out_")+t}get storedConsent(){var t=this.storage.get(this.storageKey);return"1"===t?ts.GRANTED:"0"===t?ts.DENIED:ts.PENDING}get storage(){if(!this._storage){var t=this.config.opt_out_capturing_persistence_type;this._storage="localStorage"===t?tl:to;var a="localStorage"===t?to:tl;a.get(this.storageKey)&&(this._storage.get(this.storageKey)||this.optInOut("1"===a.get(this.storageKey)),a.remove(this.storageKey,this.config.cross_subdomain_cookie))}return this._storage}getDnt(){return!!this.config.respect_dnt&&!!oe([null==v?void 0:v.doNotTrack,null==v?void 0:v.msDoNotTrack,B.doNotTrack],t=>m([!0,1,"1","yes"],t))}};var tg=eu("[Dead Clicks]"),si=()=>!0,ri=t=>{var a,l=!(null===(a=t.instance.persistence)||void 0===a||!a.get_property(ew)),c=t.instance.config.capture_dead_clicks;return M(c)?c:l};let ni=class ni{get lazyLoadedDeadClicksAutocapture(){return this._lazyLoadedDeadClicksAutocapture}constructor(t,a,l){this.instance=t,this.isEnabled=a,this.onCapture=l,this.startIfEnabled()}onRemoteConfig(t){this.instance.persistence&&this.instance.persistence.register({[ew]:null==t?void 0:t.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.loadScript(()=>{this.start()})}loadScript(t){var a,l,c;null!==(a=B.__PosthogExtensions__)&&void 0!==a&&a.initDeadClicksAutocapture&&t(),null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.loadExternalDependency)||void 0===c||c.call(l,this.instance,"dead-clicks-autocapture",a=>{a?tg.error("failed to load script",a):t()})}start(){var t;if(f){if(!this._lazyLoadedDeadClicksAutocapture&&null!==(t=B.__PosthogExtensions__)&&void 0!==t&&t.initDeadClicksAutocapture){var a=P(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};a.__onCapture=this.onCapture,this._lazyLoadedDeadClicksAutocapture=B.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,a),this._lazyLoadedDeadClicksAutocapture.start(f),tg.info("starting...")}}else tg.error("`document` not found. Cannot start.")}stop(){this._lazyLoadedDeadClicksAutocapture&&(this._lazyLoadedDeadClicksAutocapture.stop(),this._lazyLoadedDeadClicksAutocapture=void 0,tg.info("stopping..."))}};var tv=eu("[ExceptionAutocapture]");let ai=class ai{constructor(t){var a;V(this,"startCapturing",()=>{var t,a,l,c;if(d&&this.isEnabled&&!this.hasHandlers){var h=null===(t=B.__PosthogExtensions__)||void 0===t||null===(a=t.errorWrappingFunctions)||void 0===a?void 0:a.wrapOnError,_=null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.errorWrappingFunctions)||void 0===c?void 0:c.wrapUnhandledRejection;if(h&&_)try{this.unwrapOnError=h(this.captureException.bind(this)),this.unwrapUnhandledRejection=_(this.captureException.bind(this))}catch(t){tv.error("failed to start",t),this.stopCapturing()}else tv.error("failed to load error wrapping functions - cannot start")}}),this.instance=t,this.remoteEnabled=!(null===(a=this.instance.persistence)||void 0===a||!a.props[eb]),this.startIfEnabled()}get isEnabled(){var t;return M(this.instance.config.capture_exceptions)?this.instance.config.capture_exceptions:null!==(t=this.remoteEnabled)&&void 0!==t&&t}get hasHandlers(){return!F(this.unwrapOnError)}startIfEnabled(){this.isEnabled&&!this.hasHandlers&&(tv.info("enabled, starting..."),this.loadScript(this.startCapturing))}loadScript(t){var a,l;this.hasHandlers&&t(),null===(a=B.__PosthogExtensions__)||void 0===a||null===(l=a.loadExternalDependency)||void 0===l||l.call(a,this.instance,"exception-autocapture",a=>{if(a)return tv.error("failed to load script",a);t()})}stopCapturing(){var t,a;null===(t=this.unwrapOnError)||void 0===t||t.call(this),this.unwrapOnError=void 0,null===(a=this.unwrapUnhandledRejection)||void 0===a||a.call(this),this.unwrapUnhandledRejection=void 0}onRemoteConfig(t){var a=t.autocaptureExceptions;this.remoteEnabled=!!a,this.instance.persistence&&this.instance.persistence.register({[eb]:this.remoteEnabled}),this.startIfEnabled()}captureException(t){var a=this.instance.requestRouter.endpointFor("ui");t.$exception_personURL="".concat(a,"/project/").concat(this.instance.config.token,"/person/").concat(this.instance.get_distinct_id()),this.instance.exceptions.sendExceptionEvent(t)}};function li(t){var a,l;return(null===(a=JSON.stringify(t,(l=[],function(t,a){if(P(a)){for(;l.length>0&&l[l.length-1]!==this;)l.pop();return l.includes(a)?"[Circular]":(l.push(a),a)}return a})))||void 0===a?void 0:a.length)||0}var tf=((tY=tf||{})[tY.DomContentLoaded=0]="DomContentLoaded",tY[tY.Load=1]="Load",tY[tY.FullSnapshot=2]="FullSnapshot",tY[tY.IncrementalSnapshot=3]="IncrementalSnapshot",tY[tY.Meta=4]="Meta",tY[tY.Custom=5]="Custom",tY[tY.Plugin=6]="Plugin",tY),tm=((tJ=tm||{})[tJ.Mutation=0]="Mutation",tJ[tJ.MouseMove=1]="MouseMove",tJ[tJ.MouseInteraction=2]="MouseInteraction",tJ[tJ.Scroll=3]="Scroll",tJ[tJ.ViewportResize=4]="ViewportResize",tJ[tJ.Input=5]="Input",tJ[tJ.TouchMove=6]="TouchMove",tJ[tJ.MediaInteraction=7]="MediaInteraction",tJ[tJ.StyleSheetRule=8]="StyleSheetRule",tJ[tJ.CanvasMutation=9]="CanvasMutation",tJ[tJ.Font=10]="Font",tJ[tJ.Log=11]="Log",tJ[tJ.Drag=12]="Drag",tJ[tJ.StyleDeclaration=13]="StyleDeclaration",tJ[tJ.Selection=14]="Selection",tJ[tJ.AdoptedStyleSheet=15]="AdoptedStyleSheet",tJ[tJ.CustomElement=16]="CustomElement",tJ),tb="[SessionRecording]",ty="redacted",tw={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:t=>t,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com"]},tS=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],tk=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],tE=["/s/","/e/","/i/"];function mi(t,a,l,c){if(A(t))return t;var d=(null==a?void 0:a["content-length"])||new Blob([t]).size;return R(d)&&(d=parseInt(d)),d>l?tb+" ".concat(c," body too large to record (").concat(d," bytes)"):t}function yi(t,a){if(A(t))return t;var l=t;return pt(l,!1)||(l=tb+" "+a+" body "+ty),K(tk,t=>{var c,d;null!==(c=l)&&void 0!==c&&c.length&&-1!==(null===(d=l)||void 0===d?void 0:d.indexOf(t))&&(l=tb+" "+a+" body "+ty+" as might contain: "+t)}),l}var bi=(t,a)=>{var l,c,d={payloadSizeLimitBytes:tw.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...tw.performanceEntryTypeToObserve],payloadHostDenyList:[...a.payloadHostDenyList||[],...tw.payloadHostDenyList]},h=!1!==t.session_recording.recordHeaders&&a.recordHeaders,_=!1!==t.session_recording.recordBody&&a.recordBody,p=!1!==t.capture_performance&&a.recordPerformance,g=(c=Math.min(1e6,null!==(l=d.payloadSizeLimitBytes)&&void 0!==l?l:1e6),t=>(null!=t&&t.requestBody&&(t.requestBody=mi(t.requestBody,t.requestHeaders,c,"Request")),null!=t&&t.responseBody&&(t.responseBody=mi(t.responseBody,t.responseHeaders,c,"Response")),t)),u=a=>{var l;return g(((t,a)=>{var l,c=St(t.name),d=0===a.indexOf("http")?null===(l=St(a))||void 0===l?void 0:l.pathname:a;"/"===d&&(d="");var h=null==c?void 0:c.pathname.replace(d||"","");if(!(c&&h&&tE.some(t=>0===h.indexOf(t))))return t})((A(l=a.requestHeaders)||K(Object.keys(null!=l?l:{}),t=>{tS.includes(t.toLowerCase())&&(l[t]=ty)}),a),t.api_host))},v=I(t.session_recording.maskNetworkRequestFn);return v&&I(t.session_recording.maskCapturedNetworkRequestFn)&&ec.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),v&&(t.session_recording.maskCapturedNetworkRequestFn=a=>{var l=t.session_recording.maskNetworkRequestFn({url:a.name});return W(W({},a),{},{name:null==l?void 0:l.url})}),d.maskRequestFn=I(t.session_recording.maskCapturedNetworkRequestFn)?a=>{var l,c,d,h=u(a);return h&&null!==(l=null===(c=(d=t.session_recording).maskCapturedNetworkRequestFn)||void 0===c?void 0:c.call(d,h))&&void 0!==l?l:void 0}:t=>(function(t){if(!F(t))return t.requestBody=yi(t.requestBody,"Request"),t.responseBody=yi(t.responseBody,"Response"),t})(u(t)),W(W(W({},tw),d),{},{recordHeaders:h,recordBody:_,recordPerformance:p,recordInitialRequests:p})};function wi(t,a,l,c,d){return a>l&&(ec.warn("min cannot be greater than max."),a=l),O(t)?t>l?(c&&ec.warn(c+" cannot be  greater than max: "+l+". Using max value instead."),l):t<a?(c&&ec.warn(c+" cannot be less than min: "+a+". Using min value instead."),a):t:(c&&ec.warn(c+" must be a number. using max or fallback. max: "+l+", fallback: "+d),wi(d||l,a,l,c))}let Si=class Si{constructor(t){var a,l,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};V(this,"bucketSize",100),V(this,"refillRate",10),V(this,"mutationBuckets",{}),V(this,"loggedTracker",{}),V(this,"refillBuckets",()=>{Object.keys(this.mutationBuckets).forEach(t=>{this.mutationBuckets[t]=this.mutationBuckets[t]+this.refillRate,this.mutationBuckets[t]>=this.bucketSize&&delete this.mutationBuckets[t]})}),V(this,"getNodeOrRelevantParent",t=>{var a=this.rrweb.mirror.getNode(t);if("svg"!==(null==a?void 0:a.nodeName)&&a instanceof Element){var l=a.closest("svg");if(l)return[this.rrweb.mirror.getId(l),l]}return[t,a]}),V(this,"numberOfChanges",t=>{var a,l,c,d,h,_,p,g;return(null!==(a=null===(l=t.removes)||void 0===l?void 0:l.length)&&void 0!==a?a:0)+(null!==(c=null===(d=t.attributes)||void 0===d?void 0:d.length)&&void 0!==c?c:0)+(null!==(h=null===(_=t.texts)||void 0===_?void 0:_.length)&&void 0!==h?h:0)+(null!==(p=null===(g=t.adds)||void 0===g?void 0:g.length)&&void 0!==p?p:0)}),V(this,"throttleMutations",t=>{if(3!==t.type||0!==t.data.source)return t;var a=t.data,l=this.numberOfChanges(a);a.attributes&&(a.attributes=a.attributes.filter(t=>{var a,l,c,[d,h]=this.getNodeOrRelevantParent(t.id);return 0!==this.mutationBuckets[d]&&(this.mutationBuckets[d]=null!==(a=this.mutationBuckets[d])&&void 0!==a?a:this.bucketSize,this.mutationBuckets[d]=Math.max(this.mutationBuckets[d]-1,0),0===this.mutationBuckets[d]&&(this.loggedTracker[d]||(this.loggedTracker[d]=!0,null===(l=(c=this.options).onBlockedNode)||void 0===l||l.call(c,d,h))),t)}));var c=this.numberOfChanges(a);return 0!==c||l===c?t:void 0}),this.rrweb=t,this.options=c,this.refillRate=wi(null!==(a=this.options.refillRate)&&void 0!==a?a:this.refillRate,0,100,"mutation throttling refill rate"),this.bucketSize=wi(null!==(l=this.options.bucketSize)&&void 0!==l?l:this.bucketSize,0,100,"mutation throttling bucket size"),setInterval(()=>{this.refillBuckets()},1e3)}};var tx=Uint8Array,tF=Uint16Array,tI=Uint32Array,tP=new tx([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tC=new tx([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tR=new tx([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fi=function(t,a){for(var l=new tF(31),c=0;c<31;++c)l[c]=a+=1<<t[c-1];var d=new tI(l[30]);for(c=1;c<30;++c)for(var h=l[c];h<l[c+1];++h)d[h]=h-l[c]<<5|c;return[l,d]},tT=Fi(tP,2),t$=tT[0],tA=tT[1];t$[28]=258,tA[258]=28;for(var tO=Fi(tC,0)[1],tM=new tF(32768),tL=0;tL<32768;++tL){var tD=(43690&tL)>>>1|(21845&tL)<<1;tD=(61680&(tD=(52428&tD)>>>2|(13107&tD)<<2))>>>4|(3855&tD)<<4,tM[tL]=((65280&tD)>>>8|(255&tD)<<8)>>>1}var Di=function(t,a,l){for(var c=t.length,d=0,h=new tF(a);d<c;++d)++h[t[d]-1];var _,p=new tF(a);for(d=0;d<a;++d)p[d]=p[d-1]+h[d-1]<<1;if(l){_=new tF(1<<a);var g=15-a;for(d=0;d<c;++d)if(t[d])for(var v=d<<4|t[d],f=a-t[d],w=p[t[d]-1]++<<f,S=w|(1<<f)-1;w<=S;++w)_[tM[w]>>>g]=v}else for(_=new tF(c),d=0;d<c;++d)_[d]=tM[p[t[d]-1]++]>>>15-t[d];return _},tW=new tx(288);for(tL=0;tL<144;++tL)tW[tL]=8;for(tL=144;tL<256;++tL)tW[tL]=9;for(tL=256;tL<280;++tL)tW[tL]=7;for(tL=280;tL<288;++tL)tW[tL]=8;var tq=new tx(32);for(tL=0;tL<32;++tL)tq[tL]=5;var tN=Di(tW,9,0),tB=Di(tq,5,0),Ui=function(t){return(t/8>>0)+(7&t&&1)},zi=function(t,a,l){(null==l||l>t.length)&&(l=t.length);var c=new(t instanceof tF?tF:t instanceof tI?tI:tx)(l-a);return c.set(t.subarray(a,l)),c},ji=function(t,a,l){l<<=7&a;var c=a/8>>0;t[c]|=l,t[c+1]|=l>>>8},Wi=function(t,a,l){l<<=7&a;var c=a/8>>0;t[c]|=l,t[c+1]|=l>>>8,t[c+2]|=l>>>16},Vi=function(t,a){for(var l=[],c=0;c<t.length;++c)t[c]&&l.push({s:c,f:t[c]});var d=l.length,h=l.slice();if(!d)return[new tx(0),0];if(1==d){var _=new tx(l[0].s+1);return _[l[0].s]=1,[_,1]}l.sort(function(t,a){return t.f-a.f}),l.push({s:-1,f:25001});var p=l[0],g=l[1],v=0,f=1,w=2;for(l[0]={s:-1,f:p.f+g.f,l:p,r:g};f!=d-1;)p=l[l[v].f<l[w].f?v++:w++],g=l[v!=f&&l[v].f<l[w].f?v++:w++],l[f++]={s:-1,f:p.f+g.f,l:p,r:g};var S=h[0].s;for(c=1;c<d;++c)h[c].s>S&&(S=h[c].s);var k=new tF(S+1),E=Gi(l[f-1],k,0);if(E>a){c=0;var x=0,B=E-a,H=1<<B;for(h.sort(function(t,a){return k[a.s]-k[t.s]||t.f-a.f});c<d;++c){var U=h[c].s;if(!(k[U]>a))break;x+=H-(1<<E-k[U]),k[U]=a}for(x>>>=B;x>0;){var J=h[c].s;k[J]<a?x-=1<<a-k[J]++-1:++c}for(;c>=0&&x;--c){var ei=h[c].s;k[ei]==a&&(--k[ei],++x)}E=a}return[new tx(k),E]},Gi=function(t,a,l){return -1==t.s?Math.max(Gi(t.l,a,l+1),Gi(t.r,a,l+1)):a[t.s]=l},Ji=function(t){for(var a=t.length;a&&!t[--a];);for(var l=new tF(++a),c=0,d=t[0],h=1,o=function(t){l[c++]=t},_=1;_<=a;++_)if(t[_]==d&&_!=a)++h;else{if(!d&&h>2){for(;h>138;h-=138)o(32754);h>2&&(o(h>10?h-11<<5|28690:h-3<<5|12305),h=0)}else if(h>3){for(o(d),--h;h>6;h-=6)o(8304);h>2&&(o(h-3<<5|8208),h=0)}for(;h--;)o(d);h=1,d=t[_]}return[l.subarray(0,c),a]},Yi=function(t,a){for(var l=0,c=0;c<a.length;++c)l+=t[c]*a[c];return l},Ki=function(t,a,l){var c=l.length,d=Ui(a+2);t[d]=255&c,t[d+1]=c>>>8,t[d+2]=255^t[d],t[d+3]=255^t[d+1];for(var h=0;h<c;++h)t[d+h+4]=l[h];return 8*(d+4+c)},Xi=function(t,a,l,c,d,h,_,p,g,v,f){ji(a,f++,l),++d[256];for(var w=Vi(d,15),S=w[0],k=w[1],E=Vi(h,15),x=E[0],B=E[1],H=Ji(S),U=H[0],J=H[1],ei=Ji(x),er=ei[0],en=ei[1],ea=new tF(19),el=0;el<U.length;++el)ea[31&U[el]]++;for(el=0;el<er.length;++el)ea[31&er[el]]++;for(var ec=Vi(ea,7),eu=ec[0],ed=ec[1],eh=19;eh>4&&!eu[tR[eh-1]];--eh);var e_,ep,eg,ev,ef=v+5<<3,em=Yi(d,tW)+Yi(h,tq)+_,eb=Yi(d,S)+Yi(h,x)+_+14+3*eh+Yi(ea,eu)+(2*ea[16]+3*ea[17]+7*ea[18]);if(ef<=em&&ef<=eb)return Ki(a,f,t.subarray(g,g+v));if(ji(a,f,1+(eb<em)),f+=2,eb<em){e_=Di(S,k,0),ep=S,eg=Di(x,B,0),ev=x;var ey=Di(eu,ed,0);for(ji(a,f,J-257),ji(a,f+5,en-1),ji(a,f+10,eh-4),f+=14,el=0;el<eh;++el)ji(a,f+3*el,eu[tR[el]]);f+=3*eh;for(var ew=[U,er],eS=0;eS<2;++eS){var ek=ew[eS];for(el=0;el<ek.length;++el){var eE=31&ek[el];ji(a,f,ey[eE]),f+=eu[eE],eE>15&&(ji(a,f,ek[el]>>>5&127),f+=ek[el]>>>12)}}}else e_=tN,ep=tW,eg=tB,ev=tq;for(el=0;el<p;++el)if(c[el]>255){Wi(a,f,e_[(eE=c[el]>>>18&31)+257]),f+=ep[eE+257],eE>7&&(ji(a,f,c[el]>>>23&31),f+=tP[eE]);var ex=31&c[el];Wi(a,f,eg[ex]),f+=ev[ex],ex>3&&(Wi(a,f,c[el]>>>5&8191),f+=tC[ex])}else Wi(a,f,e_[c[el]]),f+=ep[c[el]];return Wi(a,f,e_[256]),f+ep[256]},tV=new tI([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),tH=function(){for(var t=new tI(256),a=0;a<256;++a){for(var l=a,c=9;--c;)l=(1&l&&3988292384)^l>>>1;t[a]=l}return t}(),es=function(){var t=4294967295;return{p:function(a){for(var l=t,c=0;c<a.length;++c)l=tH[255&l^a[c]]^l>>>8;t=l},d:function(){return 4294967295^t}}},is=function(t,a,l){for(;l;++a)t[a]=l,l>>>=8},ss=function(t,a){var l=a.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=a.level<2?4:9==a.level?2:0,t[9]=3,0!=a.mtime&&is(t,4,Math.floor(new Date(a.mtime||Date.now())/1e3)),l){t[3]=8;for(var c=0;c<=l.length;++c)t[c+10]=l.charCodeAt(c)}};function ns(t,a){void 0===a&&(a={});var l,c,d,h=es(),_=t.length;h.p(t);var p=(c=a,d=10+((l=a).filename&&l.filename.length+1||0),function(t,a,l,c,d,h){var _=t.length,p=new tx(c+_+5*(1+Math.floor(_/7e3))+d),g=p.subarray(c,p.length-d),v=0;if(!a||_<8)for(var f=0;f<=_;f+=65535){var w=f+65535;w<_?v=Ki(g,v,t.subarray(f,w)):(g[f]=h,v=Ki(g,v,t.subarray(f,_)))}else{for(var S=tV[a-1],k=S>>>13,E=8191&S,x=(1<<l)-1,B=new tF(32768),H=new tF(x+1),U=Math.ceil(l/3),J=2*U,b=function(a){return(t[a]^t[a+1]<<U^t[a+2]<<J)&x},ei=new tI(25e3),er=new tF(288),en=new tF(32),ea=0,el=0,ec=(f=0,0),eu=0,ed=0;f<_;++f){var eh=b(f),e_=32767&f,ep=H[eh];if(B[e_]=ep,H[eh]=e_,eu<=f){var eg=_-f;if((ea>7e3||ec>24576)&&eg>423){v=Xi(t,g,0,ei,er,en,el,ec,ed,f-ed,v),ec=ea=el=0,ed=f;for(var ev=0;ev<286;++ev)er[ev]=0;for(ev=0;ev<30;++ev)en[ev]=0}var ef=2,em=0,eb=E,ey=e_-ep&32767;if(eg>2&&eh==b(f-ey))for(var ew=Math.min(k,eg)-1,eS=Math.min(32767,f),ek=Math.min(258,eg);ey<=eS&&--eb&&e_!=ep;){if(t[f+ef]==t[f+ef-ey]){for(var eE=0;eE<ek&&t[f+eE]==t[f+eE-ey];++eE);if(eE>ef){if(ef=eE,em=ey,eE>ew)break;var ex=Math.min(ey,eE-2),eF=0;for(ev=0;ev<ex;++ev){var eI=f-ey+ev+32768&32767,eP=eI-B[eI]+32768&32767;eP>eF&&(eF=eP,ep=eI)}}}ey+=(e_=ep)-(ep=B[e_])+32768&32767}if(em){ei[ec++]=268435456|tA[ef]<<18|tO[em];var eC=31&tA[ef],eR=31&tO[em];el+=tP[eC]+tC[eR],++er[257+eC],++en[eR],eu=f+ef,++ea}else ei[ec++]=t[f],++er[t[f]]}}v=Xi(t,g,h,ei,er,en,el,ec,ed,f-ed,v)}return zi(p,0,c+Ui(v)+d)}(t,null==c.level?6:c.level,null==c.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+c.mem,d,8,!0)),g=p.length;return ss(p,a),is(p,g-8,h.d()),is(p,g-4,_),p}function os(t,a){var l=t.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t);for(var c=new tx(t.length+(t.length>>>1)),d=0,n=function(t){c[d++]=t},h=0;h<l;++h){if(d+5>c.length){var _=new tx(d+8+(l-h<<1));_.set(c),c=_}var p=t.charCodeAt(h);p<128||a?n(p):(p<2048?n(192|p>>>6):(p>55295&&p<57344?(n(240|(p=65536+(1047552&p)|1023&t.charCodeAt(++h))>>>18),n(128|p>>>12&63)):n(224|p>>>12),n(128|p>>>6&63)),n(128|63&p))}return zi(c,0,d)}var tU="[SessionRecording]",tz=eu(tU),tj=[tm.MouseMove,tm.MouseInteraction,tm.Scroll,tm.ViewportResize,tm.Input,tm.TouchMove,tm.MediaInteraction,tm.Drag],hs=t=>({rrwebMethod:t,enqueuedAt:Date.now(),attempt:1});function _s(t){return function(t,a){for(var l="",c=0;c<t.length;){var d=t[c++];d<128||a?l+=String.fromCharCode(d):d<224?l+=String.fromCharCode((31&d)<<6|63&t[c++]):d<240?l+=String.fromCharCode((15&d)<<12|(63&t[c++])<<6|63&t[c++]):l+=String.fromCharCode(55296|(d=((15&d)<<18|(63&t[c++])<<12|(63&t[c++])<<6|63&t[c++])-65536)>>10,56320|1023&d)}return l}(ns(os(JSON.stringify(t))),!0)}function ps(t){return t.type===tf.Custom&&"sessionIdle"===t.data.tag}function gs(t,a){return a.some(a=>"regex"===a.matching&&new RegExp(a.url).test(t))}let vs=class vs{get sessionIdleThresholdMilliseconds(){return this.instance.config.session_recording.session_idle_threshold_ms||3e5}get rrwebRecord(){var t,a;return null==B||null===(t=B.__PosthogExtensions__)||void 0===t||null===(a=t.rrweb)||void 0===a?void 0:a.record}get started(){return this._captureStarted}get sessionManager(){if(!this.instance.sessionManager)throw Error(tU+" must be started with a valid sessionManager.");return this.instance.sessionManager}get fullSnapshotIntervalMillis(){var t,a;return"trigger_pending"===this.triggerStatus?6e4:null!==(t=null===(a=this.instance.config.session_recording)||void 0===a?void 0:a.full_snapshot_interval_millis)&&void 0!==t?t:3e5}get isSampled(){var t=this.instance.get_property(e$);return M(t)?t:null}get sessionDuration(){var t,a,l=null===(t=this.buffer)||void 0===t?void 0:t.data[(null===(a=this.buffer)||void 0===a?void 0:a.data.length)-1],{sessionStartTimestamp:c}=this.sessionManager.checkAndGetSessionAndWindowId(!0);return l?l.timestamp-c:null}get isRecordingEnabled(){var t=!!this.instance.get_property(ek),a=!this.instance.config.disable_session_recording;return d&&t&&a}get isConsoleLogCaptureEnabled(){var t=!!this.instance.get_property(eE),a=this.instance.config.enable_recording_console_log;return null!=a?a:t}get canvasRecording(){var t,a,l,c,d,h,_=this.instance.config.session_recording.captureCanvas,p=this.instance.get_property(eI),g=null!==(t=null!==(a=null==_?void 0:_.recordCanvas)&&void 0!==a?a:null==p?void 0:p.enabled)&&void 0!==t&&t,v=null!==(l=null!==(c=null==_?void 0:_.canvasFps)&&void 0!==c?c:null==p?void 0:p.fps)&&void 0!==l?l:4,f=null!==(d=null!==(h=null==_?void 0:_.canvasQuality)&&void 0!==h?h:null==p?void 0:p.quality)&&void 0!==d?d:.4;if("string"==typeof f){var w=parseFloat(f);f=isNaN(w)?.4:w}return{enabled:g,fps:wi(v,0,12,"canvas recording fps",4),quality:wi(f,0,1,"canvas recording quality",.4)}}get networkPayloadCapture(){var t,a,l=this.instance.get_property(ex),c={recordHeaders:null===(t=this.instance.config.session_recording)||void 0===t?void 0:t.recordHeaders,recordBody:null===(a=this.instance.config.session_recording)||void 0===a?void 0:a.recordBody},d=(null==c?void 0:c.recordHeaders)||(null==l?void 0:l.recordHeaders),h=(null==c?void 0:c.recordBody)||(null==l?void 0:l.recordBody),_=P(this.instance.config.capture_performance)?this.instance.config.capture_performance.network_timing:this.instance.config.capture_performance,p=!!(M(_)?_:null==l?void 0:l.capturePerformance);return d||h||p?{recordHeaders:d,recordBody:h,recordPerformance:p}:void 0}get masking(){var t,a,l,c,d=this.instance.get_property(eF),h={maskAllInputs:null===(t=this.instance.config.session_recording)||void 0===t?void 0:t.maskAllInputs,maskTextSelector:null===(a=this.instance.config.session_recording)||void 0===a?void 0:a.maskTextSelector},_=null!==(l=null==h?void 0:h.maskAllInputs)&&void 0!==l?l:null==d?void 0:d.maskAllInputs,p=null!==(c=null==h?void 0:h.maskTextSelector)&&void 0!==c?c:null==d?void 0:d.maskTextSelector;return F(_)&&F(p)?void 0:{maskAllInputs:_,maskTextSelector:p}}get sampleRate(){var t=this.instance.get_property(eP);return O(t)?t:null}get minimumDuration(){var t=this.instance.get_property(eC);return O(t)?t:null}get status(){return this.receivedDecide?this.isRecordingEnabled?!1===this.isSampled?"disabled":this._urlBlocked?"paused":A(this._linkedFlag)||this._linkedFlagSeen?"trigger_pending"===this.triggerStatus?"buffering":M(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"buffering":"disabled":"buffering"}get urlTriggerStatus(){var t;return 0===this._urlTriggers.length?"trigger_disabled":(null===(t=this.instance)||void 0===t?void 0:t.get_property(eA))===this.sessionId?"trigger_activated":"trigger_pending"}get eventTriggerStatus(){var t;return 0===this._eventTriggers.length?"trigger_disabled":(null===(t=this.instance)||void 0===t?void 0:t.get_property(eO))===this.sessionId?"trigger_activated":"trigger_pending"}get triggerStatus(){var t="trigger_activated"===this.eventTriggerStatus||"trigger_activated"===this.urlTriggerStatus,a="trigger_pending"===this.eventTriggerStatus||"trigger_pending"===this.urlTriggerStatus;return t?"trigger_activated":a?"trigger_pending":"trigger_disabled"}constructor(t){if(V(this,"queuedRRWebEvents",[]),V(this,"isIdle",!1),V(this,"_linkedFlagSeen",!1),V(this,"_lastActivityTimestamp",Date.now()),V(this,"_linkedFlag",null),V(this,"_removePageViewCaptureHook",void 0),V(this,"_onSessionIdListener",void 0),V(this,"_persistDecideOnSessionListener",void 0),V(this,"_samplingSessionListener",void 0),V(this,"_urlTriggers",[]),V(this,"_urlBlocklist",[]),V(this,"_urlBlocked",!1),V(this,"_eventTriggers",[]),V(this,"_removeEventTriggerCaptureHook",void 0),V(this,"_forceAllowLocalhostNetworkCapture",!1),V(this,"_onBeforeUnload",()=>{this._flushBuffer()}),V(this,"_onOffline",()=>{this._tryAddCustomEvent("browser offline",{})}),V(this,"_onOnline",()=>{this._tryAddCustomEvent("browser online",{})}),V(this,"_onVisibilityChange",()=>{if(null!=f&&f.visibilityState){var t="window "+f.visibilityState;this._tryAddCustomEvent(t,{})}}),this.instance=t,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,!this.instance.sessionManager)throw tz.error("started without valid sessionManager"),Error(tU+" started without valid sessionManager. This is a bug.");if(this.instance.config.__preview_experimental_cookieless_mode)throw Error(tU+" cannot be used with __preview_experimental_cookieless_mode.");var{sessionId:a,windowId:l}=this.sessionManager.checkAndGetSessionAndWindowId();this.sessionId=a,this.windowId=l,this.buffer=this.clearBuffer(),this.sessionIdleThresholdMilliseconds>=this.sessionManager.sessionTimeoutMs&&tz.warn("session_idle_threshold_ms (".concat(this.sessionIdleThresholdMilliseconds,") is greater than the session timeout (").concat(this.sessionManager.sessionTimeoutMs,"). Session will never be detected as idle"))}startIfEnabledOrStop(t){this.isRecordingEnabled?(this._startCapture(t),ae(d,"beforeunload",this._onBeforeUnload),ae(d,"offline",this._onOffline),ae(d,"online",this._onOnline),ae(d,"visibilitychange",this._onVisibilityChange),this._setupSampling(),this._addEventTriggerListener(),A(this._removePageViewCaptureHook)&&(this._removePageViewCaptureHook=this.instance.on("eventCaptured",t=>{try{if("$pageview"===t.event){var a=null!=t&&t.properties.$current_url?this._maskUrl(null==t?void 0:t.properties.$current_url):"";if(!a)return;this._tryAddCustomEvent("$pageview",{href:a})}}catch(t){tz.error("Could not add $pageview to rrweb session",t)}})),this._onSessionIdListener||(this._onSessionIdListener=this.sessionManager.onSessionId((t,a,l)=>{var c,d,h,_;l&&(this._tryAddCustomEvent("$session_id_change",{sessionId:t,windowId:a,changeReason:l}),null===(c=this.instance)||void 0===c||null===(d=c.persistence)||void 0===d||d.unregister(eO),null===(h=this.instance)||void 0===h||null===(_=h.persistence)||void 0===_||_.unregister(eA))}))):this.stopRecording()}stopRecording(){var t,a,l,c;this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,null==d||d.removeEventListener("beforeunload",this._onBeforeUnload),null==d||d.removeEventListener("offline",this._onOffline),null==d||d.removeEventListener("online",this._onOnline),null==d||d.removeEventListener("visibilitychange",this._onVisibilityChange),this.clearBuffer(),clearInterval(this._fullSnapshotTimer),null===(t=this._removePageViewCaptureHook)||void 0===t||t.call(this),this._removePageViewCaptureHook=void 0,null===(a=this._removeEventTriggerCaptureHook)||void 0===a||a.call(this),this._removeEventTriggerCaptureHook=void 0,null===(l=this._onSessionIdListener)||void 0===l||l.call(this),this._onSessionIdListener=void 0,null===(c=this._samplingSessionListener)||void 0===c||c.call(this),this._samplingSessionListener=void 0,tz.info("stopped"))}makeSamplingDecision(t){var a,l,c=this.sessionId!==t,d=this.sampleRate;if(O(d)){var h=this.isSampled,_=c||!M(h),p=_?function(t){for(var a=0,l=0;l<t.length;l++)a=(a<<5)-a+t.charCodeAt(l)|0;return Math.abs(a)}(t)%100<wi(100*d,0,100):h;_&&(p?this._reportStarted("sampled"):tz.warn("Sample rate (".concat(d,") has determined that this sessionId (").concat(t,") will not be sent to the server.")),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:d,isSampled:p})),null===(l=this.instance.persistence)||void 0===l||l.register({[e$]:p})}else null===(a=this.instance.persistence)||void 0===a||a.register({[e$]:null})}onRemoteConfig(t){var a,l,c,d,h,_;if(this._tryAddCustomEvent("$remote_config_received",t),this._persistRemoteConfig(t),this._linkedFlag=(null===(a=t.sessionRecording)||void 0===a?void 0:a.linkedFlag)||null,null!==(l=t.sessionRecording)&&void 0!==l&&l.endpoint&&(this._endpoint=null===(_=t.sessionRecording)||void 0===_?void 0:_.endpoint),this._setupSampling(),!A(this._linkedFlag)&&!this._linkedFlagSeen){var p=R(this._linkedFlag)?this._linkedFlag:this._linkedFlag.flag,g=R(this._linkedFlag)?null:this._linkedFlag.variant;this.instance.onFeatureFlags((t,a)=>{var l=P(a)&&p in a,c=g?a[p]===g:l;c&&this._reportStarted("linked_flag_matched",{linkedFlag:p,linkedVariant:g}),this._linkedFlagSeen=c})}null!==(c=t.sessionRecording)&&void 0!==c&&c.urlTriggers&&(this._urlTriggers=t.sessionRecording.urlTriggers),null!==(d=t.sessionRecording)&&void 0!==d&&d.urlBlocklist&&(this._urlBlocklist=t.sessionRecording.urlBlocklist),null!==(h=t.sessionRecording)&&void 0!==h&&h.eventTriggers&&(this._eventTriggers=t.sessionRecording.eventTriggers),this.receivedDecide=!0,this.startIfEnabledOrStop()}_setupSampling(){O(this.sampleRate)&&A(this._samplingSessionListener)&&(this._samplingSessionListener=this.sessionManager.onSessionId(t=>{this.makeSamplingDecision(t)}))}_persistRemoteConfig(t){if(this.instance.persistence){var a,l=this.instance.persistence,s=()=>{var a,c,d,h,_,p,g,v,f,w=null===(a=t.sessionRecording)||void 0===a?void 0:a.sampleRate,S=A(w)?null:parseFloat(w),k=null===(c=t.sessionRecording)||void 0===c?void 0:c.minimumDurationMilliseconds;l.register({[ek]:!!t.sessionRecording,[eE]:null===(d=t.sessionRecording)||void 0===d?void 0:d.consoleLogRecordingEnabled,[ex]:W({capturePerformance:t.capturePerformance},null===(h=t.sessionRecording)||void 0===h?void 0:h.networkPayloadCapture),[eF]:null===(_=t.sessionRecording)||void 0===_?void 0:_.masking,[eI]:{enabled:null===(p=t.sessionRecording)||void 0===p?void 0:p.recordCanvas,fps:null===(g=t.sessionRecording)||void 0===g?void 0:g.canvasFps,quality:null===(v=t.sessionRecording)||void 0===v?void 0:v.canvasQuality},[eP]:S,[eC]:F(k)?null:k,[eR]:null===(f=t.sessionRecording)||void 0===f?void 0:f.scriptConfig})};s(),null===(a=this._persistDecideOnSessionListener)||void 0===a||a.call(this),this._persistDecideOnSessionListener=this.sessionManager.onSessionId(s)}}log(t){var a,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";null===(a=this.instance.sessionRecording)||void 0===a||a.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:l,trace:[],payload:[JSON.stringify(t)]}},timestamp:Date.now()})}_startCapture(t){if(!F(Object.assign)&&!F(Array.from)&&!(this._captureStarted||this.instance.config.disable_session_recording||this.instance.consent.isOptedOut())){var a,l;(this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId(),this.rrwebRecord)?this._onScriptLoaded():null===(a=B.__PosthogExtensions__)||void 0===a||null===(l=a.loadExternalDependency)||void 0===l||l.call(a,this.instance,this.scriptName,t=>{if(t)return tz.error("could not load recorder",t);this._onScriptLoaded()}),tz.info("starting"),"active"===this.status&&this._reportStarted(t||"recording_initialized")}}get scriptName(){var t,a,l;return(null===(t=this.instance)||void 0===t||null===(a=t.persistence)||void 0===a||null===(l=a.get_property(eR))||void 0===l?void 0:l.script)||"recorder"}isInteractiveEvent(t){var a;return 3===t.type&&-1!==tj.indexOf(null===(a=t.data)||void 0===a?void 0:a.source)}_updateWindowAndSessionIds(t){var a=this.isInteractiveEvent(t);a||this.isIdle||t.timestamp-this._lastActivityTimestamp>this.sessionIdleThresholdMilliseconds&&(this.isIdle=!0,clearInterval(this._fullSnapshotTimer),this._tryAddCustomEvent("sessionIdle",{eventTimestamp:t.timestamp,lastActivityTimestamp:this._lastActivityTimestamp,threshold:this.sessionIdleThresholdMilliseconds,bufferLength:this.buffer.data.length,bufferSize:this.buffer.size}),this._flushBuffer());var l=!1;if(a&&(this._lastActivityTimestamp=t.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:t.type}),l=!0)),!this.isIdle){var{windowId:c,sessionId:d}=this.sessionManager.checkAndGetSessionAndWindowId(!a,t.timestamp),h=this.sessionId!==d,_=this.windowId!==c;this.windowId=c,this.sessionId=d,h||_?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):l&&this._scheduleFullSnapshot()}}_tryRRWebMethod(t){try{return t.rrwebMethod(),!0}catch(a){return this.queuedRRWebEvents.length<10?this.queuedRRWebEvents.push({enqueuedAt:t.enqueuedAt||Date.now(),attempt:t.attempt++,rrwebMethod:t.rrwebMethod}):tz.warn("could not emit queued rrweb event.",a,t),!1}}_tryAddCustomEvent(t,a){return this._tryRRWebMethod(hs(()=>this.rrwebRecord.addCustomEvent(t,a)))}_tryTakeFullSnapshot(){return this._tryRRWebMethod(hs(()=>this.rrwebRecord.takeFullSnapshot()))}_onScriptLoaded(){var t,a,l={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1};for(var[c,d]of Object.entries(this.instance.config.session_recording||{}))c in l&&("maskInputOptions"===c?l.maskInputOptions=W({password:!0},d):l[c]=d);if(this.canvasRecording&&this.canvasRecording.enabled&&(l.recordCanvas=!0,l.sampling={canvas:this.canvasRecording.fps},l.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.masking&&(l.maskAllInputs=this.masking.maskAllInputs,l.maskTextSelector=null!==(a=this.masking.maskTextSelector)&&void 0!==a?a:void 0),this.rrwebRecord){this.mutationRateLimiter=null!==(t=this.mutationRateLimiter)&&void 0!==t?t:new Si(this.rrwebRecord,{refillRate:this.instance.config.session_recording.__mutationRateLimiterRefillRate,bucketSize:this.instance.config.session_recording.__mutationRateLimiterBucketSize,onBlockedNode:(t,a)=>{var l="Too many mutations on node '".concat(t,"'. Rate limiting. This could be due to SVG animations or something similar");tz.info(l,{node:a}),this.log(tU+" "+l,"warn")}});var h=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord(W({emit:t=>{this.onRRwebEmit(t)},plugins:h},l)),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:l,activePlugins:h.map(t=>null==t?void 0:t.name)}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else tz.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}_scheduleFullSnapshot(){if(this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),!this.isIdle){var t=this.fullSnapshotIntervalMillis;t&&(this._fullSnapshotTimer=setInterval(()=>{this._tryTakeFullSnapshot()},t))}}_gatherRRWebPlugins(){var t,a,l,c,d=[],h=null===(t=B.__PosthogExtensions__)||void 0===t||null===(a=t.rrwebPlugins)||void 0===a?void 0:a.getRecordConsolePlugin;h&&this.isConsoleLogCaptureEnabled&&d.push(h());var _=null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.rrwebPlugins)||void 0===c?void 0:c.getRecordNetworkPlugin;return this.networkPayloadCapture&&I(_)&&(!e6.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?d.push(_(bi(this.instance.config,this.networkPayloadCapture))):tz.info("NetworkCapture not started because we are on localhost.")),d}onRRwebEmit(t){var a;if(this._processQueuedEvents(),t&&P(t)){if(t.type===tf.Meta){var l=this._maskUrl(t.data.href);if(this._lastHref=l,!l)return;t.data.href=l}else this._pageViewFallBack();if(this._checkUrlTriggerConditions(),!this._urlBlocked||t.type===tf.Custom&&"recording paused"===t.data.tag){t.type===tf.FullSnapshot&&this._scheduleFullSnapshot(),t.type===tf.FullSnapshot&&"trigger_pending"===this.triggerStatus&&this.clearBuffer();var c=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(t):t;if(c){var d=function(t){if(t&&P(t)&&6===t.type&&P(t.data)&&"rrweb/console@1"===t.data.plugin){t.data.payload.payload.length>10&&(t.data.payload.payload=t.data.payload.payload.slice(0,10),t.data.payload.payload.push("...[truncated]"));for(var a=[],l=0;l<t.data.payload.payload.length;l++)t.data.payload.payload[l]&&t.data.payload.payload[l].length>2e3?a.push(t.data.payload.payload[l].slice(0,2e3)+"...[truncated]"):a.push(t.data.payload.payload[l]);return t.data.payload.payload=a,t}return t}(c);if(this._updateWindowAndSessionIds(d),!this.isIdle||ps(d)){if(ps(d)){var h=d.data.payload;if(h){var _=h.lastActivityTimestamp,p=h.threshold;d.timestamp=_+p}}var g=null===(a=this.instance.config.session_recording.compress_events)||void 0===a||a?function(t){if(1024>li(t))return t;try{if(t.type===tf.FullSnapshot)return W(W({},t),{},{data:_s(t.data),cv:"2024-10"});if(t.type===tf.IncrementalSnapshot&&t.data.source===tm.Mutation)return W(W({},t),{},{cv:"2024-10",data:W(W({},t.data),{},{texts:_s(t.data.texts),attributes:_s(t.data.attributes),removes:_s(t.data.removes),adds:_s(t.data.adds)})});if(t.type===tf.IncrementalSnapshot&&t.data.source===tm.StyleSheetRule)return W(W({},t),{},{cv:"2024-10",data:W(W({},t.data),{},{adds:t.data.adds?_s(t.data.adds):void 0,removes:t.data.removes?_s(t.data.removes):void 0})})}catch(t){tz.error("could not compress event - will use uncompressed event",t)}return t}(d):d,v={$snapshot_bytes:li(g),$snapshot_data:g,$session_id:this.sessionId,$window_id:this.windowId};"disabled"!==this.status?this._captureSnapshotBuffered(v):this.clearBuffer()}}}}}_pageViewFallBack(){if(!this.instance.config.capture_pageview&&d){var t=this._maskUrl(d.location.href);this._lastHref!==t&&(this._tryAddCustomEvent("$url_changed",{href:t}),this._lastHref=t)}}_processQueuedEvents(){if(this.queuedRRWebEvents.length){var t=[...this.queuedRRWebEvents];this.queuedRRWebEvents=[],t.forEach(t=>{Date.now()-t.enqueuedAt<=2e3&&this._tryRRWebMethod(t)})}}_maskUrl(t){var a=this.instance.config.session_recording;if(a.maskNetworkRequestFn){var l,c={url:t};return null===(l=c=a.maskNetworkRequestFn(c))||void 0===l?void 0:l.url}return t}clearBuffer(){return this.buffer={size:0,data:[],sessionId:this.sessionId,windowId:this.windowId},this.buffer}_flushBuffer(){this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var t=this.minimumDuration,a=this.sessionDuration,l=O(a)&&a>=0,c=O(t)&&l&&a<t;return"buffering"===this.status||"paused"===this.status||"disabled"===this.status||c?(this.flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3),this.buffer):(this.buffer.data.length>0&&(function ci(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6606028.8;if(t.size>=a&&t.data.length>1){var l=Math.floor(t.data.length/2),c=t.data.slice(0,l),d=t.data.slice(l);return[ci({size:li(c),data:c,sessionId:t.sessionId,windowId:t.windowId}),ci({size:li(d),data:d,sessionId:t.sessionId,windowId:t.windowId})].flatMap(t=>t)}return[t]})(this.buffer).forEach(t=>{this._captureSnapshot({$snapshot_bytes:t.size,$snapshot_data:t.data,$session_id:t.sessionId,$window_id:t.windowId,$lib:"web",$lib_version:H.LIB_VERSION})}),this.clearBuffer())}_captureSnapshotBuffered(t){var a,l=2+((null===(a=this.buffer)||void 0===a?void 0:a.data.length)||0);!this.isIdle&&(this.buffer.size+t.$snapshot_bytes+l>943718.4||this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),this.buffer.size+=t.$snapshot_bytes,this.buffer.data.push(t.$snapshot_data),this.flushBufferTimer||this.isIdle||(this.flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3))}_captureSnapshot(t){this.instance.capture("$snapshot",t,{_url:this.instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}_checkUrlTriggerConditions(){if(void 0!==d&&d.location.href){var t=d.location.href,a=this._urlBlocked,l=gs(t,this._urlBlocklist);l&&!a?this._pauseRecording():!l&&a&&this._resumeRecording(),gs(t,this._urlTriggers)&&this._activateTrigger("url")}}_activateTrigger(t){var a,l;"trigger_pending"===this.triggerStatus&&(null===(a=this.instance)||void 0===a||null===(l=a.persistence)||void 0===l||l.register({["url"===t?eA:eO]:this.sessionId}),this._flushBuffer(),this._reportStarted(t+"_trigger_matched"))}_pauseRecording(){this._urlBlocked||(this._urlBlocked=!0,clearInterval(this._fullSnapshotTimer),tz.info("recording paused due to URL blocker"),this._tryAddCustomEvent("recording paused",{reason:"url blocker"}))}_resumeRecording(){this._urlBlocked&&(this._urlBlocked=!1,this._tryTakeFullSnapshot(),this._scheduleFullSnapshot(),this._tryAddCustomEvent("recording resumed",{reason:"left blocked url"}),tz.info("recording resumed"))}_addEventTriggerListener(){0!==this._eventTriggers.length&&A(this._removeEventTriggerCaptureHook)&&(this._removeEventTriggerCaptureHook=this.instance.on("eventCaptured",t=>{try{this._eventTriggers.includes(t.event)&&this._activateTrigger("event")}catch(t){tz.error("Could not activate event trigger",t)}}))}overrideLinkedFlag(){this._linkedFlagSeen=!0,this._tryTakeFullSnapshot(),this._reportStarted("linked_flag_overridden")}overrideSampling(){var t;null===(t=this.instance.persistence)||void 0===t||t.register({[e$]:!0}),this._tryTakeFullSnapshot(),this._reportStarted("sampling_overridden")}overrideTrigger(t){this._activateTrigger(t)}_reportStarted(t,a){this.instance.register_for_session({$session_recording_start_reason:t}),tz.info(t.replace("_"," "),a),m(["recording_initialized","session_id_changed"],t)||this._tryAddCustomEvent(t,a)}};var tG=eu("[SegmentIntegration]"),tK="posthog-js";function bs(t){var{organization:a,projectId:l,prefix:c,severityAllowList:d=["error"]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h=>{if(!("*"===d||d.includes(h.level))||!t.__loaded)return h;h.tags||(h.tags={});var _,p,g,v,f,w=t.requestRouter.endpointFor("ui","/project/".concat(t.config.token,"/person/").concat(t.get_distinct_id()));h.tags["PostHog Person URL"]=w,t.sessionRecordingStarted()&&(h.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var S=(null===(_=h.exception)||void 0===_?void 0:_.values)||[],k=S.map(t=>W(W({},t),{},{stacktrace:t.stacktrace?W(W({},t.stacktrace),{},{type:"raw",frames:(t.stacktrace.frames||[]).map(t=>W(W({},t),{},{platform:"web:javascript"}))}):void 0})),E={$exception_message:(null===(p=S[0])||void 0===p?void 0:p.value)||h.message,$exception_type:null===(g=S[0])||void 0===g?void 0:g.type,$exception_personURL:w,$exception_level:h.level,$exception_list:k,$sentry_event_id:h.event_id,$sentry_exception:h.exception,$sentry_exception_message:(null===(v=S[0])||void 0===v?void 0:v.value)||h.message,$sentry_exception_type:null===(f=S[0])||void 0===f?void 0:f.type,$sentry_tags:h.tags};return a&&l&&(E.$sentry_url=(c||"https://sentry.io/organizations/")+a+"/issues/?project="+l+"&query="+h.event_id),t.exceptions.sendExceptionEvent(E),h}}let ws=class ws{constructor(t,a,l,c,d){this.name=tK,this.setupOnce=function(h){h(bs(t,{organization:a,projectId:l,prefix:c,severityAllowList:d}))}}};var tX,tY,tJ,tQ,tZ=null!=d&&d.location?It(d.location.hash,"__posthog")||It(location.hash,"state"):null,t0="_postHogToolbarParams",t1=eu("[Toolbar]");(t6=tQ||(tQ={}))[t6.UNINITIALIZED=0]="UNINITIALIZED",t6[t6.LOADING=1]="LOADING",t6[t6.LOADED=2]="LOADED";let Is=class Is{constructor(t){this.instance=t}setToolbarState(t){B.ph_toolbar_state=t}getToolbarState(){var t;return null!==(t=B.ph_toolbar_state)&&void 0!==t?t:tQ.UNINITIALIZED}maybeLoadToolbar(){var t,a,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(!d||!f)return!1;l=null!==(t=l)&&void 0!==t?t:d.location,h=null!==(a=h)&&void 0!==a?a:d.history;try{if(!c){try{d.localStorage.setItem("test","test"),d.localStorage.removeItem("test")}catch(t){return!1}c=null==d?void 0:d.localStorage}var _,p=tZ||It(l.hash,"__posthog")||It(l.hash,"state"),g=p?ee(()=>JSON.parse(atob(decodeURIComponent(p))))||ee(()=>JSON.parse(decodeURIComponent(p))):null;return g&&"ph_authorize"===g.action?((_=g).source="url",_&&Object.keys(_).length>0&&(g.desiredHash?l.hash=g.desiredHash:h?h.replaceState(h.state,"",l.pathname+l.search):l.hash="")):((_=JSON.parse(c.getItem(t0)||"{}")).source="localstorage",delete _.userIntent),!(!_.token||this.instance.config.token!==_.token)&&(this.loadToolbar(_),!0)}catch(t){return!1}}_callLoadToolbar(t){var a=B.ph_load_toolbar||B.ph_load_editor;!A(a)&&I(a)?a(t,this.instance):t1.warn("No toolbar load function found")}loadToolbar(t){var a,l,c=!(null==f||!f.getElementById(eX));if(!d||c)return!1;var h="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,_=W(W({token:this.instance.config.token},t),{},{apiURL:this.instance.requestRouter.endpointFor("ui")},h?{instrument:!1}:{});return(d.localStorage.setItem(t0,JSON.stringify(W(W({},_),{},{source:void 0}))),this.getToolbarState()===tQ.LOADED)?this._callLoadToolbar(_):this.getToolbarState()===tQ.UNINITIALIZED&&(this.setToolbarState(tQ.LOADING),null===(a=B.__PosthogExtensions__)||void 0===a||null===(l=a.loadExternalDependency)||void 0===l||l.call(a,this.instance,"toolbar",t=>{if(t)return t1.error("[Toolbar] Failed to load",t),void this.setToolbarState(tQ.UNINITIALIZED);this.setToolbarState(tQ.LOADED),this._callLoadToolbar(_)}),ae(d,"turbolinks:load",()=>{this.setToolbarState(tQ.UNINITIALIZED),this.loadToolbar(_)})),!0}_loadEditor(t){return this.loadToolbar(t)}maybeLoadEditor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this.maybeLoadToolbar(t,a,l)}};var t2=eu("[TracingHeaders]");let Cs=class Cs{constructor(t){V(this,"_restoreXHRPatch",void 0),V(this,"_restoreFetchPatch",void 0),V(this,"_startCapturing",()=>{var t,a,l,c;F(this._restoreXHRPatch)&&(null===(t=B.__PosthogExtensions__)||void 0===t||null===(a=t.tracingHeadersPatchFns)||void 0===a||a._patchXHR(this.instance.sessionManager)),F(this._restoreFetchPatch)&&(null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.tracingHeadersPatchFns)||void 0===c||c._patchFetch(this.instance.sessionManager))}),this.instance=t}_loadScript(t){var a,l,c;null!==(a=B.__PosthogExtensions__)&&void 0!==a&&a.tracingHeadersPatchFns&&t(),null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.loadExternalDependency)||void 0===c||c.call(l,this.instance,"tracing-headers",a=>{if(a)return t2.error("failed to load script",a);t()})}startIfEnabledOrStop(){var t,a;this.instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):(null===(t=this._restoreXHRPatch)||void 0===t||t.call(this),null===(a=this._restoreFetchPatch)||void 0===a||a.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}};var t3=eu("[Web Vitals]");let Ts=class Ts{constructor(t){var a;V(this,"_enabledServerSide",!1),V(this,"_initialized",!1),V(this,"buffer",{url:void 0,metrics:[],firstMetricTimestamp:void 0}),V(this,"_flushToCapture",()=>{clearTimeout(this._delayedFlushTimer),0!==this.buffer.metrics.length&&(this.instance.capture("$web_vitals",this.buffer.metrics.reduce((t,a)=>W(W({},t),{},{["$web_vitals_".concat(a.name,"_event")]:W({},a),["$web_vitals_".concat(a.name,"_value")]:a.value}),{})),this.buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})}),V(this,"_addToBuffer",t=>{var a,l=null===(a=this.instance.sessionManager)||void 0===a?void 0:a.checkAndGetSessionAndWindowId(!0);if(F(l))t3.error("Could not read session ID. Dropping metrics!");else{this.buffer=this.buffer||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this._currentURL();F(c)||(A(null==t?void 0:t.name)||A(null==t?void 0:t.value)?t3.error("Invalid metric received",t):this._maxAllowedValue&&t.value>=this._maxAllowedValue?t3.error("Ignoring metric with value >= "+this._maxAllowedValue,t):(this.buffer.url!==c&&(this._flushToCapture(),this._delayedFlushTimer=setTimeout(this._flushToCapture,this.flushToCaptureTimeoutMs)),F(this.buffer.url)&&(this.buffer.url=c),this.buffer.firstMetricTimestamp=F(this.buffer.firstMetricTimestamp)?Date.now():this.buffer.firstMetricTimestamp,t.attribution&&t.attribution.interactionTargetElement&&(t.attribution.interactionTargetElement=void 0),this.buffer.metrics.push(W(W({},t),{},{$current_url:c,$session_id:l.sessionId,$window_id:l.windowId,timestamp:Date.now()})),this.buffer.metrics.length===this.allowedMetrics.length&&this._flushToCapture()))}}),V(this,"_startCapturing",()=>{var t,a,l,c,d=B.__PosthogExtensions__;F(d)||F(d.postHogWebVitalsCallbacks)||({onLCP:t,onCLS:a,onFCP:l,onINP:c}=d.postHogWebVitalsCallbacks),t&&a&&l&&c?(this.allowedMetrics.indexOf("LCP")>-1&&t(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&a(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&l(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this._addToBuffer.bind(this)),this._initialized=!0):t3.error("web vitals callbacks not loaded - not starting")}),this.instance=t,this._enabledServerSide=!(null===(a=this.instance.persistence)||void 0===a||!a.props[ey]),this.startIfEnabled()}get allowedMetrics(){var t,a,l=P(this.instance.config.capture_performance)?null===(t=this.instance.config.capture_performance)||void 0===t?void 0:t.web_vitals_allowed_metrics:void 0;return F(l)?(null===(a=this.instance.persistence)||void 0===a?void 0:a.props[eS])||["CLS","FCP","INP","LCP"]:l}get flushToCaptureTimeoutMs(){return(P(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get _maxAllowedValue(){var t=P(this.instance.config.capture_performance)&&O(this.instance.config.capture_performance.__web_vitals_max_value)?this.instance.config.capture_performance.__web_vitals_max_value:9e5;return 0<t&&t<=6e4?9e5:t}get isEnabled(){var t=P(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals:void 0;return M(t)?t:this._enabledServerSide}startIfEnabled(){this.isEnabled&&!this._initialized&&(t3.info("enabled, starting..."),this.loadScript(this._startCapturing))}onRemoteConfig(t){var a=P(t.capturePerformance)&&!!t.capturePerformance.web_vitals,l=P(t.capturePerformance)?t.capturePerformance.web_vitals_allowed_metrics:void 0;this.instance.persistence&&(this.instance.persistence.register({[ey]:a}),this.instance.persistence.register({[eS]:l})),this._enabledServerSide=a,this.startIfEnabled()}loadScript(t){var a,l,c;null!==(a=B.__PosthogExtensions__)&&void 0!==a&&a.postHogWebVitalsCallbacks&&t(),null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.loadExternalDependency)||void 0===c||c.call(l,this.instance,"web-vitals",a=>{a?t3.error("failed to load script",a):t()})}_currentURL(){var t=d?d.location.href:void 0;return t||t3.error("Could not determine current URL"),t}};var t5=eu("[Heatmaps]");function As(t){return P(t)&&"clientX"in t&&"clientY"in t&&O(t.clientX)&&O(t.clientY)}let Os=class Os{constructor(t){var a;V(this,"rageclicks",new bt),V(this,"_enabledServerSide",!1),V(this,"_initialized",!1),V(this,"_flushInterval",null),this.instance=t,this._enabledServerSide=!(null===(a=this.instance.persistence)||void 0===a||!a.props[em])}get flushIntervalMilliseconds(){var t=5e3;return P(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(t=this.instance.config.capture_heatmaps.flush_interval_milliseconds),t}get isEnabled(){return F(this.instance.config.capture_heatmaps)?F(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:!1!==this.instance.config.capture_heatmaps}startIfEnabled(){if(this.isEnabled)this._initialized||(t5.info("starting..."),this._setupListeners(),this._flushInterval=setInterval(this.flush.bind(this),this.flushIntervalMilliseconds));else{var t,a;clearInterval(null!==(t=this._flushInterval)&&void 0!==t?t:void 0),null===(a=this.deadClicksCapture)||void 0===a||a.stop(),this.getAndClearBuffer()}}onRemoteConfig(t){var a=!!t.heatmaps;this.instance.persistence&&this.instance.persistence.register({[em]:a}),this._enabledServerSide=a,this.startIfEnabled()}getAndClearBuffer(){var t=this.buffer;return this.buffer=void 0,t}_onDeadClick(t){this._onClick(t.originalEvent,"deadclick")}_setupListeners(){d&&f&&(ae(d,"beforeunload",this.flush.bind(this)),ae(f,"click",t=>this._onClick(t||(null==d?void 0:d.event)),{capture:!0}),ae(f,"mousemove",t=>this._onMouseMove(t||(null==d?void 0:d.event)),{capture:!0}),this.deadClicksCapture=new ni(this.instance,si,this._onDeadClick.bind(this)),this.deadClicksCapture.startIfEnabled(),this._initialized=!0)}_getProperties(t,a){var l=this.instance.scrollManager.scrollY(),c=this.instance.scrollManager.scrollX(),h=this.instance.scrollManager.scrollElement(),_=function(t,a,l){for(var c=t;c&&Ge(c)&&!Je(c,"body")&&c!==l;){if(m(a,null==d?void 0:d.getComputedStyle(c).position))return!0;c=rt(c)}return!1}(it(t),["fixed","sticky"],h);return{x:t.clientX+(_?0:c),y:t.clientY+(_?0:l),target_fixed:_,type:a}}_onClick(t){var a,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";if(!Ve(t.target)&&As(t)){var c=this._getProperties(t,l);null!==(a=this.rageclicks)&&void 0!==a&&a.isRageClick(t.clientX,t.clientY,(new Date).getTime())&&this._capture(W(W({},c),{},{type:"rageclick"})),this._capture(c)}}_onMouseMove(t){!Ve(t.target)&&As(t)&&(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout(()=>{this._capture(this._getProperties(t,"mousemove"))},500))}_capture(t){if(d){var a=d.location.href;this.buffer=this.buffer||{},this.buffer[a]||(this.buffer[a]=[]),this.buffer[a].push(t)}}flush(){this.buffer&&!C(this.buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}};let Ms=class Ms{constructor(t){this._instance=t}doPageView(t,a){var l,c=this._previousPageViewProperties(t,a);return this._currentPageview={pathname:null!==(l=null==d?void 0:d.location.pathname)&&void 0!==l?l:"",pageViewId:a,timestamp:t},this._instance.scrollManager.resetContext(),c}doPageLeave(t){var a;return this._previousPageViewProperties(t,null===(a=this._currentPageview)||void 0===a?void 0:a.pageViewId)}doEvent(){var t;return{$pageview_id:null===(t=this._currentPageview)||void 0===t?void 0:t.pageViewId}}_previousPageViewProperties(t,a){var l=this._currentPageview;if(!l)return{$pageview_id:a};var c={$pageview_id:a,$prev_pageview_id:l.pageViewId},d=this._instance.scrollManager.getContext();if(d&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:h,lastScrollY:_,maxScrollY:p,maxContentHeight:g,lastContentY:v,maxContentY:f}=d;if(!(F(h)||F(_)||F(p)||F(g)||F(v)||F(f))){h=Math.ceil(h),_=Math.ceil(_),p=Math.ceil(p),g=Math.ceil(g),v=Math.ceil(v),f=Math.ceil(f);var w=h<=1?1:wi(_/h,0,1),S=h<=1?1:wi(p/h,0,1),k=g<=1?1:wi(v/g,0,1),E=g<=1?1:wi(f/g,0,1);c=X(c,{$prev_pageview_last_scroll:_,$prev_pageview_last_scroll_percentage:w,$prev_pageview_max_scroll:p,$prev_pageview_max_scroll_percentage:S,$prev_pageview_last_content:v,$prev_pageview_last_content_percentage:k,$prev_pageview_max_content:f,$prev_pageview_max_content_percentage:E})}}return l.pathname&&(c.$prev_pageview_pathname=l.pathname),l.timestamp&&(c.$prev_pageview_duration=(t.getTime()-l.timestamp.getTime())/1e3),c}};let Ls=class Ls{constructor(t){this.instance=t}sendExceptionEvent(t){this.instance.capture("$exception",t,{_noTruncate:!0,_batchKey:"exceptionEvent"})}};var t6,t4,t8=eu("[FeatureFlags]"),t7="$active_feature_flags",t9="$override_feature_flags",ii="$feature_flag_payloads",ir="$override_feature_flag_payloads",ia="$feature_flag_request_id",js=t=>{var a={};for(var[l,c]of Z(t||{}))c&&(a[l]=c);return a};(i4=t4||(t4={})).FeatureFlags="feature_flags",i4.Recordings="recordings";let Ws=class Ws{constructor(t){V(this,"_override_warning",!1),V(this,"_hasLoadedFlags",!1),V(this,"_requestInFlight",!1),V(this,"_reloadingDisabled",!1),V(this,"_additionalReloadRequested",!1),V(this,"_decideCalled",!1),V(this,"_flagsLoadedFromRemote",!1),this.instance=t,this.featureFlagEventHandlers=[]}decide(){if(this.instance.config.__preview_remote_config)this._decideCalled=!0;else{var t=!this._reloadDebouncer&&(this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load);this._callDecideEndpoint({disableFlags:t})}}get hasLoadedFlags(){return this._hasLoadedFlags}getFlags(){return Object.keys(this.getFlagVariants())}getFlagVariants(){var t=this.instance.get_property(eM),a=this.instance.get_property(t9);if(!a)return t||{};for(var l=X({},t),c=Object.keys(a),d=0;d<c.length;d++)l[c[d]]=a[c[d]];return this._override_warning||(t8.warn(" Overriding feature flags!",{enabledFlags:t,overriddenFlags:a,finalFlags:l}),this._override_warning=!0),l}getFlagPayloads(){var t=this.instance.get_property(ii),a=this.instance.get_property(ir);if(!a)return t||{};for(var l=X({},t||{}),c=Object.keys(a),d=0;d<c.length;d++)l[c[d]]=a[c[d]];return this._override_warning||(t8.warn(" Overriding feature flag payloads!",{flagPayloads:t,overriddenPayloads:a,finalPayloads:l}),this._override_warning=!0),l}reloadFeatureFlags(){this._reloadingDisabled||this.instance.config.advanced_disable_feature_flags||this._reloadDebouncer||(this._reloadDebouncer=setTimeout(()=>{this._callDecideEndpoint()},5))}clearDebouncer(){clearTimeout(this._reloadDebouncer),this._reloadDebouncer=void 0}ensureFlagsLoaded(){this._hasLoadedFlags||this._requestInFlight||this._reloadDebouncer||this.reloadFeatureFlags()}setAnonymousDistinctId(t){this.$anon_distinct_id=t}setReloadingPaused(t){this._reloadingDisabled=t}_callDecideEndpoint(t){var a;if(this.clearDebouncer(),!this.instance.config.advanced_disable_decide){if(this._requestInFlight)this._additionalReloadRequested=!0;else{var l={token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:W(W({},(null===(a=this.instance.persistence)||void 0===a?void 0:a.get_initial_props())||{}),this.instance.get_property(eD)||{}),group_properties:this.instance.get_property(eW)};(null!=t&&t.disableFlags||this.instance.config.advanced_disable_feature_flags)&&(l.disable_flags=!0),this._requestInFlight=!0,this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:l,compression:this.instance.config.disable_compression?void 0:c.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:t=>{var a,c,d,h=!0;200===t.statusCode&&(this._additionalReloadRequested||(this.$anon_distinct_id=void 0),h=!1),this._requestInFlight=!1,this._decideCalled||(this._decideCalled=!0,this.instance._onRemoteConfig(null!==(d=t.json)&&void 0!==d?d:{})),l.disable_flags&&!this._additionalReloadRequested||(this._flagsLoadedFromRemote=!h,t.json&&null!==(a=t.json.quotaLimited)&&void 0!==a&&a.includes(t4.FeatureFlags)?t8.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more."):(this.receivedFeatureFlags(null!==(c=t.json)&&void 0!==c?c:{},h),this._additionalReloadRequested&&(this._additionalReloadRequested=!1,this._callDecideEndpoint())))}})}}}getFeatureFlag(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0){var l,c,d,h,_,p=this.getFlagVariants()[t],g="".concat(p),v=this.instance.get_property(ia)||void 0,f=this.instance.get_property(eB)||{};return!a.send_event&&"send_event"in a||t in f&&f[t].includes(g)||(el(f[t])?f[t].push(g):f[t]=[g],null===(l=this.instance.persistence)||void 0===l||l.register({[eB]:f}),this.instance.capture("$feature_flag_called",{$feature_flag:t,$feature_flag_response:p,$feature_flag_payload:this.getFeatureFlagPayload(t)||null,$feature_flag_request_id:v,$feature_flag_bootstrapped_response:(null===(c=this.instance.config.bootstrap)||void 0===c||null===(d=c.featureFlags)||void 0===d?void 0:d[t])||null,$feature_flag_bootstrapped_payload:(null===(h=this.instance.config.bootstrap)||void 0===h||null===(_=h.featureFlagPayloads)||void 0===_?void 0:_[t])||null,$used_bootstrap_value:!this._flagsLoadedFromRemote})),p}t8.warn('getFeatureFlag for key "'+t+"\" failed. Feature flags didn't load in time.")}getFeatureFlagPayload(t){return this.getFlagPayloads()[t]}getRemoteConfigPayload(t,a){var l=this.instance.config.token;this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:{distinct_id:this.instance.get_distinct_id(),token:l},compression:this.instance.config.disable_compression?void 0:c.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:l=>{var c,d=null===(c=l.json)||void 0===c?void 0:c.featureFlagPayloads;a((null==d?void 0:d[t])||void 0)}})}isFeatureEnabled(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(t,a);t8.warn('isFeatureEnabled for key "'+t+"\" failed. Feature flags didn't load in time.")}addFeatureFlagsHandler(t){this.featureFlagEventHandlers.push(t)}removeFeatureFlagsHandler(t){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(a=>a!==t)}receivedFeatureFlags(t,a){if(this.instance.persistence){this._hasLoadedFlags=!0;var l=this.getFlagVariants(),c=this.getFlagPayloads();!function(t,a){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=t.featureFlags,h=t.featureFlagPayloads,_=t.requestId;if(d){if(el(d)){var p={};if(d)for(var g=0;g<d.length;g++)p[d[g]]=!0;a&&a.register({[t7]:d,[eM]:p})}else{var v=d,f=h;t.errorsWhileComputingFlags&&(v=W(W({},l),v),f=W(W({},c),f)),a&&a.register(W({[t7]:Object.keys(js(v)),[eM]:v||{},[ii]:f||{}},_?{[ia]:_}:{}))}}}(t,this.instance.persistence,l,c),this._fireFeatureFlagsCallbacks(a)}}override(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t8.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:t,suppressWarning:a})}overrideFeatureFlags(t){if(!this.instance.__loaded||!this.instance.persistence)return t8.uninitializedWarning("posthog.feature_flags.overrideFeatureFlags");if(!1===t)return this.instance.persistence.unregister(t9),this.instance.persistence.unregister(ir),void this._fireFeatureFlagsCallbacks();if(t&&"object"==typeof t&&("flags"in t||"payloads"in t)){var a;if(this._override_warning=!!(null!==(a=t.suppressWarning)&&void 0!==a&&a),"flags"in t){if(!1===t.flags)this.instance.persistence.unregister(t9);else if(t.flags){if(el(t.flags)){for(var l={},c=0;c<t.flags.length;c++)l[t.flags[c]]=!0;this.instance.persistence.register({[t9]:l})}else this.instance.persistence.register({[t9]:t.flags})}}return"payloads"in t&&(!1===t.payloads?this.instance.persistence.unregister(ir):t.payloads&&this.instance.persistence.register({[ir]:t.payloads})),void this._fireFeatureFlagsCallbacks()}this._fireFeatureFlagsCallbacks()}onFeatureFlags(t){if(this.addFeatureFlagsHandler(t),this._hasLoadedFlags){var{flags:a,flagVariants:l}=this._prepareFeatureFlagsForCallbacks();t(a,l)}return()=>this.removeFeatureFlagsHandler(t)}updateEarlyAccessFeatureEnrollment(t,a){var l,c=(this.instance.get_property(eL)||[]).find(a=>a.flagKey===t),d={["$feature_enrollment/".concat(t)]:a},h={$feature_flag:t,$feature_enrollment:a,$set:d};c&&(h.$early_access_feature_name=c.name),this.instance.capture("$feature_enrollment_update",h),this.setPersonPropertiesForFlags(d,!1);var _=W(W({},this.getFlagVariants()),{},{[t]:a});null===(l=this.instance.persistence)||void 0===l||l.register({[t7]:Object.keys(js(_)),[eM]:_}),this._fireFeatureFlagsCallbacks()}getEarlyAccessFeatures(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,c=this.instance.get_property(eL),d=l?"&".concat(l.map(t=>"stage=".concat(t)).join("&")):"";if(c&&!a)return t(c);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token).concat(d)),method:"GET",callback:a=>{var l;if(a.json){var c=a.json.earlyAccessFeatures;return null===(l=this.instance.persistence)||void 0===l||l.register({[eL]:c}),t(c)}}})}_prepareFeatureFlagsForCallbacks(){var t=this.getFlags(),a=this.getFlagVariants();return{flags:t.filter(t=>a[t]),flagVariants:Object.keys(a).filter(t=>a[t]).reduce((t,l)=>(t[l]=a[l],t),{})}}_fireFeatureFlagsCallbacks(t){var{flags:a,flagVariants:l}=this._prepareFeatureFlagsForCallbacks();this.featureFlagEventHandlers.forEach(c=>c(a,l,{errorsLoading:t}))}setPersonPropertiesForFlags(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l=this.instance.get_property(eD)||{};this.instance.register({[eD]:W(W({},l),t)}),a&&this.instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this.instance.unregister(eD)}setGroupPropertiesForFlags(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l=this.instance.get_property(eW)||{};0!==Object.keys(l).length&&Object.keys(l).forEach(a=>{l[a]=W(W({},l[a]),t[a]),delete t[a]}),this.instance.register({[eW]:W(W({},l),t)}),a&&this.instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(t){if(t){var a=this.instance.get_property(eW)||{};this.instance.register({[eW]:W(W({},a),{},{[t]:{}})})}else this.instance.unregister(eW)}};var il="Mobile",ic="Android",iu="Tablet",id=ic+" "+iu,ih="iPad",i_="Apple",ip=i_+" Watch",ig="Safari",iv="BlackBerry",im="Samsung",ib=im+"Browser",iy=im+" Internet",iw="Chrome",iS=iw+" OS",ik=iw+" iOS",iE="Internet Explorer",ix=iE+" "+il,iF="Opera",iI=iF+" Mini",iP="Edge",iC="Microsoft "+iP,iR="Firefox",iT=iR+" iOS",i$="Nintendo",iA="PlayStation",iO="Xbox",iM=ic+" "+il,iL=il+" "+ig,iD="Windows",iW=iD+" Phone",iq="Nokia",iN="Ouya",iB="Generic",iV=iB+" "+il.toLowerCase(),iH=iB+" "+iu.toLowerCase(),iU="Konqueror",iz="(\\d+(\\.\\d+)?)",ij=RegExp("Version/"+iz),iG=RegExp(iO,"i"),iK=RegExp(iA+" \\w+","i"),iX=RegExp(i$+" \\w+","i"),iY=RegExp(iv+"|PlayBook|BB10","i"),iJ={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Lr=(t,a)=>a&&m(a,i_)||m(t,ig)&&!m(t,iw)&&!m(t,ic),Dr=function(t,a){return a=a||"",m(t," OPR/")&&m(t,"Mini")?iI:m(t," OPR/")?iF:iY.test(t)?iv:m(t,"IE"+il)||m(t,"WPDesktop")?ix:m(t,ib)?iy:m(t,iP)||m(t,"Edg/")?iC:m(t,"FBIOS")?"Facebook "+il:m(t,"UCWEB")||m(t,"UCBrowser")?"UC Browser":m(t,"CriOS")?ik:m(t,"CrMo")||m(t,iw)?iw:m(t,ic)&&m(t,ig)?iM:m(t,"FxiOS")?iT:m(t.toLowerCase(),iU.toLowerCase())?iU:Lr(t,a)?m(t,il)?iL:ig:m(t,iR)?iR:m(t,"MSIE")||m(t,"Trident/")?iE:m(t,"Gecko")?iR:""},iQ={[ix]:[RegExp("rv:"+iz)],[iC]:[RegExp(iP+"?\\/"+iz)],[iw]:[RegExp("("+iw+"|CrMo)\\/"+iz)],[ik]:[RegExp("CriOS\\/"+iz)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+iz)],[ig]:[ij],[iL]:[ij],[iF]:[RegExp("(Opera|OPR)\\/"+iz)],[iR]:[RegExp(iR+"\\/"+iz)],[iT]:[RegExp("FxiOS\\/"+iz)],[iU]:[RegExp("Konqueror[:/]?"+iz,"i")],[iv]:[RegExp(iv+" "+iz),ij],[iM]:[RegExp("android\\s"+iz,"i")],[iy]:[RegExp(ib+"\\/"+iz)],[iE]:[RegExp("(rv:|MSIE )"+iz)],Mozilla:[RegExp("rv:"+iz)]},iZ=[[RegExp(iO+"; "+iO+" (.*?)[);]","i"),t=>[iO,t&&t[1]||""]],[RegExp(i$,"i"),[i$,""]],[RegExp(iA,"i"),[iA,""]],[iY,[iv,""]],[RegExp(iD,"i"),(t,a)=>{if(/Phone/.test(a)||/WPDesktop/.test(a))return[iW,""];if(new RegExp(il).test(a)&&!/IEMobile\b/.test(a))return[iD+" "+il,""];var l=/Windows NT ([0-9.]+)/i.exec(a);if(l&&l[1]){var c=iJ[l[1]]||"";return/arm/i.test(a)&&(c="RT"),[iD,c]}return[iD,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>t&&t[3]?["iOS",[t[3],t[4],t[5]||"0"].join(".")]:["iOS",""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var a="";return t&&t.length>=3&&(a=F(t[2])?t[3]:t[2]),["watchOS",a]}],[RegExp("("+ic+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+ic+")","i"),t=>t&&t[2]?[ic,[t[2],t[3],t[4]||"0"].join(".")]:[ic,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var a=["Mac OS X",""];if(t&&t[1]){var l=[t[1],t[2],t[3]||"0"];a[1]=l.join(".")}return a}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[iS,""]],[/Linux|debian/i,["Linux",""]]],Br=function(t){return iX.test(t)?i$:iK.test(t)?iA:iG.test(t)?iO:RegExp(iN,"i").test(t)?iN:RegExp("("+iW+"|WPDesktop)","i").test(t)?iW:/iPad/.test(t)?ih:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?ip:iY.test(t)?iv:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":RegExp(iq,"i").test(t)?iq:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!new RegExp(il).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?ic:id:ic:RegExp("(pda|"+il+")","i").test(t)?iV:RegExp(iu,"i").test(t)&&!RegExp(iu+" pc","i").test(t)?iH:""},i0="https?://(.*)",i1=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","irclid","_kx"],i2=Q(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],i1),i3="<masked>",i5={campaignParams:function(){var{customTrackedParams:t,maskPersonalDataProperties:a,customPersonalDataProperties:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!f)return{};var c=a?Q([],i1,l||[]):[];return this._campaignParamsFromUrl(xt(f.URL,c,i3),t)},_campaignParamsFromUrl:function(t,a){var l=i2.concat(a||[]),c={};return K(l,function(a){var l=Et(t,a);c[a]=l||null}),c},_searchEngine:function(t){return t?0===t.search(i0+"google.([^/?]*)")?"google":0===t.search(i0+"bing.com")?"bing":0===t.search(i0+"yahoo.com")?"yahoo":0===t.search(i0+"duckduckgo.com")?"duckduckgo":null:null},_searchInfoFromReferrer:function(t){var a=i5._searchEngine(t),l="yahoo"!=a?"q":"p",c={};if(!$(a)){c.$search_engine=a;var d=f?Et(f.referrer,l):"";d.length&&(c.ph_keyword=d)}return c},searchInfo:function(){var t=null==f?void 0:f.referrer;return t?this._searchInfoFromReferrer(t):{}},browser:Dr,browserVersion:function(t,a){var l=iQ[Dr(t,a)];if(F(l))return null;for(var c=0;c<l.length;c++){var d=l[c],h=t.match(d);if(h)return parseFloat(h[h.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},browserLanguagePrefix:function(){var t=this.browserLanguage();return"string"==typeof t?t.split("-")[0]:void 0},os:function(t){for(var a=0;a<iZ.length;a++){var[l,c]=iZ[a],d=l.exec(t),h=d&&(I(c)?c(d,t):c);if(h)return h}return["",""]},device:Br,deviceType:function(t){var a=Br(t);return a===ih||a===id||"Kobo"===a||"Kindle Fire"===a||a===iH?iu:a===i$||a===iO||a===iA||a===iN?"Console":a===ip?"Wearable":a?il:"Desktop"},referrer:function(){return(null==f?void 0:f.referrer)||"$direct"},referringDomain:function(){var t;return null!=f&&f.referrer&&(null===(t=St(f.referrer))||void 0===t?void 0:t.host)||"$direct"},referrerInfo:function(){return{$referrer:this.referrer(),$referring_domain:this.referringDomain()}},personInfo:function(){var{maskPersonalDataProperties:t,customPersonalDataProperties:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=t?Q([],i1,a||[]):[],c=null==w?void 0:w.href.substring(0,1e3);return{r:this.referrer().substring(0,1e3),u:c?xt(c,l,i3):void 0}},personPropsFromInfo:function(t){var a,{r:l,u:c}=t,d={$referrer:l,$referring_domain:null==l?void 0:"$direct"==l?"$direct":null===(a=St(l))||void 0===a?void 0:a.host};if(c){d.$current_url=c;var h=St(c);d.$host=null==h?void 0:h.host,d.$pathname=null==h?void 0:h.pathname,X(d,this._campaignParamsFromUrl(c))}return l&&X(d,this._searchInfoFromReferrer(l)),d},initialPersonPropsFromInfo:function(t){var a=this.personPropsFromInfo(t),l={};return K(a,function(t,a){l["$initial_".concat(b(a))]=t}),l},timezone:function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){return}},timezoneOffset:function(){try{return(new Date).getTimezoneOffset()}catch(t){return}},properties:function(){var{maskPersonalDataProperties:t,customPersonalDataProperties:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!x)return{};var l=t?Q([],i1,a||[]):[],[c,h]=i5.os(x);return X(ie({$os:c,$os_version:h,$browser:i5.browser(x,navigator.vendor),$device:i5.device(x),$device_type:i5.deviceType(x),$timezone:i5.timezone(),$timezone_offset:i5.timezoneOffset()}),{$current_url:xt(null==w?void 0:w.href,l,i3),$host:null==w?void 0:w.host,$pathname:null==w?void 0:w.pathname,$raw_user_agent:x.length>1e3?x.substring(0,997)+"...":x,$browser_version:i5.browserVersion(x,navigator.vendor),$browser_language:i5.browserLanguage(),$browser_language_prefix:i5.browserLanguagePrefix(),$screen_height:null==d?void 0:d.screen.height,$screen_width:null==d?void 0:d.screen.width,$viewport_height:null==d?void 0:d.innerHeight,$viewport_width:null==d?void 0:d.innerWidth,$lib:"web",$lib_version:H.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})},people_properties:function(){if(!x)return{};var[t,a]=i5.os(x);return X(ie({$os:t,$os_version:a,$browser:i5.browser(x,navigator.vendor)}),{$browser_version:i5.browserVersion(x,navigator.vendor)})}},i6=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];let Gr=class Gr{constructor(t){var a;this.config=t,this.props={},this.campaign_params_saved=!1,this.name=(a="",t.token&&(a=t.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),t.persistence_name?"ph_"+t.persistence_name:"ph_"+a+"_posthog"),this.storage=this.buildStorage(t),this.load(),t.debug&&ec.info("Persistence loaded",t.persistence,W({},this.props)),this.update_config(t,t),this.save()}buildStorage(t){-1===i6.indexOf(t.persistence.toLowerCase())&&(ec.critical("Unknown persistence type "+t.persistence+"; falling back to localStorage+cookie"),t.persistence="localStorage+cookie");var a=t.persistence.toLowerCase();return"localstorage"===a&&tl.is_supported()?tl:"localstorage+cookie"===a&&tu.is_supported()?tu:"sessionstorage"===a&&tp.is_supported()?tp:"memory"===a?th:"cookie"===a?to:tu.is_supported()?tu:to}properties(){var t={};return K(this.props,function(a,l){if(l===eM&&P(a))for(var c,d=Object.keys(a),h=0;h<d.length;h++)t["$feature/".concat(d[h])]=a[d[h]];else c=!1,($(eJ)?c:g&&eJ.indexOf===g?-1!=eJ.indexOf(l):(K(eJ,function(t){if(c||(c=t===l))return eh}),c))||(t[l]=a)}),t}load(){if(!this.disabled){var t=this.storage.parse(this.name);t&&(this.props=X({},t))}}save(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure,this.config.debug)}remove(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}clear(){this.remove(),this.props={}}register_once(t,a,l){if(P(t)){F(a)&&(a="None"),this.expire_days=F(l)?this.default_expiry:l;var c=!1;if(K(t,(t,l)=>{this.props.hasOwnProperty(l)&&this.props[l]!==a||(this.props[l]=t,c=!0)}),c)return this.save(),!0}return!1}register(t,a){if(P(t)){this.expire_days=F(a)?this.default_expiry:a;var l=!1;if(K(t,(a,c)=>{t.hasOwnProperty(c)&&this.props[c]!==a&&(this.props[c]=a,l=!0)}),l)return this.save(),!0}return!1}unregister(t){t in this.props&&(delete this.props[t],this.save())}update_campaign_params(){if(!this.campaign_params_saved){var t=i5.campaignParams({customTrackedParams:this.config.custom_campaign_params,maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties});C(ie(t))||this.register(t),this.campaign_params_saved=!0}}update_search_keyword(){this.register(i5.searchInfo())}update_referrer_info(){this.register_once(i5.referrerInfo(),void 0)}set_initial_person_info(){this.props[ez]||this.props[ej]||this.register_once({[eG]:i5.personInfo({maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties})},void 0)}get_referrer_info(){return ie({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}get_initial_props(){var t={};K([ej,ez],a=>{var l=this.props[a];l&&K(l,function(a,l){t["$initial_"+b(l)]=a})});var a=this.props[eG];return a&&X(t,i5.initialPersonPropsFromInfo(a)),t}safe_merge(t){return K(this.props,function(a,l){l in t||(t[l]=a)}),t}update_config(t,a){if(this.default_expiry=this.expire_days=t.cookie_expiration,this.set_disabled(t.disable_persistence),this.set_cross_subdomain(t.cross_subdomain_cookie),this.set_secure(t.secure_cookie),t.persistence!==a.persistence){var l=this.buildStorage(t),c=this.props;this.clear(),this.storage=l,this.props=c,this.save()}}set_disabled(t){this.disabled=t,this.disabled?this.remove():this.save()}set_cross_subdomain(t){t!==this.cross_subdomain&&(this.cross_subdomain=t,this.remove(),this.save())}get_cross_subdomain(){return!!this.cross_subdomain}set_secure(t){t!==this.secure&&(this.secure=t,this.remove(),this.save())}set_event_timer(t,a){var l=this.props[ev]||{};l[t]=a,this.props[ev]=l,this.save()}remove_event_timer(t){var a=(this.props[ev]||{})[t];return F(a)||(delete this.props[ev][t],this.save()),a}get_property(t){return this.props[t]}set_property(t,a){this.props[t]=a,this.save()}};var i4,i8,i7,i9,se,st,sr,sn,sa,sl,sc,su,sd,sh={},s_=[],sp=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,sg=Array.isArray;function dn(t,a){for(var l in a)t[l]=a[l];return t}function hn(t){var a=t.parentNode;a&&a.removeChild(t)}function _n(t,a,l,c,d){var h={type:t,props:a,key:l,ref:c,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==d?++i9:d,__i:-1,__u:0};return null==d&&null!=i7.vnode&&i7.vnode(h),h}function pn(t){return t.children}function gn(t,a){this.props=t,this.context=a}function vn(t,a){if(null==a)return t.__?vn(t.__,t.__i+1):null;for(var l;a<t.__k.length;a++)if(null!=(l=t.__k[a])&&null!=l.__e)return l.__e;return"function"==typeof t.type?vn(t):null}function mn(t){(!t.__d&&(t.__d=!0)&&se.push(t)&&!yn.__r++||st!==i7.debounceRendering)&&((st=i7.debounceRendering)||sr)(yn)}function yn(){var t,a,l,c,d,h,_,p,g;for(se.sort(sn);t=se.shift();)t.__d&&(a=se.length,c=void 0,h=(d=(l=t).__v).__e,p=[],g=[],(_=l.__P)&&((c=dn({},d)).__v=d.__v+1,i7.vnode&&i7.vnode(c),Cn(_,c,d,l.__n,void 0!==_.ownerSVGElement,32&d.__u?[h]:null,p,null==h?vn(d):h,!!(32&d.__u),g),c.__.__k[c.__i]=c,function(t,a,l){a.__d=void 0;for(var c=0;c<l.length;c++)Tn(l[c],l[++c],l[++c]);i7.__c&&i7.__c(a,t),t.some(function(a){try{t=a.__h,a.__h=[],t.some(function(t){t.call(a)})}catch(t){i7.__e(t,a.__v)}})}(p,c,g),c.__e!=h&&function fn(t){var a,l;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,a=0;a<t.__k.length;a++)if(null!=(l=t.__k[a])&&null!=l.__e){t.__e=t.__c.base=l.__e;break}return fn(t)}}(c)),se.length>a&&se.sort(sn));yn.__r=0}function bn(t,a,l,c,d,h,_,p,g,v,f){var w,S,k,E,x,B=c&&c.__k||s_,H=a.length;for(l.__d=g,function(t,a,l){var c,d,h,_,p,g=a.length,v=l.length,f=v,w=0;for(t.__k=[],c=0;c<g;c++)null!=(d=t.__k[c]=null==(d=a[c])||"boolean"==typeof d||"function"==typeof d?null:"string"==typeof d||"number"==typeof d||"bigint"==typeof d||d.constructor==String?_n(null,d,null,null,d):sg(d)?_n(pn,{children:d},null,null,null):void 0===d.constructor&&d.__b>0?_n(d.type,d.props,d.key,d.ref?d.ref:null,d.__v):d)?(d.__=t,d.__b=t.__b+1,p=function(t,a,l,c){var d=t.key,h=t.type,_=l-1,p=l+1,g=a[l];if(null===g||g&&d==g.key&&h===g.type)return l;if(c>(null!=g&&0==(131072&g.__u)?1:0))for(;_>=0||p<a.length;){if(_>=0){if((g=a[_])&&0==(131072&g.__u)&&d==g.key&&h===g.type)return _;_--}if(p<a.length){if((g=a[p])&&0==(131072&g.__u)&&d==g.key&&h===g.type)return p;p++}}return -1}(d,l,_=c+w,f),d.__i=p,h=null,-1!==p&&(f--,(h=l[p])&&(h.__u|=131072)),null==h||null===h.__v?(-1==p&&w--,"function"!=typeof d.type&&(d.__u|=65536)):p!==_&&(p===_+1?w++:p>_?f>g-_?w+=p-_:w--:w=p<_&&p==_-1?p-_:0,p!==c+w&&(d.__u|=65536))):(h=l[c])&&null==h.key&&h.__e&&(h.__e==t.__d&&(t.__d=vn(h)),$n(h,h,!1),l[c]=null,f--);if(f)for(c=0;c<v;c++)null!=(h=l[c])&&0==(131072&h.__u)&&(h.__e==t.__d&&(t.__d=vn(h)),$n(h,h))}(l,a,B),g=l.__d,w=0;w<H;w++)null!=(k=l.__k[w])&&"boolean"!=typeof k&&"function"!=typeof k&&(S=-1===k.__i?sh:B[k.__i]||sh,k.__i=w,Cn(t,k,S,d,h,_,p,g,v,f),E=k.__e,k.ref&&S.ref!=k.ref&&(S.ref&&Tn(S.ref,null,k),f.push(k.ref,k.__c||E,k)),null==x&&null!=E&&(x=E),65536&k.__u||S.__k===k.__k?g=function Sn(t,a,l){var c,d;if("function"==typeof t.type){for(c=t.__k,d=0;c&&d<c.length;d++)c[d]&&(c[d].__=t,a=Sn(c[d],a,l));return a}return t.__e!=a&&(l.insertBefore(t.__e,a||null),a=t.__e),a&&a.nextSibling}(k,g,t):"function"==typeof k.type&&void 0!==k.__d?g=k.__d:E&&(g=E.nextSibling),k.__d=void 0,k.__u&=-196609);l.__d=g,l.__e=x}function En(t,a,l){"-"===a[0]?t.setProperty(a,null==l?"":l):t[a]=null==l?"":"number"!=typeof l||sp.test(a)?l:l+"px"}function xn(t,a,l,c,d){var h;e:if("style"===a){if("string"==typeof l)t.style.cssText=l;else{if("string"==typeof c&&(t.style.cssText=c=""),c)for(a in c)l&&a in l||En(t.style,a,"");if(l)for(a in l)c&&l[a]===c[a]||En(t.style,a,l[a])}}else if("o"===a[0]&&"n"===a[1])h=a!==(a=a.replace(/(PointerCapture)$|Capture$/,"$1")),a=a.toLowerCase() in t?a.toLowerCase().slice(2):a.slice(2),t.l||(t.l={}),t.l[a+h]=l,l?c?l.u=c.u:(l.u=Date.now(),t.addEventListener(a,h?Pn:In,h)):t.removeEventListener(a,h?Pn:In,h);else{if(d)a=a.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==a&&"height"!==a&&"href"!==a&&"list"!==a&&"form"!==a&&"tabIndex"!==a&&"download"!==a&&"rowSpan"!==a&&"colSpan"!==a&&"role"!==a&&a in t)try{t[a]=null==l?"":l;break e}catch(t){}"function"==typeof l||(null==l||!1===l&&"-"!==a[4]?t.removeAttribute(a):t.setAttribute(a,l))}}function In(t){var a=this.l[t.type+!1];if(t.t){if(t.t<=a.u)return}else t.t=Date.now();return a(i7.event?i7.event(t):t)}function Pn(t){return this.l[t.type+!0](i7.event?i7.event(t):t)}function Cn(t,a,l,c,d,h,_,p,g,v){var f,w,S,k,E,x,B,H,U,J,ei,er,en,ea,el,ec=a.type;if(void 0!==a.constructor)return null;128&l.__u&&(g=!!(32&l.__u),h=[p=a.__e=l.__e]),(f=i7.__b)&&f(a);e:if("function"==typeof ec)try{if(H=a.props,U=(f=ec.contextType)&&c[f.__c],J=f?U?U.props.value:f.__:c,l.__c?B=(w=a.__c=l.__c).__=w.__E:("prototype"in ec&&ec.prototype.render?a.__c=w=new ec(H,J):(a.__c=w=new gn(H,J),w.constructor=ec,w.render=An),U&&U.sub(w),w.props=H,w.state||(w.state={}),w.context=J,w.__n=c,S=w.__d=!0,w.__h=[],w._sb=[]),null==w.__s&&(w.__s=w.state),null!=ec.getDerivedStateFromProps&&(w.__s==w.state&&(w.__s=dn({},w.__s)),dn(w.__s,ec.getDerivedStateFromProps(H,w.__s))),k=w.props,E=w.state,w.__v=a,S)null==ec.getDerivedStateFromProps&&null!=w.componentWillMount&&w.componentWillMount(),null!=w.componentDidMount&&w.__h.push(w.componentDidMount);else{if(null==ec.getDerivedStateFromProps&&H!==k&&null!=w.componentWillReceiveProps&&w.componentWillReceiveProps(H,J),!w.__e&&(null!=w.shouldComponentUpdate&&!1===w.shouldComponentUpdate(H,w.__s,J)||a.__v===l.__v)){for(a.__v!==l.__v&&(w.props=H,w.state=w.__s,w.__d=!1),a.__e=l.__e,a.__k=l.__k,a.__k.forEach(function(t){t&&(t.__=a)}),ei=0;ei<w._sb.length;ei++)w.__h.push(w._sb[ei]);w._sb=[],w.__h.length&&_.push(w);break e}null!=w.componentWillUpdate&&w.componentWillUpdate(H,w.__s,J),null!=w.componentDidUpdate&&w.__h.push(function(){w.componentDidUpdate(k,E,x)})}if(w.context=J,w.props=H,w.__P=t,w.__e=!1,er=i7.__r,en=0,"prototype"in ec&&ec.prototype.render){for(w.state=w.__s,w.__d=!1,er&&er(a),f=w.render(w.props,w.state,w.context),ea=0;ea<w._sb.length;ea++)w.__h.push(w._sb[ea]);w._sb=[]}else do w.__d=!1,er&&er(a),f=w.render(w.props,w.state,w.context),w.state=w.__s;while(w.__d&&++en<25);w.state=w.__s,null!=w.getChildContext&&(c=dn(dn({},c),w.getChildContext())),S||null==w.getSnapshotBeforeUpdate||(x=w.getSnapshotBeforeUpdate(k,E)),bn(t,sg(el=null!=f&&f.type===pn&&null==f.key?f.props.children:f)?el:[el],a,l,c,d,h,_,p,g,v),w.base=a.__e,a.__u&=-161,w.__h.length&&_.push(w),B&&(w.__E=w.__=null)}catch(t){a.__v=null,g||null!=h?(a.__e=p,a.__u|=g?160:32,h[h.indexOf(p)]=null):(a.__e=l.__e,a.__k=l.__k),i7.__e(t,a,l)}else null==h&&a.__v===l.__v?(a.__k=l.__k,a.__e=l.__e):a.__e=function(t,a,l,c,d,h,_,p,g){var v,f,w,S,k,E,x,B=l.props,H=a.props,U=a.type;if("svg"===U&&(d=!0),null!=h){for(v=0;v<h.length;v++)if((k=h[v])&&"setAttribute"in k==!!U&&(U?k.localName===U:3===k.nodeType)){t=k,h[v]=null;break}}if(null==t){if(null===U)return document.createTextNode(H);t=d?document.createElementNS("http://www.w3.org/2000/svg",U):document.createElement(U,H.is&&H),h=null,p=!1}if(null===U)B===H||p&&t.data===H||(t.data=H);else{if(h=h&&i8.call(t.childNodes),B=l.props||sh,!p&&null!=h)for(B={},v=0;v<t.attributes.length;v++)B[(k=t.attributes[v]).name]=k.value;for(v in B)k=B[v],"children"==v||("dangerouslySetInnerHTML"==v?w=k:"key"===v||v in H||xn(t,v,null,k,d));for(v in H)k=H[v],"children"==v?S=k:"dangerouslySetInnerHTML"==v?f=k:"value"==v?E=k:"checked"==v?x=k:"key"===v||p&&"function"!=typeof k||B[v]===k||xn(t,v,k,B[v],d);if(f)p||w&&(f.__html===w.__html||f.__html===t.innerHTML)||(t.innerHTML=f.__html),a.__k=[];else if(w&&(t.innerHTML=""),bn(t,sg(S)?S:[S],a,l,c,d&&"foreignObject"!==U,h,_,h?h[0]:l.__k&&vn(l,0),p,g),null!=h)for(v=h.length;v--;)null!=h[v]&&hn(h[v]);p||(v="value",void 0===E||E===t[v]&&("progress"!==U||E)&&("option"!==U||E===B[v])||xn(t,v,E,B[v],!1),v="checked",void 0!==x&&x!==t[v]&&xn(t,v,x,B[v],!1))}return t}(l.__e,a,l,c,d,h,_,g,v);(f=i7.diffed)&&f(a)}function Tn(t,a,l){try{"function"==typeof t?t(a):t.current=a}catch(t){i7.__e(t,l)}}function $n(t,a,l){var c,d;if(i7.unmount&&i7.unmount(t),(c=t.ref)&&(c.current&&c.current!==t.__e||Tn(c,null,a)),null!=(c=t.__c)){if(c.componentWillUnmount)try{c.componentWillUnmount()}catch(t){i7.__e(t,a)}c.base=c.__P=null,t.__c=void 0}if(c=t.__k)for(d=0;d<c.length;d++)c[d]&&$n(c[d],a,l||"function"!=typeof t.type);l||null==t.__e||hn(t.__e),t.__=t.__e=t.__d=void 0}function An(t,a,l){return this.constructor(t,l)}i8=s_.slice,i7={__e:function(t,a,l,c){for(var d,h,_;a=a.__;)if((d=a.__c)&&!d.__)try{if((h=d.constructor)&&null!=h.getDerivedStateFromError&&(d.setState(h.getDerivedStateFromError(t)),_=d.__d),null!=d.componentDidCatch&&(d.componentDidCatch(t,c||{}),_=d.__d),_)return d.__E=d}catch(a){t=a}throw t}},i9=0,gn.prototype.setState=function(t,a){var l;l=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=dn({},this.state),"function"==typeof t&&(t=t(dn({},l),this.props)),t&&dn(l,t),null!=t&&this.__v&&(a&&this._sb.push(a),mn(this))},gn.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),mn(this))},gn.prototype.render=pn,se=[],sr="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,sn=function(t,a){return t.__v.__b-a.__v.__b},yn.__r=0,sa=0,(sI=sl||(sl={})).Popover="popover",sI.API="api",sI.Widget="widget",(sP=sc||(sc={})).Open="open",sP.MultipleChoice="multiple_choice",sP.SingleChoice="single_choice",sP.Rating="rating",sP.Link="link",(sC=su||(su={})).NextQuestion="next_question",sC.End="end",sC.ResponseBased="response_based",sC.SpecificQuestion="specific_question",(sR=sd||(sd={})).Once="once",sR.Recurring="recurring",sR.Always="always",(s$={__c:sT="__cC"+sa++,__:{isPreviewMode:!1,previewPageIndex:0,onPopupSurveyDismissed:()=>{},isPopup:!0,onPreviewSubmit:()=>{},onPopupSurveySent:()=>{}},Consumer:function(t,a){return t.children(a)},Provider:function(t){var a,l;return this.getChildContext||(a=[],(l={})[sT]=this,this.getChildContext=function(){return l},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&a.some(function(t){t.__e=!0,mn(t)})},this.sub=function(t){a.push(t);var l=t.componentWillUnmount;t.componentWillUnmount=function(){a.splice(a.indexOf(t),1),l&&l.call(t)}}),t.children}}).Provider.__=s$.Consumer.contextType=s$;var On=function(t,a){if(!function(t){try{new RegExp(t)}catch(t){return!1}return!0}(a))return!1;try{return new RegExp(a).test(t)}catch(t){return!1}};let Mn=class Mn{constructor(){V(this,"events",{}),this.events={}}on(t,a){return this.events[t]||(this.events[t]=[]),this.events[t].push(a),()=>{this.events[t]=this.events[t].filter(t=>t!==a)}}emit(t,a){for(var l of this.events[t]||[])l(a);for(var c of this.events["*"]||[])c(t,a)}};let Ln=class Ln{constructor(t){V(this,"_debugEventEmitter",new Mn),V(this,"checkStep",(t,a)=>this.checkStepEvent(t,a)&&this.checkStepUrl(t,a)&&this.checkStepElement(t,a)),V(this,"checkStepEvent",(t,a)=>null==a||!a.event||(null==t?void 0:t.event)===(null==a?void 0:a.event)),this.instance=t,this.actionEvents=new Set,this.actionRegistry=new Set}init(){var t,a;F(null===(t=this.instance)||void 0===t?void 0:t._addCaptureHook)||null===(a=this.instance)||void 0===a||a._addCaptureHook((t,a)=>{this.on(t,a)})}register(t){var a,l;if(!F(null===(a=this.instance)||void 0===a?void 0:a._addCaptureHook)&&(t.forEach(t=>{var a,l;null===(a=this.actionRegistry)||void 0===a||a.add(t),null===(l=t.steps)||void 0===l||l.forEach(t=>{var a;null===(a=this.actionEvents)||void 0===a||a.add((null==t?void 0:t.event)||"")})}),null!==(l=this.instance)&&void 0!==l&&l.autocapture)){var c,d=new Set;t.forEach(t=>{var a;null===(a=t.steps)||void 0===a||a.forEach(t=>{null!=t&&t.selector&&d.add(null==t?void 0:t.selector)})}),null===(c=this.instance)||void 0===c||c.autocapture.setElementSelectors(d)}}on(t,a){var l;null!=a&&0!=t.length&&(this.actionEvents.has(t)||this.actionEvents.has(null==a?void 0:a.event))&&this.actionRegistry&&(null===(l=this.actionRegistry)||void 0===l?void 0:l.size)>0&&this.actionRegistry.forEach(t=>{this.checkAction(a,t)&&this._debugEventEmitter.emit("actionCaptured",t.name)})}_addActionHook(t){this.onAction("actionCaptured",a=>t(a))}checkAction(t,a){if(null==(null==a?void 0:a.steps))return!1;for(var l of a.steps)if(this.checkStep(t,l))return!0;return!1}onAction(t,a){return this._debugEventEmitter.on(t,a)}checkStepUrl(t,a){if(null!=a&&a.url){var l,c=null==t||null===(l=t.properties)||void 0===l?void 0:l.$current_url;if(!c||"string"!=typeof c||!Ln.matchString(c,null==a?void 0:a.url,(null==a?void 0:a.url_matching)||"contains"))return!1}return!0}static matchString(t,a,l){switch(l){case"regex":return!!d&&On(t,a);case"exact":return a===t;case"contains":return On(t,Ln.escapeStringRegexp(a).replace(/_/g,".").replace(/%/g,".*"));default:return!1}}static escapeStringRegexp(t){return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}checkStepElement(t,a){if((null!=a&&a.href||null!=a&&a.tag_name||null!=a&&a.text)&&!this.getElementsList(t).some(t=>!(null!=a&&a.href&&!Ln.matchString(t.href||"",null==a?void 0:a.href,(null==a?void 0:a.href_matching)||"exact"))&&(null==a||!a.tag_name||t.tag_name===(null==a?void 0:a.tag_name))&&!(null!=a&&a.text&&!Ln.matchString(t.text||"",null==a?void 0:a.text,(null==a?void 0:a.text_matching)||"exact")&&!Ln.matchString(t.$el_text||"",null==a?void 0:a.text,(null==a?void 0:a.text_matching)||"exact"))))return!1;if(null!=a&&a.selector){var l,c=null==t||null===(l=t.properties)||void 0===l?void 0:l.$element_selectors;if(!c||!c.includes(null==a?void 0:a.selector))return!1}return!0}getElementsList(t){return null==(null==t?void 0:t.properties.$elements)?[]:null==t?void 0:t.properties.$elements}};let Dn=class Dn{constructor(t){this.instance=t,this.eventToSurveys=new Map,this.actionToSurveys=new Map}register(t){var a;F(null===(a=this.instance)||void 0===a?void 0:a._addCaptureHook)||(this.setupEventBasedSurveys(t),this.setupActionBasedSurveys(t))}setupActionBasedSurveys(t){var a=t.filter(t=>{var a,l,c,d;return(null===(a=t.conditions)||void 0===a?void 0:a.actions)&&(null===(l=t.conditions)||void 0===l||null===(c=l.actions)||void 0===c||null===(d=c.values)||void 0===d?void 0:d.length)>0});0!==a.length&&(null==this.actionMatcher&&(this.actionMatcher=new Ln(this.instance),this.actionMatcher.init(),this.actionMatcher._addActionHook(t=>{this.onAction(t)})),a.forEach(t=>{var a,l,c,d,h,_,p,g,v,f;t.conditions&&null!==(a=t.conditions)&&void 0!==a&&a.actions&&null!==(l=t.conditions)&&void 0!==l&&null!==(c=l.actions)&&void 0!==c&&c.values&&(null===(d=t.conditions)||void 0===d||null===(h=d.actions)||void 0===h||null===(_=h.values)||void 0===_?void 0:_.length)>0&&(null===(p=this.actionMatcher)||void 0===p||p.register(t.conditions.actions.values),null===(g=t.conditions)||void 0===g||null===(v=g.actions)||void 0===v||null===(f=v.values)||void 0===f||f.forEach(a=>{if(a&&a.name){var l=this.actionToSurveys.get(a.name);l&&l.push(t.id),this.actionToSurveys.set(a.name,l||[t.id])}}))}))}setupEventBasedSurveys(t){var a;0!==t.filter(t=>{var a,l,c,d;return(null===(a=t.conditions)||void 0===a?void 0:a.events)&&(null===(l=t.conditions)||void 0===l||null===(c=l.events)||void 0===c||null===(d=c.values)||void 0===d?void 0:d.length)>0}).length&&(null===(a=this.instance)||void 0===a||a._addCaptureHook((t,a)=>{this.onEvent(t,a)}),t.forEach(t=>{var a,l,c;null===(a=t.conditions)||void 0===a||null===(l=a.events)||void 0===l||null===(c=l.values)||void 0===c||c.forEach(a=>{if(a&&a.name){var l=this.eventToSurveys.get(a.name);l&&l.push(t.id),this.eventToSurveys.set(a.name,l||[t.id])}})}))}onEvent(t,a){var l,c,d=(null===(l=this.instance)||void 0===l||null===(c=l.persistence)||void 0===c?void 0:c.props[eN])||[];if(Dn.SURVEY_SHOWN_EVENT_NAME==t&&a&&d.length>0){var h,_=null==a||null===(h=a.properties)||void 0===h?void 0:h.$survey_id;if(_){var p=d.indexOf(_);p>=0&&(d.splice(p,1),this._updateActivatedSurveys(d))}}else this.eventToSurveys.has(t)&&this._updateActivatedSurveys(d.concat(this.eventToSurveys.get(t)||[]))}onAction(t){var a,l,c=(null===(a=this.instance)||void 0===a||null===(l=a.persistence)||void 0===l?void 0:l.props[eN])||[];this.actionToSurveys.has(t)&&this._updateActivatedSurveys(c.concat(this.actionToSurveys.get(t)||[]))}_updateActivatedSurveys(t){var a,l;null===(a=this.instance)||void 0===a||null===(l=a.persistence)||void 0===l||l.register({[eN]:[...new Set(t)]})}getSurveys(){var t,a;return(null===(t=this.instance)||void 0===t||null===(a=t.persistence)||void 0===a?void 0:a.props[eN])||[]}getEventToSurveys(){return this.eventToSurveys}_getActionMatcher(){return this.actionMatcher}};V(Dn,"SURVEY_SHOWN_EVENT_NAME","survey shown");var sv=eu("[Surveys]"),sf={icontains:(t,a)=>t.some(t=>a.toLowerCase().includes(t.toLowerCase())),not_icontains:(t,a)=>t.every(t=>!a.toLowerCase().includes(t.toLowerCase())),regex:(t,a)=>t.some(t=>On(a,t)),not_regex:(t,a)=>t.every(t=>!On(a,t)),exact:(t,a)=>t.some(t=>a===t),is_not:(t,a)=>t.every(t=>a!==t)};function Bn(t){return null!=t?t:"icontains"}let Hn=class Hn{constructor(t){V(this,"_isFetchingSurveys",!1),V(this,"_isInitializingSurveys",!1),this.instance=t,this._surveyEventReceiver=null}onRemoteConfig(t){this._decideServerResponse=!!t.surveys,sv.info("decideServerResponse set to ".concat(this._decideServerResponse)),this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate"),(()=>{for(var t=[],a=0;a<localStorage.length;a++){var l=localStorage.key(a);null!=l&&l.startsWith("seenSurvey_")&&t.push(l)}return t})().forEach(t=>localStorage.removeItem(t))}loadIfEnabled(){if(!this._surveyManager){if(this._isInitializingSurveys)sv.info("Already initializing surveys, skipping...");else if(this.instance.config.disable_surveys)sv.info("Disabled. Not loading surveys.");else{var t=null==B?void 0:B.__PosthogExtensions__;if(t){if(this._decideServerResponse){this._isInitializingSurveys=!0;try{var a=t.generateSurveys;if(a)this._surveyManager=a(this.instance),this._isInitializingSurveys=!1,this._surveyEventReceiver=new Dn(this.instance),sv.info("Surveys loaded successfully");else{var l=t.loadExternalDependency;l?l(this.instance,"surveys",a=>{if(a||!t.generateSurveys)return sv.error("Could not load surveys script",a),void(this._isInitializingSurveys=!1);this._surveyManager=t.generateSurveys(this.instance),this._isInitializingSurveys=!1,this._surveyEventReceiver=new Dn(this.instance),sv.info("Surveys loaded successfully")}):(sv.error("PostHog loadExternalDependency extension not found. Cannot load remote config."),this._isInitializingSurveys=!1)}}catch(t){throw sv.error("Error initializing surveys",t),this._isInitializingSurveys=!1,t}}else sv.warn("Decide not loaded yet. Not loading surveys.")}else sv.error("PostHog Extensions not found.")}}}getSurveys(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.instance.config.disable_surveys)return sv.info("Disabled. Not loading surveys."),t([]);var l=this.instance.get_property(eq);if(l&&!a)return t(l);if(this._isFetchingSurveys)return t([]);try{this._isFetchingSurveys=!0,this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),method:"GET",timeout:this.instance.config.surveys_request_timeout_ms,callback:a=>{this._isFetchingSurveys=!1;var l=a.statusCode;if(200!==l||!a.json)return sv.error("Surveys API could not be loaded, status: ".concat(l)),t([]);var c,d,h=a.json.surveys||[],_=h.filter(t=>{var a,l,c,d,h,_,p,g,v,f,w,S;return(null===(a=t.conditions)||void 0===a?void 0:a.events)&&(null===(l=t.conditions)||void 0===l||null===(c=l.events)||void 0===c?void 0:c.values)&&(null===(d=t.conditions)||void 0===d||null===(h=d.events)||void 0===h||null===(_=h.values)||void 0===_?void 0:_.length)>0||(null===(p=t.conditions)||void 0===p?void 0:p.actions)&&(null===(g=t.conditions)||void 0===g||null===(v=g.actions)||void 0===v?void 0:v.values)&&(null===(f=t.conditions)||void 0===f||null===(w=f.actions)||void 0===w||null===(S=w.values)||void 0===S?void 0:S.length)>0});return _.length>0&&(null===(d=this._surveyEventReceiver)||void 0===d||d.register(_)),null===(c=this.instance.persistence)||void 0===c||c.register({[eq]:h}),t(h)}})}catch(t){throw this._isFetchingSurveys=!1,t}}isSurveyFeatureFlagEnabled(t){return!t||this.instance.featureFlags.isFeatureEnabled(t)}getActiveMatchingSurveys(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getSurveys(a=>{var l,c=a.filter(t=>!(!t.start_date||t.end_date)).filter(t=>{if(!t.conditions)return!0;var a,l=function(t){if(null===(a=t.conditions)||void 0===a||!a.url)return!0;var a,l,c,h=null==d||null===(l=d.location)||void 0===l?void 0:l.href;if(!h)return!1;var _=[t.conditions.url];return sf[Bn(null===(c=t.conditions)||void 0===c?void 0:c.urlMatchType)](_,h)}(t),c=null===(a=t.conditions)||void 0===a||!a.selector||(null==f?void 0:f.querySelector(t.conditions.selector)),h=function(t){if(null===(a=t.conditions)||void 0===a||!a.deviceTypes||0===(null===(l=t.conditions)||void 0===l?void 0:l.deviceTypes.length))return!0;if(!x)return!1;var a,l,c,d=i5.deviceType(x);return sf[Bn(null===(c=t.conditions)||void 0===c?void 0:c.deviceTypesMatchType)](t.conditions.deviceTypes,d)}(t);return l&&c&&h}),h=null===(l=this._surveyEventReceiver)||void 0===l?void 0:l.getSurveys();return t(c.filter(t=>{if(!(t.linked_flag_key||t.targeting_flag_key||t.internal_targeting_flag_key||null!==(a=t.feature_flag_keys)&&void 0!==a&&a.length))return!0;var a,l,c,d,_,p,g,v,f,w=this.isSurveyFeatureFlagEnabled(t.linked_flag_key),S=this.isSurveyFeatureFlagEnabled(t.targeting_flag_key),k=(null!==(l=null===(c=t.conditions)||void 0===c||null===(d=c.events)||void 0===d||null===(_=d.values)||void 0===_?void 0:_.length)&&void 0!==l?l:0)>0,E=(null!==(p=null===(g=t.conditions)||void 0===g||null===(v=g.actions)||void 0===v||null===(f=v.values)||void 0===f?void 0:f.length)&&void 0!==p?p:0)>0,x=!k&&!E||(null==h?void 0:h.includes(t.id)),B=this._canActivateRepeatedly(t)||this.isSurveyFeatureFlagEnabled(t.internal_targeting_flag_key),H=this.checkFlags(t);return w&&S&&B&&x&&H}))},a)}checkFlags(t){var a;return null===(a=t.feature_flag_keys)||void 0===a||!a.length||t.feature_flag_keys.every(t=>{var{key:a,value:l}=t;return!a||!l||this.instance.featureFlags.isFeatureEnabled(l)})}_canActivateRepeatedly(t){var a;return A(null===(a=B.__PosthogExtensions__)||void 0===a?void 0:a.canActivateRepeatedly)?(sv.warn("init was not called"),!1):B.__PosthogExtensions__.canActivateRepeatedly(t)}canRenderSurvey(t){A(this._surveyManager)?sv.warn("init was not called"):this.getSurveys(a=>{var l=a.filter(a=>a.id===t)[0];this._surveyManager.canRenderSurvey(l)})}renderSurvey(t,a){A(this._surveyManager)?sv.warn("init was not called"):this.getSurveys(l=>{var c=l.filter(a=>a.id===t)[0];this._surveyManager.renderSurvey(c,null==f?void 0:f.querySelector(a))})}};var sm=eu("[RateLimiter]");let zn=class zn{constructor(t){var a,l;V(this,"serverLimits",{}),V(this,"lastEventRateLimited",!1),V(this,"checkForLimiting",t=>{var a=t.text;if(a&&a.length)try{(JSON.parse(a).quota_limited||[]).forEach(t=>{sm.info("".concat(t||"events"," is quota limited.")),this.serverLimits[t]=(new Date).getTime()+6e4})}catch(t){return void sm.warn('could not rate limit - continuing. Error: "'.concat(null==t?void 0:t.message,'"'),{text:a})}}),this.instance=t,this.captureEventsPerSecond=(null===(a=t.config.rate_limiting)||void 0===a?void 0:a.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null===(l=t.config.rate_limiting)||void 0===l?void 0:l.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(){var t,a,l,c=arguments.length>0&&void 0!==arguments[0]&&arguments[0],d=(new Date).getTime(),h=null!==(t=null===(a=this.instance.persistence)||void 0===a?void 0:a.get_property(eU))&&void 0!==t?t:{tokens:this.captureEventsBurstLimit,last:d};h.tokens+=(d-h.last)/1e3*this.captureEventsPerSecond,h.last=d,h.tokens>this.captureEventsBurstLimit&&(h.tokens=this.captureEventsBurstLimit);var _=h.tokens<1;return _||c||(h.tokens=Math.max(0,h.tokens-1)),!_||this.lastEventRateLimited||c||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=_,null===(l=this.instance.persistence)||void 0===l||l.set_property(eU,h),{isRateLimited:_,remainingTokens:h.tokens}}isServerRateLimited(t){var a=this.serverLimits[t||"events"]||!1;return!1!==a&&(new Date).getTime()<a}};var sb=eu("[RemoteConfig]");let Wn=class Wn{constructor(t){this.instance=t}get remoteConfig(){var t,a;return null===(t=B._POSTHOG_REMOTE_CONFIG)||void 0===t||null===(a=t[this.instance.config.token])||void 0===a?void 0:a.config}_loadRemoteConfigJs(t){var a,l,c;null!==(a=B.__PosthogExtensions__)&&void 0!==a&&a.loadExternalDependency?null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.loadExternalDependency)||void 0===c||c.call(l,this.instance,"remote-config",()=>t(this.remoteConfig)):(sb.error("PostHog Extensions not found. Cannot load remote config."),t())}_loadRemoteConfigJSON(t){this.instance._send_request({method:"GET",url:this.instance.requestRouter.endpointFor("assets","/array/".concat(this.instance.config.token,"/config")),callback:a=>{t(a.json)}})}load(){try{if(this.remoteConfig)return sb.info("Using preloaded remote config",this.remoteConfig),void this.onRemoteConfig(this.remoteConfig);if(this.instance.config.advanced_disable_decide)return void sb.warn("Remote config is disabled. Falling back to local config.");this._loadRemoteConfigJs(t=>{if(!t)return sb.info("No config found after loading remote JS config. Falling back to JSON."),void this._loadRemoteConfigJSON(t=>{this.onRemoteConfig(t)});this.onRemoteConfig(t)})}catch(t){sb.error("Error loading remote config",t)}}onRemoteConfig(t){t?this.instance.config.__preview_remote_config?(this.instance._onRemoteConfig(t),!1!==t.hasFeatureFlags&&this.instance.featureFlags.ensureFlagsLoaded()):sb.info("__preview_remote_config is disabled. Logging config instead",t):sb.error("Failed to fetch remote config from PostHog.")}};var Vn=function(t){var a,l,c,d,h="";for(a=l=0,c=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,d=0;d<c;d++){var _=t.charCodeAt(d),p=null;_<128?l++:p=_>127&&_<2048?String.fromCharCode(_>>6|192,63&_|128):String.fromCharCode(_>>12|224,_>>6&63|128,63&_|128),$(p)||(l>a&&(h+=t.substring(a,l)),h+=p,a=l=d+1)}return l>a&&(h+=t.substring(a,t.length)),h},sy=!!k||!!S,sw="text/plain",Yn=(t,a)=>{var[l,c]=t.split("?"),d=W({},a);null==c||c.split("&").forEach(t=>{var[a]=t.split("=");delete d[a]});var h=kt(d);return h=h?(c?c+"&":"")+h:c,"".concat(l,"?").concat(h)},Kn=(t,a)=>JSON.stringify(t,(t,a)=>"bigint"==typeof a?a.toString():a,a),Xn=t=>{var{data:a,compression:l}=t;if(a){if(l===c.GZipJS){var d=ns(os(Kn(a)),{mtime:0}),h=new Blob([d],{type:sw});return{contentType:sw,body:h,estimatedSize:h.size}}if(l===c.Base64){var _,p="data="+encodeURIComponent("string"==typeof(_=function(t){var a,l,c,d,h,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,g=0,v="",f=[];if(!t)return t;t=Vn(t);do a=(h=t.charCodeAt(p++)<<16|t.charCodeAt(p++)<<8|t.charCodeAt(p++))>>18&63,l=h>>12&63,c=h>>6&63,d=63&h,f[g++]=_.charAt(a)+_.charAt(l)+_.charAt(c)+_.charAt(d);while(p<t.length);switch(v=f.join(""),t.length%3){case 1:v=v.slice(0,-2)+"==";break;case 2:v=v.slice(0,-1)+"="}return v}(Kn(a)))?_:Kn(_));return{contentType:"application/x-www-form-urlencoded",body:p,estimatedSize:new Blob([p]).size}}var g=Kn(a);return{contentType:"application/json",body:g,estimatedSize:new Blob([g]).size}}},sS=[];S&&sS.push({transport:"fetch",method:t=>{var a,l,{contentType:c,body:d,estimatedSize:h}=null!==(a=Xn(t))&&void 0!==a?a:{},_=new Headers;K(t.headers,function(t,a){_.append(a,t)}),c&&_.append("Content-Type",c);var p=t.url,g=null;if(E){var v=new E;g={signal:v.signal,timeout:setTimeout(()=>v.abort(),t.timeout)}}S(p,W({method:(null==t?void 0:t.method)||"GET",headers:_,keepalive:"POST"===t.method&&52428.8>(h||0),body:d,signal:null===(l=g)||void 0===l?void 0:l.signal},t.fetchOptions)).then(a=>a.text().then(l=>{var c,d={statusCode:a.status,text:l};if(200===a.status)try{d.json=JSON.parse(l)}catch(t){ec.error(t)}null===(c=t.callback)||void 0===c||c.call(t,d)})).catch(a=>{var l;ec.error(a),null===(l=t.callback)||void 0===l||l.call(t,{statusCode:0,text:a})}).finally(()=>g?clearTimeout(g.timeout):null)}}),k&&sS.push({transport:"XHR",method:t=>{var a,l=new k;l.open(t.method||"GET",t.url,!0);var{contentType:c,body:d}=null!==(a=Xn(t))&&void 0!==a?a:{};K(t.headers,function(t,a){l.setRequestHeader(a,t)}),c&&l.setRequestHeader("Content-Type",c),t.timeout&&(l.timeout=t.timeout),l.withCredentials=!0,l.onreadystatechange=()=>{if(4===l.readyState){var a,c={statusCode:l.status,text:l.responseText};if(200===l.status)try{c.json=JSON.parse(l.responseText)}catch(t){}null===(a=t.callback)||void 0===a||a.call(t,c)}},l.send(d)}}),null!=v&&v.sendBeacon&&sS.push({transport:"sendBeacon",method:t=>{var a=Yn(t.url,{beacon:"1"});try{var l,{contentType:c,body:d}=null!==(l=Xn(t))&&void 0!==l?l:{},h="string"==typeof d?new Blob([d],{type:c}):d;v.sendBeacon(a,h)}catch(t){}}});let eo=class eo{constructor(t,a){V(this,"isPaused",!0),V(this,"queue",[]),this.flushTimeoutMs=wi((null==a?void 0:a.flush_interval_ms)||3e3,250,5e3,"flush interval",3e3),this.sendRequest=t}enqueue(t){this.queue.push(t),this.flushTimeout||this.setFlushTimeout()}unload(){this.clearFlushTimeout();var t=Object.values(this.queue.length>0?this.formatQueue():{});[...t.filter(t=>0===t.url.indexOf("/e")),...t.filter(t=>0!==t.url.indexOf("/e"))].map(t=>{this.sendRequest(W(W({},t),{},{transport:"sendBeacon"}))})}enable(){this.isPaused=!1,this.setFlushTimeout()}setFlushTimeout(){var t=this;this.isPaused||(this.flushTimeout=setTimeout(()=>{if(this.clearFlushTimeout(),this.queue.length>0){var a=this.formatQueue();for(var l in a)!function(l){var c=a[l],d=(new Date).getTime();c.data&&el(c.data)&&K(c.data,t=>{t.offset=Math.abs(t.timestamp-d),delete t.timestamp}),t.sendRequest(c)}(l)}},this.flushTimeoutMs))}clearFlushTimeout(){clearTimeout(this.flushTimeout),this.flushTimeout=void 0}formatQueue(){var t={};return K(this.queue,a=>{var l,c=(a?a.batchKey:null)||a.url;F(t[c])&&(t[c]=W(W({},a),{},{data:[]})),null===(l=t[c].data)||void 0===l||l.push(a.data)}),this.queue=[],t}};var sk=["retriesPerformedSoFar"];let io=class io{constructor(t){V(this,"isPolling",!1),V(this,"pollIntervalMs",3e3),V(this,"queue",[]),this.instance=t,this.queue=[],this.areWeOnline=!0,!F(d)&&"onLine"in d.navigator&&(this.areWeOnline=d.navigator.onLine,ae(d,"online",()=>{this.areWeOnline=!0,this.flush()}),ae(d,"offline",()=>{this.areWeOnline=!1}))}retriableRequest(t){var{retriesPerformedSoFar:a}=t,l=G(t,sk);O(a)&&a>0&&(l.url=Yn(l.url,{retry_count:a})),this.instance._send_request(W(W({},l),{},{callback:t=>{var c;200!==t.statusCode&&(t.statusCode<400||t.statusCode>=500)&&(null!=a?a:0)<10?this.enqueue(W({retriesPerformedSoFar:a},l)):null===(c=l.callback)||void 0===c||c.call(l,t)}}))}enqueue(t){var a,l,c,d=t.retriesPerformedSoFar||0;t.retriesPerformedSoFar=d+1;var h=(c=(Math.random()-.5)*((l=Math.min(18e5,a=3e3*Math.pow(2,d)))-a/2),Math.ceil(l+c)),_=Date.now()+h;this.queue.push({retryAt:_,requestOptions:t});var p="Enqueued failed request for retry in ".concat(h);navigator.onLine||(p+=" (Browser is offline)"),ec.warn(p),this.isPolling||(this.isPolling=!0,this.poll())}poll(){this.poller&&clearTimeout(this.poller),this.poller=setTimeout(()=>{this.areWeOnline&&this.queue.length>0&&this.flush(),this.poll()},this.pollIntervalMs)}flush(){var t=Date.now(),a=[],l=this.queue.filter(l=>l.retryAt<t||(a.push(l),!1));if(this.queue=a,l.length>0)for(var{requestOptions:c}of l)this.retriableRequest(c)}unload(){for(var{requestOptions:t}of(this.poller&&(clearTimeout(this.poller),this.poller=void 0),this.queue))try{this.instance._send_request(W(W({},t),{},{transport:"sendBeacon"}))}catch(t){ec.error(t)}this.queue=[]}};let so=class so{constructor(t){V(this,"_updateScrollData",()=>{this.context||(this.context={});var t,a,l,c,d=this.scrollElement(),h=this.scrollY(),_=d?Math.max(0,d.scrollHeight-d.clientHeight):0,p=h+((null==d?void 0:d.clientHeight)||0),g=(null==d?void 0:d.scrollHeight)||0;this.context.lastScrollY=Math.ceil(h),this.context.maxScrollY=Math.max(h,null!==(t=this.context.maxScrollY)&&void 0!==t?t:0),this.context.maxScrollHeight=Math.max(_,null!==(a=this.context.maxScrollHeight)&&void 0!==a?a:0),this.context.lastContentY=p,this.context.maxContentY=Math.max(p,null!==(l=this.context.maxContentY)&&void 0!==l?l:0),this.context.maxContentHeight=Math.max(g,null!==(c=this.context.maxContentHeight)&&void 0!==c?c:0)}),this.instance=t}getContext(){return this.context}resetContext(){var t=this.context;return setTimeout(this._updateScrollData,0),t}startMeasuringScrollPosition(){ae(d,"scroll",this._updateScrollData,{capture:!0}),ae(d,"scrollend",this._updateScrollData,{capture:!0}),ae(d,"resize",this._updateScrollData)}scrollElement(){if(!this.instance.config.scroll_root_selector)return null==d?void 0:d.document.documentElement;for(var t of el(this.instance.config.scroll_root_selector)?this.instance.config.scroll_root_selector:[this.instance.config.scroll_root_selector]){var a=null==d?void 0:d.document.querySelector(t);if(a)return a}}scrollY(){if(this.instance.config.scroll_root_selector){var t=this.scrollElement();return t&&t.scrollTop||0}return d&&(d.scrollY||d.pageYOffset||d.document.documentElement.scrollTop)||0}scrollX(){if(this.instance.config.scroll_root_selector){var t=this.scrollElement();return t&&t.scrollLeft||0}return d&&(d.scrollX||d.pageXOffset||d.document.documentElement.scrollLeft)||0}};var ro=t=>i5.personInfo({maskPersonalDataProperties:null==t?void 0:t.config.mask_personal_data_properties,customPersonalDataProperties:null==t?void 0:t.config.custom_personal_data_properties});let no=class no{constructor(t,a,l,c){V(this,"_onSessionIdCallback",t=>{var a=this._getStored();if(!a||a.sessionId!==t){var l={sessionId:t,props:this._sessionSourceParamGenerator(this.instance)};this._persistence.register({[eH]:l})}}),this.instance=t,this._sessionIdManager=a,this._persistence=l,this._sessionSourceParamGenerator=c||ro,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}_getStored(){return this._persistence.props[eH]}getSetOnceProps(){var t,a=null===(t=this._getStored())||void 0===t?void 0:t.props;return a?"r"in a?i5.personPropsFromInfo(a):{$referring_domain:a.referringDomain,$pathname:a.initialPathName,utm_source:a.utm_source,utm_campaign:a.utm_campaign,utm_medium:a.utm_medium,utm_content:a.utm_content,utm_term:a.utm_term}:{}}getSessionProps(){var t={};return K(ie(this.getSetOnceProps()),(a,l)=>{"$current_url"===l&&(l="url"),t["$session_entry_".concat(b(l))]=a}),t}};var sE=eu("[SessionId]");let ao=class ao{constructor(t,a,l){if(V(this,"_sessionIdChangedHandlers",[]),!t.persistence)throw Error("SessionIdManager requires a PostHogPersistence instance");if(t.config.__preview_experimental_cookieless_mode)throw Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.config=t.config,this.persistence=t.persistence,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=a||Nt,this._windowIdGenerator=l||Nt;var c,d=this.config.persistence_name||this.config.token,h=this.config.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*wi(h,60,36e3,"session_idle_timeout_seconds",1800),t.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.resetIdleTimer(),this._window_id_storage_key="ph_"+d+"_window_id",this._primary_window_exists_storage_key="ph_"+d+"_primary_window_exists",this._canUseSessionStorage()){var _=tp.parse(this._window_id_storage_key),p=tp.parse(this._primary_window_exists_storage_key);_&&!p?this._windowId=_:tp.remove(this._window_id_storage_key),tp.set(this._primary_window_exists_storage_key,!0)}if(null!==(c=this.config.bootstrap)&&void 0!==c&&c.sessionID)try{var g=(t=>{var a=t.replace(/-/g,"");if(32!==a.length)throw Error("Not a valid UUID");if("7"!==a[12])throw Error("Not a UUIDv7");return parseInt(a.substring(0,12),16)})(this.config.bootstrap.sessionID);this._setSessionId(this.config.bootstrap.sessionID,(new Date).getTime(),g)}catch(t){sE.error("Invalid sessionID in bootstrap",t)}this._listenToReloadWindow()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(t){return F(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(t),this._sessionId&&t(this._sessionId,this._windowId),()=>{this._sessionIdChangedHandlers=this._sessionIdChangedHandlers.filter(a=>a!==t)}}_canUseSessionStorage(){return"memory"!==this.config.persistence&&!this.persistence.disabled&&tp.is_supported()}_setWindowId(t){t!==this._windowId&&(this._windowId=t,this._canUseSessionStorage()&&tp.set(this._window_id_storage_key,t))}_getWindowId(){return this._windowId?this._windowId:this._canUseSessionStorage()?tp.parse(this._window_id_storage_key):null}_setSessionId(t,a,l){t===this._sessionId&&a===this._sessionActivityTimestamp&&l===this._sessionStartTimestamp||(this._sessionStartTimestamp=l,this._sessionActivityTimestamp=a,this._sessionId=t,this.persistence.register({[eT]:[a,t,l]}))}_getSessionId(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var t=this.persistence.props[eT];return el(t)&&2===t.length&&t.push(t[0]),t||[0,null,0]}resetSessionId(){this._setSessionId(null,null,null)}_listenToReloadWindow(){ae(d,"beforeunload",()=>{this._canUseSessionStorage()&&tp.remove(this._primary_window_exists_storage_key)},{capture:!1})}checkAndGetSessionAndWindowId(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.config.__preview_experimental_cookieless_mode)throw Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var l=a||(new Date).getTime(),[c,d,h]=this._getSessionId(),_=this._getWindowId(),p=O(h)&&h>0&&Math.abs(l-h)>864e5,g=!1,v=!d,f=!t&&Math.abs(l-c)>this.sessionTimeoutMs;v||f||p?(d=this._sessionIdGenerator(),_=this._windowIdGenerator(),sE.info("new session ID generated",{sessionId:d,windowId:_,changeReason:{noSessionId:v,activityTimeout:f,sessionPastMaximumLength:p}}),h=l,g=!0):_||(_=this._windowIdGenerator(),g=!0);var w=0===c||!t||p?l:c,S=0===h?(new Date).getTime():h;return this._setWindowId(_),this._setSessionId(d,w,S),t||this.resetIdleTimer(),g&&this._sessionIdChangedHandlers.forEach(t=>t(d,_,g?{noSessionId:v,activityTimeout:f,sessionPastMaximumLength:p}:void 0)),{sessionId:d,windowId:_,sessionStartTimestamp:S,changeReason:g?{noSessionId:v,activityTimeout:f,sessionPastMaximumLength:p}:void 0,lastActivityTimestamp:c}}resetIdleTimer(){clearTimeout(this._enforceIdleTimeout),this._enforceIdleTimeout=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}};var sx=["$set_once","$set"],sF=eu("[SiteApps]");let uo=class uo{constructor(t){this.instance=t,this.bufferedInvocations=[],this.apps={}}get isEnabled(){return!!this.instance.config.opt_in_site_apps}eventCollector(t,a){if(a){var l=this.globalsForEvent(a);this.bufferedInvocations.push(l),this.bufferedInvocations.length>1e3&&(this.bufferedInvocations=this.bufferedInvocations.slice(10))}}get siteAppLoaders(){var t,a;return null===(t=B._POSTHOG_REMOTE_CONFIG)||void 0===t||null===(a=t[this.instance.config.token])||void 0===a?void 0:a.siteApps}init(){if(this.isEnabled){var t=this.instance._addCaptureHook(this.eventCollector.bind(this));this.stopBuffering=()=>{t(),this.bufferedInvocations=[],this.stopBuffering=void 0}}}globalsForEvent(t){if(!t)throw Error("Event payload is required");var a,l,c,d,h,_,p,g={},v=this.instance.get_property("$groups")||[];for(var[f,w]of Object.entries(this.instance.get_property("$stored_group_properties")||{}))g[f]={id:v[f],type:f,properties:w};var{$set_once:S,$set:k}=t;return{event:W(W({},G(t,sx)),{},{properties:W(W(W({},t.properties),k?{$set:W(W({},null!==(a=null===(l=t.properties)||void 0===l?void 0:l.$set)&&void 0!==a?a:{}),k)}:{}),S?{$set_once:W(W({},null!==(c=null===(d=t.properties)||void 0===d?void 0:d.$set_once)&&void 0!==c?c:{}),S)}:{}),elements_chain:null!==(h=null===(_=t.properties)||void 0===_?void 0:_.$elements_chain)&&void 0!==h?h:"",distinct_id:null===(p=t.properties)||void 0===p?void 0:p.distinct_id}),person:{properties:this.instance.get_property("$stored_person_properties")},groups:g}}setupSiteApp(t){var a=this.apps[t.id],i=()=>{var l;!a.errored&&this.bufferedInvocations.length&&(sF.info("Processing ".concat(this.bufferedInvocations.length," events for site app with id ").concat(t.id)),this.bufferedInvocations.forEach(t=>{var l;return null===(l=a.processEvent)||void 0===l?void 0:l.call(a,t)}),a.processedBuffer=!0),Object.values(this.apps).every(t=>t.processedBuffer||t.errored)&&(null===(l=this.stopBuffering)||void 0===l||l.call(this))},l=!1,r=c=>{a.errored=!c,a.loaded=!0,sF.info("Site app with id ".concat(t.id," ").concat(c?"loaded":"errored")),l&&i()};try{var{processEvent:c}=t.init({posthog:this.instance,callback:t=>{r(t)}});c&&(a.processEvent=c),l=!0}catch(a){sF.error("Error while initializing PostHog app with config id ".concat(t.id),a),r(!1)}if(l&&a.loaded)try{i()}catch(l){sF.error("Error while processing buffered events PostHog app with config id ".concat(t.id),l),a.errored=!0}}setupSiteApps(){var t=this.siteAppLoaders||[];for(var a of t)this.apps[a.id]={id:a.id,loaded:!1,errored:!1,processedBuffer:!1};for(var l of t)this.setupSiteApp(l)}onCapturedEvent(t){if(0!==Object.keys(this.apps).length){var a,l=this.globalsForEvent(t);for(var c of Object.values(this.apps))try{null===(a=c.processEvent)||void 0===a||a.call(c,l)}catch(a){sF.error("Error while processing event ".concat(t.event," for site app ").concat(c.id),a)}}}onRemoteConfig(t){var a,l,c,d=this;if(null!==(a=this.siteAppLoaders)&&void 0!==a&&a.length)return this.isEnabled?(this.setupSiteApps(),void this.instance.on("eventCaptured",t=>this.onCapturedEvent(t))):void sF.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if(null===(l=this.stopBuffering)||void 0===l||l.call(this),null!==(c=t.siteApps)&&void 0!==c&&c.length){if(this.isEnabled){var n=function(t,a){var l,c;B["__$$ph_site_app_".concat(t)]=d.instance,null===(l=B.__PosthogExtensions__)||void 0===l||null===(c=l.loadSiteApp)||void 0===c||c.call(l,d.instance,a,a=>{if(a)return sF.error("Error while initializing PostHog app with config id ".concat(t),a)})};for(var{id:h,url:_}of t.siteApps)n(h,_)}else sF.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}};var sI,sP,sC,sR,sT,s$,sA,sO=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google","bytespider"],po=function(t,a){if(!t)return!1;var l=t.toLowerCase();return sO.concat(a||[]).some(t=>{var a=t.toLowerCase();return -1!==l.indexOf(a)})},go=function(t,a){if(!t)return!1;var l=t.userAgent;if(l&&po(l,a))return!0;try{var c=null==t?void 0:t.userAgentData;if(null!=c&&c.brands&&c.brands.some(t=>po(null==t?void 0:t.brand,a)))return!0}catch(t){}return!!t.webdriver};function vo(t,a,l){return Kn({distinct_id:t,userPropertiesToSet:a,userPropertiesToSetOnce:l})}(sN=sA||(sA={})).US="us",sN.EU="eu",sN.CUSTOM="custom";var sM="i.posthog.com";let mo=class mo{constructor(t){V(this,"_regionCache",{}),this.instance=t}get apiHost(){var t=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===t?"https://us.i.posthog.com":t}get uiHost(){var t,a=null===(t=this.instance.config.ui_host)||void 0===t?void 0:t.replace(/\/$/,"");return a||(a=this.apiHost.replace(".".concat(sM),".posthog.com")),"https://app.posthog.com"===a?"https://us.posthog.com":a}get region(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=sA.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=sA.EU:this._regionCache[this.apiHost]=sA.CUSTOM),this._regionCache[this.apiHost]}endpointFor(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(a&&(a="/"===a[0]?a:"/".concat(a)),"ui"===t)return this.uiHost+a;if(this.region===sA.CUSTOM)return this.apiHost+a;var l=sM+a;switch(t){case"assets":return"https://".concat(this.region,"-assets.").concat(l);case"api":return"https://".concat(this.region,".").concat(l)}}};var sL={icontains:(t,a)=>!!d&&a.href.toLowerCase().indexOf(t.toLowerCase())>-1,not_icontains:(t,a)=>!!d&&-1===a.href.toLowerCase().indexOf(t.toLowerCase()),regex:(t,a)=>!!d&&On(a.href,t),not_regex:(t,a)=>!!d&&!On(a.href,t),exact:(t,a)=>a.href===t,is_not:(t,a)=>a.href!==t};let bo=class bo{constructor(t){var a=this;V(this,"getWebExperimentsAndEvaluateDisplayLogic",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a.getWebExperiments(t=>{bo.logInfo("retrieved web experiments from the server"),a._flagToExperiments=new Map,t.forEach(t=>{if(t.feature_flag_key){a._flagToExperiments&&(bo.logInfo("setting flag key ",t.feature_flag_key," to web experiment ",t),null===(l=a._flagToExperiments)||void 0===l||l.set(t.feature_flag_key,t));var l,c=a.instance.getFeatureFlag(t.feature_flag_key);R(c)&&t.variants[c]&&a.applyTransforms(t.name,c,t.variants[c].transforms)}else if(t.variants)for(var d in t.variants){var h=t.variants[d];bo.matchesTestVariant(h)&&a.applyTransforms(t.name,d,h.transforms)}})},t)}),this.instance=t,this.instance.onFeatureFlags(t=>{this.onFeatureFlags(t)})}onFeatureFlags(t){if(this._is_bot())bo.logInfo("Refusing to render web experiment since the viewer is a likely bot");else if(!this.instance.config.disable_web_experiments){if(A(this._flagToExperiments))return this._flagToExperiments=new Map,this.loadIfEnabled(),void this.previewWebExperiment();bo.logInfo("applying feature flags",t),t.forEach(t=>{var a;if(this._flagToExperiments&&null!==(a=this._flagToExperiments)&&void 0!==a&&a.has(t)){var l,c=this.instance.getFeatureFlag(t),d=null===(l=this._flagToExperiments)||void 0===l?void 0:l.get(t);c&&null!=d&&d.variants[c]&&this.applyTransforms(d.name,c,d.variants[c].transforms)}})}}previewWebExperiment(){var t=bo.getWindowLocation();if(null!=t&&t.search){var a=Et(null==t?void 0:t.search,"__experiment_id"),l=Et(null==t?void 0:t.search,"__experiment_variant");a&&l&&(bo.logInfo("previewing web experiments ".concat(a," && ").concat(l)),this.getWebExperiments(t=>{this.showPreviewWebExperiment(parseInt(a),l,t)},!1,!0))}}loadIfEnabled(){this.instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(t,a,l){if(this.instance.config.disable_web_experiments&&!l)return t([]);var c=this.instance.get_property("$web_experiments");if(c&&!a)return t(c);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/web_experiments/?token=".concat(this.instance.config.token)),method:"GET",callback:a=>200===a.statusCode&&a.json?t(a.json.experiments||[]):t([])})}showPreviewWebExperiment(t,a,l){var c=l.filter(a=>a.id===t);c&&c.length>0&&(bo.logInfo("Previewing web experiment [".concat(c[0].name,"] with variant [").concat(a,"]")),this.applyTransforms(c[0].name,a,c[0].variants[a].transforms))}static matchesTestVariant(t){return!A(t.conditions)&&bo.matchUrlConditions(t)&&bo.matchUTMConditions(t)}static matchUrlConditions(t){if(A(t.conditions)||A(null===(a=t.conditions)||void 0===a?void 0:a.url))return!0;var a,l,c,d,h=bo.getWindowLocation();return!!h&&(null===(l=t.conditions)||void 0===l||!l.url||sL[null!==(c=null===(d=t.conditions)||void 0===d?void 0:d.urlMatchType)&&void 0!==c?c:"icontains"](t.conditions.url,h))}static getWindowLocation(){return null==d?void 0:d.location}static matchUTMConditions(t){if(A(t.conditions)||A(null===(l=t.conditions)||void 0===l?void 0:l.utm))return!0;var a=i5.campaignParams();if(a.utm_source){var l,c,d,h,_,p,g,v,f,w,S,k,E,x,B,H,U,J=null===(c=t.conditions)||void 0===c||null===(d=c.utm)||void 0===d||!d.utm_campaign||(null===(h=t.conditions)||void 0===h||null===(_=h.utm)||void 0===_?void 0:_.utm_campaign)==a.utm_campaign,ei=null===(p=t.conditions)||void 0===p||null===(g=p.utm)||void 0===g||!g.utm_source||(null===(v=t.conditions)||void 0===v||null===(f=v.utm)||void 0===f?void 0:f.utm_source)==a.utm_source,er=null===(w=t.conditions)||void 0===w||null===(S=w.utm)||void 0===S||!S.utm_medium||(null===(k=t.conditions)||void 0===k||null===(E=k.utm)||void 0===E?void 0:E.utm_medium)==a.utm_medium,en=null===(x=t.conditions)||void 0===x||null===(B=x.utm)||void 0===B||!B.utm_term||(null===(H=t.conditions)||void 0===H||null===(U=H.utm)||void 0===U?void 0:U.utm_term)==a.utm_term;return J&&er&&en&&ei}return!1}static logInfo(t){for(var a=arguments.length,l=Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];ec.info("[WebExperiments] ".concat(t),l)}applyTransforms(t,a,l){this._is_bot()?bo.logInfo("Refusing to render web experiment since the viewer is a likely bot"):"control"!==a?l.forEach(l=>{if(l.selector){bo.logInfo("applying transform of variant ".concat(a," for experiment ").concat(t," "),l);var c,d=null===(c=document)||void 0===c?void 0:c.querySelectorAll(l.selector);null==d||d.forEach(t=>{l.html&&(t.innerHTML=l.html),l.css&&t.setAttribute("style",l.css)})}}):bo.logInfo("Control variants leave the page unmodified.")}_is_bot(){return v&&this.instance?go(v,this.instance.config.custom_blocked_useragents):void 0}};var sD={},So=()=>{},sW="posthog",sq=!sy&&-1===(null==x?void 0:x.indexOf("MSIE"))&&-1===(null==x?void 0:x.indexOf("Mozilla")),xo=()=>{var t;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:function(t){var a=null==t?void 0:t.hostname;if(!R(a))return!1;var l=a.split(".").slice(-2).join(".");for(var c of e_)if(l===c)return!1;return!0}(null==f?void 0:f.location),persistence:"localStorage+cookie",persistence_name:"",loaded:So,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:w&&R(null==w?void 0:w.search)&&-1!==w.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==d||null===(t=d.location)||void 0===t?void 0:t.protocol),ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var a="Bad HTTP status: "+t.statusCode+" "+t.text;ec.error(a)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:3e3},_onCapture:So}},Io=t=>{var a={};F(t.process_person)||(a.person_profiles=t.process_person),F(t.xhr_headers)||(a.request_headers=t.xhr_headers),F(t.cookie_name)||(a.persistence_name=t.cookie_name),F(t.disable_cookie)||(a.disable_persistence=t.disable_cookie),F(t.store_google)||(a.save_campaign_params=t.store_google),F(t.verbose)||(a.debug=t.verbose);var l=X({},a,t);return el(t.property_blacklist)&&(F(t.property_denylist)?l.property_denylist=t.property_blacklist:el(t.property_denylist)?l.property_denylist=[...t.property_blacklist,...t.property_denylist]:ec.error("Invalid value for property_denylist config: "+t.property_denylist)),l};let Po=class Po{constructor(){V(this,"__forceAllowLocalhost",!1)}get _forceAllowLocalhost(){return this.__forceAllowLocalhost}set _forceAllowLocalhost(t){ec.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=t}};let Co=class Co{get decideEndpointWasHit(){var t,a;return null!==(t=null===(a=this.featureFlags)||void 0===a?void 0:a.hasLoadedFlags)&&void 0!==t&&t}constructor(){V(this,"webPerformance",new Po),V(this,"_personProcessingSetOncePropertiesSent",!1),V(this,"version",H.LIB_VERSION),V(this,"_internalEventEmitter",new Mn),this.config=xo(),this.SentryIntegration=ws,this.sentryIntegration=t=>{var a;return a=bs(this,t),{name:tK,processEvent:t=>a(t)}},this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this._initialPageviewCaptured=!1,this._initialPersonProfilesConfig=null,this._cachedIdentify=null,this.featureFlags=new Ws(this),this.toolbar=new Is(this),this.scrollManager=new so(this),this.pageViewManager=new Ms(this),this.surveys=new Hn(this),this.experiments=new bo(this),this.exceptions=new Ls(this),this.rateLimiter=new zn(this),this.requestRouter=new mo(this),this.consent=new ti(this),this.people={set:(t,a,l)=>{var c=R(t)?{[t]:a}:t;this.setPersonProperties(c),null==l||l({})},set_once:(t,a,l)=>{var c=R(t)?{[t]:a}:t;this.setPersonProperties(void 0,c),null==l||l({})}},this.on("eventCaptured",t=>ec.info('send "'.concat(null==t?void 0:t.event,'"'),t))}init(t,a,l){if(l&&l!==sW){var c,d=null!==(c=sD[l])&&void 0!==c?c:new Co;return d._init(t,a,l),sD[l]=d,sD[sW][l]=d,d}return this._init(t,a,l)}_init(t){var a,l,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0;if(F(t)||T(t))return ec.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return ec.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this._triggered_notifs=[],h.person_profiles&&(this._initialPersonProfilesConfig=h.person_profiles),this.set_config(X({},xo(),Io(h),{name:_,token:t})),this.config.on_xhr_error&&ec.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=h.disable_compression?void 0:c.GZipJS,this.persistence=new Gr(this.config),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Gr(W(W({},this.config),{},{persistence:"sessionStorage"}));var p=W({},this.persistence.props),g=W({},this.sessionPersistence.props);if(this._requestQueue=new eo(t=>this._send_retriable_request(t),this.config.request_queue_config),this._retryQueue=new io(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new ao(this),this.sessionPropsManager=new no(this,this.sessionManager,this.persistence)),new Cs(this).startIfEnabledOrStop(),this.siteApps=new uo(this),null===(a=this.siteApps)||void 0===a||a.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new vs(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new $t(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new Os(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new Ts(this),this.exceptionObserver=new ai(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new ni(this,ri),this.deadClicksAutocapture.startIfEnabled(),H.DEBUG=H.DEBUG||this.config.debug,H.DEBUG&&ec.info("Starting in debug mode",{this:this,config:h,thisC:W({},this.config),p:p,s:g}),this._sync_opt_out_with_persistence(),void 0!==(null===(l=h.bootstrap)||void 0===l?void 0:l.distinctID)){var v,f,w=this.config.get_device_id(Nt()),S=null!==(v=h.bootstrap)&&void 0!==v&&v.isIdentifiedID?w:h.bootstrap.distinctID;this.persistence.set_property(eV,null!==(f=h.bootstrap)&&void 0!==f&&f.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:h.bootstrap.distinctID,$device_id:S})}if(this._hasBootstrappedFeatureFlags()){var k,E,x=Object.keys((null===(k=h.bootstrap)||void 0===k?void 0:k.featureFlags)||{}).filter(t=>{var a,l;return!(null===(a=h.bootstrap)||void 0===a||null===(l=a.featureFlags)||void 0===l||!l[t])}).reduce((t,a)=>{var l,c;return t[a]=(null===(l=h.bootstrap)||void 0===l||null===(c=l.featureFlags)||void 0===c?void 0:c[a])||!1,t},{}),B=Object.keys((null===(E=h.bootstrap)||void 0===E?void 0:E.featureFlagPayloads)||{}).filter(t=>x[t]).reduce((t,a)=>{var l,c,d,_;return null!==(l=h.bootstrap)&&void 0!==l&&null!==(c=l.featureFlagPayloads)&&void 0!==c&&c[a]&&(t[a]=null===(d=h.bootstrap)||void 0===d||null===(_=d.featureFlagPayloads)||void 0===_?void 0:_[a]),t},{});this.featureFlags.receivedFeatureFlags({featureFlags:x,featureFlagPayloads:B})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:eY,$device_id:null},"");else if(!this.get_distinct_id()){var U=this.config.get_device_id(Nt());this.register_once({distinct_id:U,$device_id:U},""),this.persistence.set_property(eV,"anonymous")}return ae(d,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),h.segment?function(t,a){var l=t.config.segment;if(!l)return a();!function(t,a){var l=t.config.segment;if(!l)return a();var s=l=>{var s=()=>l.anonymousId()||Nt();t.config.get_device_id=s,l.id()&&(t.register({distinct_id:l.id(),$device_id:s()}),t.persistence.set_property(eV,"identified")),a()},c=l.user();"then"in c&&I(c.then)?c.then(t=>s(t)):s(c)}(t,()=>{var c;l.register((Promise&&Promise.resolve||tG.warn("This browser does not have Promise support, and can not use the segment integration"),c=(a,l)=>{if(!l)return a;a.event.userId||a.event.anonymousId===t.get_distinct_id()||(tG.info("No userId set, resetting PostHog"),t.reset()),a.event.userId&&a.event.userId!==t.get_distinct_id()&&(tG.info("UserId set, identifying with PostHog"),t.identify(a.event.userId));var c,d=t._calculate_event_properties(l,null!==(c=a.event.properties)&&void 0!==c?c:{},new Date);return a.event.properties=Object.assign({},d,a.event.properties),a},{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:t=>c(t,t.event.event),page:t=>c(t,"$pageview"),identify:t=>c(t,"$identify"),screen:t=>c(t,"$screen")})).then(()=>{a()})})}(this,()=>this._loaded()):this._loaded(),I(this.config._onCapture)&&this.config._onCapture!==So&&(ec.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",t=>this.config._onCapture(t.event,t))),this}_onRemoteConfig(t){var a,l,d,h,_,p,g,v;if(!f||!f.body)return ec.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this._onRemoteConfig(t)},500);this.compression=void 0,t.supportedCompression&&!this.config.disable_compression&&(this.compression=m(t.supportedCompression,c.GZipJS)?c.GZipJS:m(t.supportedCompression,c.Base64)?c.Base64:void 0),null!==(a=t.analytics)&&void 0!==a&&a.endpoint&&(this.analyticsDefaultEndpoint=t.analytics.endpoint),this.set_config({person_profiles:this._initialPersonProfilesConfig?this._initialPersonProfilesConfig:"identified_only"}),null===(l=this.siteApps)||void 0===l||l.onRemoteConfig(t),null===(d=this.sessionRecording)||void 0===d||d.onRemoteConfig(t),null===(h=this.autocapture)||void 0===h||h.onRemoteConfig(t),null===(_=this.heatmaps)||void 0===_||_.onRemoteConfig(t),this.surveys.onRemoteConfig(t),null===(p=this.webVitalsAutocapture)||void 0===p||p.onRemoteConfig(t),null===(g=this.exceptionObserver)||void 0===g||g.onRemoteConfig(t),null===(v=this.deadClicksAutocapture)||void 0===v||v.onRemoteConfig(t)}_loaded(){try{this.config.loaded(this)}catch(t){ec.critical("`loaded` function failed",t)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this._captureInitialPageview()},1),new Wn(this).load(),this.featureFlags.decide()}_start_queue_if_opted_in(){var t;this.has_opted_out_capturing()||this.config.request_batching&&(null===(t=this._requestQueue)||void 0===t||t.enable())}_dom_loaded(){this.has_opted_out_capturing()||Y(this.__request_queue,t=>this._send_retriable_request(t)),this.__request_queue=[],this._start_queue_if_opted_in()}_handle_unload(){var t,a;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),null===(t=this._requestQueue)||void 0===t||t.unload(),null===(a=this._retryQueue)||void 0===a||a.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(t){this.__loaded&&(sq?this.__request_queue.push(t):this.rateLimiter.isServerRateLimited(t.batchKey)||(t.transport=t.transport||this.config.api_transport,t.url=Yn(t.url,{ip:this.config.ip?1:0}),t.headers=W({},this.config.request_headers),t.compression="best-available"===t.compression?this.compression:t.compression,t.fetchOptions=t.fetchOptions||this.config.fetch_options,(t=>{var a,l,c,d=W({},t);d.timeout=d.timeout||6e4,d.url=Yn(d.url,{_:(new Date).getTime().toString(),ver:H.LIB_VERSION,compression:d.compression});var h=null!==(a=d.transport)&&void 0!==a?a:"fetch",_=null!==(l=null===(c=oe(sS,t=>t.transport===h))||void 0===c?void 0:c.method)&&void 0!==l?l:sS[0].method;if(!_)throw Error("No available transport method");_(d)})(W(W({},t),{},{callback:a=>{var l,c,d;this.rateLimiter.checkForLimiting(a),a.statusCode>=400&&(null===(c=(d=this.config).on_request_error)||void 0===c||c.call(d,a)),null===(l=t.callback)||void 0===l||l.call(t,a)}}))))}_send_retriable_request(t){this._retryQueue?this._retryQueue.retriableRequest(t):this._send_request(t)}_execute_array(t){var a,l=[],c=[],d=[];Y(t,t=>{t&&(el(a=t[0])?d.push(t):I(t)?t.call(this):el(t)&&"alias"===a?l.push(t):el(t)&&-1!==a.indexOf("capture")&&I(this[a])?d.push(t):c.push(t))});var n=function(t,a){Y(t,function(t){if(el(t[0])){var l=a;K(t,function(t){l=l[t[0]].apply(l,t.slice(1))})}else this[t[0]].apply(this,t.slice(1))},a)};n(l,this),n(c,this),n(d,this)}_hasBootstrappedFeatureFlags(){var t,a;return(null===(t=this.config.bootstrap)||void 0===t?void 0:t.featureFlags)&&Object.keys(null===(a=this.config.bootstrap)||void 0===a?void 0:a.featureFlags).length>0||!1}push(t){this._execute_array([t])}capture(t,a,l){var c;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue){if(!this.consent.isOptedOut()){if(!F(t)&&R(t)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var d=null!=l&&l.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==d||!d.isRateLimited){this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var h,_,p,g,v=new Date,f=(null==l?void 0:l.timestamp)||v,w=Nt(),S={uuid:w,event:t,properties:this._calculate_event_properties(t,a||{},f,w)};d&&(S.properties.$lib_rate_limit_remaining_tokens=d.remainingTokens),(null==l?void 0:l.$set)&&(S.$set=null==l?void 0:l.$set);var k=this._calculate_set_once_properties(null==l?void 0:l.$set_once);k&&(S.$set_once=k),(h=S,_=null!=l&&l._noTruncate?null:this.config.properties_string_max_length,p=t=>R(t)&&!$(_)?t.slice(0,_):t,g=new Set,S=function e(t,a){var l;return t!==Object(t)?p?p(t,a):t:g.has(t)?void 0:(g.add(t),el(t)?(l=[],Y(t,t=>{l.push(e(t))})):(l={},K(t,(t,a)=>{g.has(t)||(l[a]=e(t,a))})),l)}(h)).timestamp=f,F(null==l?void 0:l.timestamp)||(S.properties.$event_time_override_provided=!0,S.properties.$event_time_override_system_time=v);var E=W(W({},S.properties.$set),S.$set);if(C(E)||this.setPersonPropertiesForFlags(E),!A(this.config.before_send)){var x=this._runBeforeSend(S);if(!x)return;S=x}this._internalEventEmitter.emit("eventCaptured",S);var B={method:"POST",url:null!==(c=null==l?void 0:l._url)&&void 0!==c?c:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:S,compression:"best-available",batchKey:null==l?void 0:l._batchKey};return!this.config.request_batching||l&&(null==l||!l._batchKey)||null!=l&&l.send_instantly?this._send_retriable_request(B):this._requestQueue.enqueue(B),S}ec.critical("This capture call is ignored due to client rate limiting.")}}else ec.error("No event name provided to posthog.capture")}}else ec.uninitializedWarning("posthog.capture")}_addCaptureHook(t){return this.on("eventCaptured",a=>t(a.event,a))}_calculate_event_properties(t,a,l,c){if(l=l||new Date,!this.persistence||!this.sessionPersistence)return a;var d,h,_=this.persistence.remove_event_timer(t),p=W({},a);if(p.token=this.config.token,this.config.__preview_experimental_cookieless_mode&&(p.$cookieless_mode=!0),"$snapshot"===t){var g=W(W({},this.persistence.properties()),this.sessionPersistence.properties());return p.distinct_id=g.distinct_id,(!R(p.distinct_id)&&!O(p.distinct_id)||T(p.distinct_id))&&ec.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),p}var v,w=i5.properties({maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties});if(this.sessionManager){var{sessionId:S,windowId:k}=this.sessionManager.checkAndGetSessionAndWindowId();p.$session_id=S,p.$window_id=k}this.sessionPropsManager&&X(p,this.sessionPropsManager.getSessionProps());try{this.sessionRecording&&(p.$recording_status=this.sessionRecording.status,p.$sdk_debug_replay_internal_buffer_length=this.sessionRecording.buffer.data.length,p.$sdk_debug_replay_internal_buffer_size=this.sessionRecording.buffer.size),p.$sdk_debug_retry_queue_size=null===(d=this._retryQueue)||void 0===d||null===(h=d.queue)||void 0===h?void 0:h.length}catch(t){p.$sdk_debug_error_capturing_properties=String(t)}if(this.requestRouter.region===sA.CUSTOM&&(p.$lib_custom_api_host=this.config.api_host),v="$pageview"===t?this.pageViewManager.doPageView(l,c):"$pageleave"===t?this.pageViewManager.doPageLeave(l):this.pageViewManager.doEvent(),p=X(p,v),"$pageview"===t&&f&&(p.title=f.title),!F(_)){var E=l.getTime()-_;p.$duration=parseFloat((E/1e3).toFixed(3))}x&&this.config.opt_out_useragent_filter&&(p.$browser_type=this._is_bot()?"bot":"browser"),(p=X({},w,this.persistence.properties(),this.sessionPersistence.properties(),p)).$is_identified=this._isIdentified(),el(this.config.property_denylist)?K(this.config.property_denylist,function(t){delete p[t]}):ec.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var B=this.config.sanitize_properties;B&&(ec.error("sanitize_properties is deprecated. Use before_send instead"),p=B(p,t));var H=this._hasPersonProcessing();return p.$process_person_profile=H,H&&this._requirePersonProcessing("_calculate_event_properties"),p}_calculate_set_once_properties(t){if(!this.persistence||!this._hasPersonProcessing()||this._personProcessingSetOncePropertiesSent)return t;var a,l=X({},this.persistence.get_initial_props(),(null===(a=this.sessionPropsManager)||void 0===a?void 0:a.getSetOnceProps())||{},t||{}),c=this.config.sanitize_properties;return c&&(ec.error("sanitize_properties is deprecated. Use before_send instead"),l=c(l,"$set_once")),this._personProcessingSetOncePropertiesSent=!0,C(l)?void 0:l}register(t,a){var l;null===(l=this.persistence)||void 0===l||l.register(t,a)}register_once(t,a,l){var c;null===(c=this.persistence)||void 0===c||c.register_once(t,a,l)}register_for_session(t){var a;null===(a=this.sessionPersistence)||void 0===a||a.register(t)}unregister(t){var a;null===(a=this.persistence)||void 0===a||a.unregister(t)}unregister_for_session(t){var a;null===(a=this.sessionPersistence)||void 0===a||a.unregister(t)}_register_single(t,a){this.register({[t]:a})}getFeatureFlag(t,a){return this.featureFlags.getFeatureFlag(t,a)}getFeatureFlagPayload(t){var a=this.featureFlags.getFeatureFlagPayload(t);try{return JSON.parse(a)}catch(t){return a}}isFeatureEnabled(t,a){return this.featureFlags.isFeatureEnabled(t,a)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(t,a){this.featureFlags.updateEarlyAccessFeatureEnrollment(t,a)}getEarlyAccessFeatures(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0;return this.featureFlags.getEarlyAccessFeatures(t,a,l)}on(t,a){return this._internalEventEmitter.on(t,a)}onFeatureFlags(t){return this.featureFlags.onFeatureFlags(t)}onSessionId(t){var a,l;return null!==(a=null===(l=this.sessionManager)||void 0===l?void 0:l.onSessionId(t))&&void 0!==a?a:()=>{}}getSurveys(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getSurveys(t,a)}getActiveMatchingSurveys(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getActiveMatchingSurveys(t,a)}renderSurvey(t,a){this.surveys.renderSurvey(t,a)}canRenderSurvey(t){this.surveys.canRenderSurvey(t)}identify(t,a,l){if(!this.__loaded||!this.persistence)return ec.uninitializedWarning("posthog.identify");if(O(t)&&(t=t.toString(),ec.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),t){if(["distinct_id","distinctid"].includes(t.toLowerCase()))ec.critical('The string "'.concat(t,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else if(this._requirePersonProcessing("posthog.identify")){var c=this.get_distinct_id();this.register({$user_id:t}),this.get_property("$device_id")||this.register_once({$had_persisted_distinct_id:!0,$device_id:c},""),t!==c&&t!==this.get_property(eg)&&(this.unregister(eg),this.register({distinct_id:t}));var d="anonymous"===(this.persistence.get_property(eV)||"anonymous");t!==c&&d?(this.persistence.set_property(eV,"identified"),this.setPersonPropertiesForFlags(W(W({},l||{}),a||{}),!1),this.capture("$identify",{distinct_id:t,$anon_distinct_id:c},{$set:a||{},$set_once:l||{}}),this.featureFlags.setAnonymousDistinctId(c),this._cachedIdentify=vo(t,a,l)):(a||l)&&(this._cachedIdentify!==vo(t,a,l)?(this.setPersonProperties(a,l),this._cachedIdentify=vo(t,a,l)):ec.info("A duplicate posthog.identify call was made with the same properties. It has been ignored.")),t!==c&&(this.reloadFeatureFlags(),this.unregister(eB))}}else ec.error("Unique user id has not been set in posthog.identify")}setPersonProperties(t,a){(t||a)&&this._requirePersonProcessing("posthog.setPersonProperties")&&(this.setPersonPropertiesForFlags(W(W({},a||{}),t||{})),this.capture("$set",{$set:t||{},$set_once:a||{}}))}group(t,a,l){if(t&&a){if(this._requirePersonProcessing("posthog.group")){var c=this.getGroups();c[t]!==a&&this.resetGroupPropertiesForFlags(t),this.register({$groups:W(W({},c),{},{[t]:a})}),l&&(this.capture("$groupidentify",{$group_type:t,$group_key:a,$group_set:l}),this.setGroupPropertiesForFlags({[t]:l})),c[t]===a||l||this.reloadFeatureFlags()}}else ec.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.featureFlags.setPersonPropertiesForFlags(t,a)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(t,a)}resetGroupPropertiesForFlags(t){this.featureFlags.resetGroupPropertiesForFlags(t)}reset(t){if(ec.info("reset"),!this.__loaded)return ec.uninitializedWarning("posthog.reset");var a,l,c,d,h=this.get_property("$device_id");if(this.consent.reset(),null===(a=this.persistence)||void 0===a||a.clear(),null===(l=this.sessionPersistence)||void 0===l||l.clear(),this.surveys.reset(),null===(c=this.persistence)||void 0===c||c.set_property(eV,"anonymous"),null===(d=this.sessionManager)||void 0===d||d.resetSessionId(),this._cachedIdentify=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:eY,$device_id:null},"");else{var _=this.config.get_device_id(Nt());this.register_once({distinct_id:_,$device_id:t?_:h},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var t,a;return null!==(t=null===(a=this.sessionManager)||void 0===a?void 0:a.checkAndGetSessionAndWindowId(!0).sessionId)&&void 0!==t?t:""}get_session_replay_url(t){if(!this.sessionManager)return"";var{sessionId:a,sessionStartTimestamp:l}=this.sessionManager.checkAndGetSessionAndWindowId(!0),c=this.requestRouter.endpointFor("ui","/project/".concat(this.config.token,"/replay/").concat(a));if(null!=t&&t.withTimestamp&&l){var d,h=null!==(d=t.timestampLookBack)&&void 0!==d?d:10;if(!l)return c;var _=Math.max(Math.floor(((new Date).getTime()-l)/1e3)-h,0);c+="?t=".concat(_)}return c}alias(t,a){return t===this.get_property(ep)?(ec.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(F(a)&&(a=this.get_distinct_id()),t!==a?(this._register_single(eg,t),this.capture("$create_alias",{alias:t,distinct_id:a})):(ec.warn("alias matches current distinct_id - skipping api call."),this.identify(t),-1)):void 0}set_config(t){var a,l,c,d,h=W({},this.config);P(t)&&(X(this.config,Io(t)),null===(a=this.persistence)||void 0===a||a.update_config(this.config,h),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Gr(W(W({},this.config),{},{persistence:"sessionStorage"})),tl.is_supported()&&"true"===tl.get("ph_debug")&&(this.config.debug=!0),this.config.debug&&(H.DEBUG=!0,ec.info("set_config",{config:t,oldConfig:h,newConfig:W({},this.config)})),null===(l=this.sessionRecording)||void 0===l||l.startIfEnabledOrStop(),null===(c=this.autocapture)||void 0===c||c.startIfEnabled(),null===(d=this.heatmaps)||void 0===d||d.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence())}startSessionRecording(t){var a,l,c,d,h,_=!0===t,p={sampling:_||!(null==t||!t.sampling),linked_flag:_||!(null==t||!t.linked_flag),url_trigger:_||!(null==t||!t.url_trigger),event_trigger:_||!(null==t||!t.event_trigger)};Object.values(p).some(Boolean)&&(null===(a=this.sessionManager)||void 0===a||a.checkAndGetSessionAndWindowId(),p.sampling&&(null===(l=this.sessionRecording)||void 0===l||l.overrideSampling()),p.linked_flag&&(null===(c=this.sessionRecording)||void 0===c||c.overrideLinkedFlag()),p.url_trigger&&(null===(d=this.sessionRecording)||void 0===d||d.overrideTrigger("url")),p.event_trigger&&(null===(h=this.sessionRecording)||void 0===h||h.overrideTrigger("event"))),this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var t;return!(null===(t=this.sessionRecording)||void 0===t||!t.started)}captureException(t,a){var l,c=Error("PostHog syntheticException"),d=I(null===(l=B.__PosthogExtensions__)||void 0===l?void 0:l.parseErrorAsProperties)?W(W({},B.__PosthogExtensions__.parseErrorAsProperties(D(t)?{error:t,event:t.message}:{event:t},{syntheticException:c})),a):W({$exception_level:"error",$exception_list:[{type:D(t)?t.name:"Error",value:D(t)?t.message:P(t)&&"message"in t?String(t.message):String(t),mechanism:{handled:!0,synthetic:!1}}]},a);this.exceptions.sendExceptionEvent(d)}loadToolbar(t){return this.toolbar.loadToolbar(t)}get_property(t){var a;return null===(a=this.persistence)||void 0===a?void 0:a.props[t]}getSessionProperty(t){var a;return null===(a=this.sessionPersistence)||void 0===a?void 0:a.props[t]}toString(){var t,a=null!==(t=this.config.name)&&void 0!==t?t:sW;return a!==sW&&(a=sW+"."+a),a}_isIdentified(){var t,a;return"identified"===(null===(t=this.persistence)||void 0===t?void 0:t.get_property(eV))||"identified"===(null===(a=this.sessionPersistence)||void 0===a?void 0:a.get_property(eV))}_hasPersonProcessing(){var t,a,l,c;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&C(this.getGroups())&&(null===(t=this.persistence)||void 0===t||null===(a=t.props)||void 0===a||!a[eg])&&(null===(l=this.persistence)||void 0===l||null===(c=l.props)||void 0===c||!c[eK]))}_shouldCapturePageleave(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&this.config.capture_pageview}createPersonProfile(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}_requirePersonProcessing(t){return"never"===this.config.person_profiles?(ec.error(t+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(eK,!0),!0)}_sync_opt_out_with_persistence(){var t,a,l,c,d=this.consent.isOptedOut(),h=this.config.opt_out_persistence_by_default,_=this.config.disable_persistence||d&&!!h;(null===(t=this.persistence)||void 0===t?void 0:t.disabled)!==_&&(null===(l=this.persistence)||void 0===l||l.set_disabled(_)),(null===(a=this.sessionPersistence)||void 0===a?void 0:a.disabled)!==_&&(null===(c=this.sessionPersistence)||void 0===c||c.set_disabled(_))}opt_in_capturing(t){var a;this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),(F(null==t?void 0:t.captureEventName)||null!=t&&t.captureEventName)&&this.capture(null!==(a=null==t?void 0:t.captureEventName)&&void 0!==a?a:"$opt_in",null==t?void 0:t.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this._captureInitialPageview()}opt_out_capturing(){this.consent.optInOut(!1),this._sync_opt_out_with_persistence()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this._sync_opt_out_with_persistence()}_is_bot(){return v?go(v,this.config.custom_blocked_useragents):void 0}_captureInitialPageview(){f&&!this._initialPageviewCaptured&&(this._initialPageviewCaptured=!0,this.capture("$pageview",{title:f.title},{send_instantly:!0}))}debug(t){!1===t?(null==d||d.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(null==d||d.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}_runBeforeSend(t){if(A(this.config.before_send))return t;var a=el(this.config.before_send)?this.config.before_send:[this.config.before_send],l=t;for(var c of a){if(A(l=c(l))){var d="Event '".concat(t.event,"' was rejected in beforeSend function");return q(t.event)?ec.warn("".concat(d,". This can cause unexpected behavior.")):ec.info(d),null}l.properties&&!C(l.properties)||ec.warn("Event '".concat(t.event,"' has no properties after beforeSend function, this is likely an error."))}return l}getPageViewId(){var t;return null===(t=this.pageViewManager._currentPageview)||void 0===t?void 0:t.pageViewId}captureTraceFeedback(t,a){this.capture("$ai_feedback",{$ai_trace_id:String(t),$ai_feedback_text:a})}captureTraceMetric(t,a,l){this.capture("$ai_metric",{$ai_trace_id:String(t),$ai_metric_name:a,$ai_metric_value:String(l)})}};!function(t,a){for(var l=0;l<a.length;l++)t.prototype[a[l]]=te(t.prototype[a[l]])}(Co,["identify"]);var sN,sB,sV=(sB=sD[sW]=new Co,function(){function e(){e.done||(e.done=!0,sq=!1,K(sD,function(t){t._dom_loaded()}))}null!=f&&f.addEventListener?"complete"===f.readyState?e():ae(f,"DOMContentLoaded",e,{capture:!1}):d&&ec.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),sB)}}]);